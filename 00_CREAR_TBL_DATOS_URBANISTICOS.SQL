
/*
SELECT *
FROM all_users G
WHERE UPPER(username) like UPPER('%RGPLAZAS%')
ORDER BY username;

TRUNCATE TABLE TBL_DATOS_URBANISTICOS
DROP TABLE TBL_DATOS_URBANISTICOS

SELECT * FROM TBL_DATOS_URBANISTICOS

*/

DECLARE
    v_table_exists NUMBER;
BEGIN
    -- Verificar si la tabla existe DROP TABLE RGPLAZAS.TBL_DATOS_URBANISTICOS
    SELECT COUNT(*) INTO v_table_exists
    FROM all_tables
    WHERE table_name = 'TBL_DATOS_URBANISTICOS'; --AND owner = 'RGPLAZAS';

    IF v_table_exists = 0 THEN
        -- Si no existe, crear la tabla
        EXECUTE IMMEDIATE '
        CREATE TABLE TBL_DATOS_URBANISTICOS (
            ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
            CHIP 										VARCHAR2(50),
            NOMBRE_SECTOR_ACTUALIZAR_2025 				VARCHAR2(255),
            CODIGO_BARRIO 								VARCHAR2(100),
            CODIGO_MANZANA 								VARCHAR2(100),
            CODIGO_PREDIO 								VARCHAR2(100),
            CODIGO_CONSTRUCCION 						VARCHAR2(100),
            CODIGO_RESTO 								VARCHAR2(100),
            NOMBRE_LOCALIDAD 							VARCHAR2(255),
            DIRECCION_REAL 								VARCHAR2(255),
            ZHFG 										VARCHAR2(50),
            VALOR_REFERENCIA 							NUMBER(18, 2),
            VALOR_COMERCIAL_TERRENO 					NUMBER(18, 2),
            VALOR_CATASTRAL_TERRENO 					NUMBER(18, 2),
            UPL_MAYOR_PARTICIPACION 					VARCHAR2(50),
            AREA_TERRENO_CALCULADA 						NUMBER(18, 2),
            TRATAMIENTO_URBANISTICO 					VARCHAR2(255),
            TIPOLOGIA_URBANISTICA 						VARCHAR2(255),
            PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO 	NUMBER(18, 2),
            NOMBRE_AREA_ACTIVIDAD 						VARCHAR2(255),
            ZONA_AREA_ACTIVIDAD 						VARCHAR2(255),
            DIMENSION_ANTEJARDIN 						NUMBER(18, 2),
            AREA_TOTAL_RESERVAS_URBANAS 				NUMBER(18, 2),
            AREA_LOTE_CONDICION_AMENAZA 				NUMBER(18, 2),
            AREA_TOTAL_AFECTACIONES 					NUMBER(18, 2),
            OFERTAS_RESIDENCIAL 						VARCHAR2(255),
            PRODUCTO_INMOBILIARIO_PRINCIPAL 			VARCHAR2(255),
            PRODUCTO_INMOBILIARIO_SECUNDARIO 			VARCHAR2(255),
            CONTROL_AMBIENTAL 							VARCHAR2(255),
            FRENTE_ANCHO 								NUMBER(18, 2),
            FONDO_ANCHO 								NUMBER(18, 2),
            RANGO_1_TRABAJAR 							VARCHAR2(50),
			NO_DE_PISOS 								NUMBER(18, 2),
			AN_LOTE_10_APTOS 							NUMBER(18, 2),
			ACTUACION_ESTRATEGICA 						NUMBER(18, 2),
			CATEGORIA_PROYECTO							VARCHAR2(50),
			ALTURA_PISOS								NUMBER(18, 2),
			ES_MANZANA									NUMBER(18, 2),
			ALTURA_PISOS_2								NUMBER(18, 2),
			ANCHO_VIA									NUMBER(18, 2),
			ENGLOBE_MINIMO_400							NUMBER(18, 2),
			FORMATO_TRABAJO								VARCHAR2(50),
			VIGENCIA 									NUMBER NULL,
            FECHA_HORA 									TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        )';
		DBMS_OUTPUT.PUT_LINE('Tabla "TBL_DATOS_URBANISTICOS" creada correctamente.');
		
		
		-- Crear el índice en el campo CHIP
        EXECUTE IMMEDIATE 'CREATE INDEX IDX_CHIP ON TBL_DATOS_URBANISTICOS (CHIP,FORMATO_TRABAJO,VIGENCIA)';
        DBMS_OUTPUT.PUT_LINE('Índice "IDX_CHIP" creado correctamente.');
    ELSE
        -- Si ya existe, mostrar mensaje
        DBMS_OUTPUT.PUT_LINE('La tabla "TBL_DATOS_URBANISTICOS" ya existe.');
    END IF;
END;