CREATE OR REPLACE PACKAGE PAQUETE_ACTUALIZACION_PREDIOS AS
   FUNCTION FUNC_OBTENER_VALOR_PISO_TBL24(v_columna IN VARCHAR2, p_vigencia IN NUMBER,p_estrato IN VARCHAR2,p_titulo IN VARCHAR2) RETURN NUMBER;	
   FUNCTION FUNC_OBTENER_VALOR_PISO_TBL24A(v_columna IN VARCHAR2, p_vigencia IN NUMBER,p_localidad IN VARCHAR2,p_sector IN VARCHAR2,p_estrato IN VARCHAR2,p_producto IN VARCHAR2:= NULL) RETURN NUMBER;	
   FUNCTION FUNC_OBTENER_VALOR_PISO_TBL27(p_piso IN NUMBER, p_titulo IN VARCHAR2,p_vigencia IN NUMBER) RETURN NUMBER;	
   FUNCTION FUNC_OBTENER_VALOR_PISO_TBL28(p_titulo IN VARCHAR2,p_vigencia IN NUMBER,p_id  IN NUMBER) RETURN NUMBER;	
   FUNCTION FUNC_OBTENER_VALOR_PISO_TBLAB450(v_columna IN VARCHAR2, p_vigencia IN NUMBER,p_estrato IN VARCHAR2,p_titulo IN VARCHAR2,p_costo IN NUMBER,p_estado IN NUMBER) RETURN NUMBER;	
   PROCEDURE SP_ACTUALIZAR_PREDIOS_GEOMETRIA_3(p_borra IN NUMBER DEFAULT 0);
   PROCEDURE SP_ACTUALIZAR_PREDIOS_2;
   PROCEDURE SP_ACTUALIZAR_PREDIOS_2_1;
   PROCEDURE SP_ACTUALIZAR_PREDIOS_1(p_chip IN VARCHAR2,p_validacion IN NUMBER ,p_resultado OUT SYS_REFCURSOR);
END PAQUETE_ACTUALIZACION_PREDIOS;
/

CREATE OR REPLACE PACKAGE BODY PAQUETE_ACTUALIZACION_PREDIOS AS

		--TBL24
		FUNCTION FUNC_OBTENER_VALOR_PISO_TBL24 --NIVEL_0
		(
			v_columna 	IN VARCHAR2,
			p_vigencia  IN NUMBER, 
			p_estrato 	IN VARCHAR2,       -- estrato
			p_titulo 	IN VARCHAR2        -- ''
		) RETURN NUMBER IS
			v_sql 		VARCHAR2(1000);
			v_valor 	NUMBER;
		BEGIN

			-- Construir la consulta dinámica
			v_sql := 'SELECT T.' || v_columna || ' FROM TBL_VALORES_INMUEBLES_2024_TBL24 T WHERE VIGENCIA = :p_vigencia AND ESTRATO = :p_estrato AND ROWNUM = 1';
			DBMS_OUTPUT.PUT_LINE('*****' || v_sql || ' :p_estrato: ' || p_estrato || ' Titulo: ' || p_titulo  );

			-- Ejecutar la consulta dinámica
			BEGIN
				EXECUTE IMMEDIATE v_sql INTO v_valor USING p_vigencia,p_estrato;
			EXCEPTION
				WHEN NO_DATA_FOUND THEN
					RETURN NULL;
				WHEN OTHERS THEN
					DBMS_OUTPUT.PUT_LINE('Error al ejecutar la consulta: ' || SQLERRM);
					RETURN NULL;
			END;

			-- Retornar el valor obtenido
			RETURN v_valor;
		END FUNC_OBTENER_VALOR_PISO_TBL24;
		
		--TBL24A
		FUNCTION FUNC_OBTENER_VALOR_PISO_TBL24A
		(
			v_columna   IN VARCHAR2,
			p_vigencia  IN NUMBER, 
			p_localidad IN VARCHAR2,       
			p_sector    IN VARCHAR2,           -- Sector específico del predio
			p_estrato   IN VARCHAR2,	       -- OFERTAS_RESIDENCIAL	
			p_producto  IN VARCHAR2	:= NULL	   -- PRODUCTO_INMOBILIARIO_PRINCIPAL	
		) RETURN NUMBER IS
			v_sql       VARCHAR2(1000);
			v_valor     NUMBER := NULL; -- Inicializado a NULL para control
			v_sector_general CONSTANT VARCHAR2(10) := '0'; -- Valor de SECTOR general
		BEGIN

			-- 1. PRIMER INTENTO DE BÚSQUEDA: Buscar con el sector específico
			v_sql := 'SELECT T.' || v_columna || 
					 ' FROM TBL_VALORES_INMUEBLES_2024_TBL24A T ' ||
					 ' WHERE VIGENCIA = :p_vigencia AND LOCALIDAD = :p_localidad AND SECTOR = :p_sector AND ESTRATO = :p_estrato AND ROWNUM = 1';

			-- Ejecutar la consulta del sector específico
			BEGIN
				EXECUTE IMMEDIATE v_sql INTO v_valor 
				USING p_vigencia, p_localidad, p_sector, p_estrato;

			EXCEPTION
				-- Si no se encuentra con el sector específico, v_valor sigue siendo NULL
				WHEN NO_DATA_FOUND THEN
					v_valor := NULL; 
				WHEN OTHERS THEN
					-- Manejar otros errores y retornar NULL
					DBMS_OUTPUT.PUT_LINE('Error (Intento 1) al buscar con sector ' || p_sector || ': ' || SQLERRM);
					RETURN NULL;
			END;

			-- 2. SEGUNDO INTENTO DE BÚSQUEDA: Si el primer intento falló o el sector era el general ('0')
			IF v_valor IS NULL THEN
				
				-- Consulta para el sector general ('0')
				v_sql := 'SELECT T.' || v_columna || 
						 ' FROM TBL_VALORES_INMUEBLES_2024_TBL24A T ' ||
						 ' WHERE VIGENCIA = :p_vigencia AND LOCALIDAD = :p_localidad AND SECTOR = :p_sector_general AND ESTRATO = :p_estrato AND ROWNUM = 1';
				
				BEGIN
					EXECUTE IMMEDIATE v_sql INTO v_valor 
					USING p_vigencia, p_localidad, v_sector_general, p_estrato;

				EXCEPTION
					WHEN NO_DATA_FOUND THEN
						v_valor := NULL;
					WHEN OTHERS THEN
						DBMS_OUTPUT.PUT_LINE('Error (Intento 2) al buscar con sector ' || v_sector_general || ': ' || SQLERRM);
						RETURN NULL;
				END;
			END IF;
			DBMS_OUTPUT.PUT_LINE('*****' || v_sql || ' :localidad: ' || p_localidad || ' sector: ' || p_sector || ' estrato: ' || p_estrato || ' vigencia: ' || p_vigencia  );
			
			-- 3. Retornar el valor obtenido (NVL para garantizar que si no se encontró nada, se devuelva 0)
			-- Recuerda que en el MERGE, si retorna 0, debes manejar la división por cero.
			--	
			IF p_estrato IN('VIP') AND (v_columna IN ('M2')) THEN
			   IF p_producto IN('VIVIENDA') THEN 
				  v_valor := v_valor;
			   ELSE
			      v_valor := 42;
			   END IF;
			END IF;
			IF p_estrato IN('VIS','3','4','5','6') AND (v_columna IN ('M2')) THEN
				IF p_producto IN('VIVIENDA','OFICINAS') THEN 
				  v_valor := v_valor;
			   ELSE
			      v_valor := 0;
			   END IF;
			END IF;
			--
			IF p_estrato IN('VIP') AND (v_columna IN ('V_VIVIENDA','V_OFICINA')) THEN
			   IF p_producto IN('VIVIENDA') THEN 
				  v_valor := v_valor;
			   ELSE
			      v_valor := 128115000 / 
				  NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',p_vigencia,UPPER(p_localidad),UPPER(p_sector),UPPER(p_estrato),UPPER(p_producto)), 0),NULL);
			   END IF;
			END IF;
			IF p_estrato IN('VIS','3','4','5','6') AND (v_columna IN ('V_VIVIENDA','V_OFICINA')) THEN
			   IF p_producto IN('VIVIENDA','OFICINAS') THEN 
				  v_valor := v_valor;
			   ELSE
			      v_valor := 0; 
			   END IF;
			END IF;
			--
			IF p_estrato IN('VIP') AND (v_columna IN ('V_LOCAL')) THEN
			   IF p_producto IN('VIVIENDA') THEN 
				  v_valor := ROUND(v_valor,-5);
			   ELSE
			      v_valor := ROUND(128115000 / 
				  NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',p_vigencia,UPPER(p_localidad),UPPER(p_sector),UPPER(p_estrato),UPPER(p_producto)), 0),NULL) * 1.5,-5);
			   END IF;
			END IF;
			IF p_estrato IN('VIS','3','4','5','6') AND (v_columna IN ('V_LOCAL')) THEN
			   IF p_producto IN('VIVIENDA','OFICINAS') THEN 
				  v_valor := v_valor;
			   ELSE
			      v_valor := 0; 
			   END IF;
			END IF;
			
			RETURN NVL(v_valor, -10); 

		END FUNC_OBTENER_VALOR_PISO_TBL24A;

		--TBL27
		FUNCTION FUNC_OBTENER_VALOR_PISO_TBL27 --NIVEL_0
		(
			p_piso 		IN NUMBER,         -- NÚMERO DE PISOS
			p_titulo 	IN VARCHAR2,       -- Nombre de la columna (como 'VIS-0', '4-0', etc.)
			p_vigencia  IN NUMBER
		) RETURN NUMBER IS
			v_columna 	VARCHAR2(30);
			v_sql 		VARCHAR2(1000);
			v_valor 	NUMBER;
		BEGIN
			-- Determinar el nombre de la columna basado en el valor de p_titulo
			CASE p_titulo
				WHEN 'VIP-0'   THEN v_columna := 'TIPO_1_INDUST_VIP_0';		
				WHEN 'VIS-0'   THEN v_columna := 'TIPO_2_INDUST_VIS_0'; 	 
				WHEN '3-0'     THEN v_columna := 'TIPO_3_INDUST_3_0'; 	 	
				WHEN '4-0'     THEN v_columna := 'TIPO_4_INDUST_4_0'; 	 	
				WHEN '5-0'     THEN v_columna := 'TIPO_5_PORTICO_5_0'; 	 	
				WHEN 'VIS-1'   THEN v_columna := 'TIPO_2_IND_1_ST_VIS_1'; 	 
				WHEN '3-1'     THEN v_columna := 'TIPO_3_IND_1ST_3_1'; 	 	
				WHEN '4-1'     THEN v_columna := 'TIPO_4_IND_1_ST_4_1'; 	 
				WHEN '5-1'     THEN v_columna := 'TIPO_5_PORT_1_ST_5_1'; 	 
				WHEN 'VIS-2'   THEN v_columna := 'TIPO_2_IND_2ST_VIS_2'; 	 
				WHEN '3-2'     THEN v_columna := 'TIPO_3_IND_2ST_3_2'; 	 	
				WHEN '4-2'     THEN v_columna := 'TIPO_4_IND_2ST_4_2'; 	 	
				WHEN '5-2'     THEN v_columna := 'TIPO_5_PORT_2ST_5_2'; 	 
				WHEN '6-0'     THEN v_columna := 'TIPO_6_PORT_6_0'; 	 	
				WHEN '6-1'     THEN v_columna := 'TIPO_6_PORT_1ST_6_1'; 	 
				WHEN '6-2'     THEN v_columna := 'TIPO_6_PORT_2ST_6_2'; 	 
				WHEN 'O-2-0'   THEN v_columna := 'TIPO_2_PORTICO_O_2_0'; 	 
				WHEN 'O-3-0'   THEN v_columna := 'TIPO_3_PORTICO_O_3_0'; 	 
				WHEN 'O-4-0'   THEN v_columna := 'TIPO_4_PORTICO_O_4_0'; 	 
				WHEN 'O-3-1'   THEN v_columna := 'TIPO_3_PORTICO_1ST_O_3_1'; 
				WHEN 'O-4-1'   THEN v_columna := 'TIPO_4_PORTICO_1_ST_O_4_1';
				WHEN 'O-3-2'   THEN v_columna := 'TIPO_3_PORTICO_2ST_O_3_2'; 
				WHEN 'O-4-2'   THEN v_columna := 'TIPO_4_PORTICO_2ST_O_4_2'; 
				ELSE
					RETURN NULL; -- Si no se encuentra la columna, retorna NULL
			END CASE;

			-- Construir la consulta dinámica
			v_sql := 'SELECT T.' || v_columna || ' FROM TBL_PARAM_VALORES_TIPOLOGIA_2025_TBL27 T WHERE VIGENCIA = :p_vigencia AND  NUMERO_PISOS = :p_piso';
			DBMS_OUTPUT.PUT_LINE('*****' || v_sql || ' :piso: ' || p_piso || ' Titulo: ' || p_titulo || ' Vigencia: ' || p_vigencia  );

			-- Ejecutar la consulta dinámica
			BEGIN
				EXECUTE IMMEDIATE v_sql INTO v_valor USING p_vigencia,p_piso;
			EXCEPTION
				WHEN NO_DATA_FOUND THEN
					RETURN NULL;
				WHEN OTHERS THEN
					DBMS_OUTPUT.PUT_LINE('Error al ejecutar la consulta: ' || SQLERRM);
					RETURN NULL;
			END;

			-- Retornar el valor obtenido
			RETURN v_valor;
		END FUNC_OBTENER_VALOR_PISO_TBL27;

		
		--TBL28
		FUNCTION FUNC_OBTENER_VALOR_PISO_TBL28 --NIVEL_0
		(
			p_titulo 			IN VARCHAR2,       -- Nombre de la columna (como 'VIS-0', '4-0', etc.)
			p_vigencia  		IN NUMBER,
			p_id    			IN NUMBER
		) RETURN NUMBER IS
			v_columna 	VARCHAR2(30);
			v_sql 		VARCHAR2(1000);
			v_valor 	NUMBER;
		BEGIN
			-- Determinar el nombre de la columna basado en el valor de p_titulo
			CASE p_titulo
				WHEN 'PRODUCTO_INMOBILIARIO'   THEN v_columna := 'PRODUCTO_INMOBILIARIO';		
				WHEN 'DIRECTO'   			   THEN v_columna := 'DIRECTO';		
				WHEN 'TOTAL'   			   	   THEN v_columna := 'TOTAL';		
				WHEN 'FACTOR_PENDIENTE'   	   THEN v_columna := 'FACTOR_PENDIENTE';		
				ELSE
					RETURN NULL; -- Si no se encuentra la columna, retorna NULL
			END CASE;

			-- Construir la consulta dinámica
			v_sql := 'SELECT T.' || v_columna || ' FROM TBL_PARAM_VALORES_TIPOLOGIA_2025_TBL28 T WHERE VIGENCIA = :p_vigencia AND  ID = :p_id AND ROWNUM = 1';
			DBMS_OUTPUT.PUT_LINE('*****' || v_sql || ' Vigencia: ' || p_vigencia || ' ID: ' || p_id  );

			-- Ejecutar la consulta dinámica
			BEGIN
				EXECUTE IMMEDIATE v_sql INTO v_valor USING p_vigencia,p_id;
			EXCEPTION
				WHEN NO_DATA_FOUND THEN
					RETURN NULL;
				WHEN OTHERS THEN
					DBMS_OUTPUT.PUT_LINE('Error al ejecutar la consulta: ' || SQLERRM);
					RETURN NULL;
			END;

			-- Retornar el valor obtenido
			RETURN v_valor;
		END FUNC_OBTENER_VALOR_PISO_TBL28;


		--TBLAB450
		FUNCTION FUNC_OBTENER_VALOR_PISO_TBLAB450 --NIVEL_0
		(
			v_columna 	IN VARCHAR2,
			p_vigencia  IN NUMBER,
			p_estrato 	IN VARCHAR2,       -- estrato
			p_titulo 	IN VARCHAR2,       -- ''
			p_costo 	IN NUMBER,
			p_estado 	IN NUMBER
		) RETURN NUMBER IS
			v_sql 		VARCHAR2(1000);
			v_valor 	NUMBER;
		BEGIN

			-- Construir la consulta dinámica
			IF p_estado = 1 THEN
				v_sql := 'SELECT (T.CV_I_1 * 2.2 / (0.018 + (800 / NULLIF(:p_costo, 0))) * 0.938) * 1.19 FROM TBL_VALORES_COSTOS_AB450 T WHERE T.VIGENCIA =:p_vigencia AND  T.ID = :p_estrato';
			ELSIF  p_estado = 2 THEN
				v_sql := 'SELECT (T.CV_I_1 * 3.8 / (0.12  + (800 / NULLIF(:p_costo, 0))) * 0.938) * 1.19 FROM TBL_VALORES_COSTOS_AB450 T WHERE T.VIGENCIA =:p_vigencia AND T.ID = :p_estrato';
			ELSIF  p_estado = 3 THEN
				v_sql := 'SELECT T.' || v_columna || ' FROM TBL_VALORES_COSTOS_AB450 T WHERE T.VIGENCIA =:p_vigencia AND T.ID = :p_estrato';
			ELSIF  p_estado = 4 THEN
				v_sql := 'SELECT (T.CV_I_1 * 4.0 / (0.025 + (2000 / NULLIF(:p_costo, 0))) * 0.938) * 1.19 FROM TBL_VALORES_COSTOS_AB450 T WHERE T.VIGENCIA =:p_vigencia AND T.ID = :p_estrato';
			ELSE
				RETURN NULL;
			END IF;
			
			DBMS_OUTPUT.PUT_LINE('*****' || v_sql || ' :p_estrato: ' || p_estrato || ' Titulo: ' || p_titulo  );

			-- Ejecutar la consulta dinámica
			BEGIN
				IF p_estado IN (1, 2, 4) THEN
					EXECUTE IMMEDIATE v_sql INTO v_valor USING p_costo,p_vigencia, p_estrato;
				ELSIF p_estado = 3 THEN
					EXECUTE IMMEDIATE v_sql INTO v_valor USING p_vigencia,p_estrato;
				END IF;
				
			EXCEPTION
				WHEN NO_DATA_FOUND THEN
					RETURN NULL;
				WHEN OTHERS THEN
					DBMS_OUTPUT.PUT_LINE('Error al ejecutar la consulta: ' || SQLERRM);
					RETURN NULL;
			END;

			-- Retornar el valor obtenido
			RETURN v_valor;
		END FUNC_OBTENER_VALOR_PISO_TBLAB450;






		PROCEDURE SP_ACTUALIZAR_PREDIOS_GEOMETRIA_3 --NIVEL_0
		(
			p_borra IN NUMBER DEFAULT 0
		)
		IS
		BEGIN

			DBMS_OUTPUT.PUT_LINE('INICIO SP_ACTUALIZAR_PREDIOS_GEOMETRIA_3');

			IF p_borra = 1 THEN
				EXECUTE IMMEDIATE 'TRUNCATE TABLE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS';
				DBMS_OUTPUT.PUT_LINE('***BORRO*** TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS');
			END IF;


			INSERT INTO TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS 
			(
			ID_ORIGINAL,
			NUM_CONSECUTIVO,
			CHIP,
			CODIGO_BARRIO,
			CODIGO_MANZANA,
			CODIGO_PREDIO,
			CODIGO_CONSTRUCCION,
			CODIGO_RESTO,
			NOMBRE_AREA_ZONA_AREA_ACTIVIDAD,
			FORMATO_TRABAJO,
            VIGENCIA,
			AREA_NETA_URBANIZABLE_M2_2,	
			ES_UNA_MANZANA,
			AN_LOTE_10_APTOS,
			NO_DE_PISOS,
			OFERTAS_RESIDENCIAL,
			PRODUCTO_INMOBILIARIO_PRINCIPAL,
			RANGO_1_TRABAJAR,
			INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2,
			INDICE_OCUPACION_NORMA_AREA_OCUPACION_1,
			INDICE_OCUPACION_NORMA_AREA_OCUPACION_2,
			FRENTE_ANCHO,
			PARTE_POSTERIOR_LOTE,
			LINDERO_ORIENTAL_NORTE,
			LINDERO_OCCIDENTAL_SUR,
			AISLAMIENTO_LATERAL_NIVEL_DEL_SUELO,
			PATIO,
			AISLAMIENTO_POSTERIOR_ALTURA_EDIFICIO,
			AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2,
			OCUPACION_MAXIMA_CONTROL_AMBIENTAL,				
			FRENTE_DESARROLLABLE,							
			FONDO_DESARROLLABLE,								
			OCUPACION_MAXIMA_UTILIZAR_POR_DISENO,
			OCUPACION_MAXIMA_UTILIZAR_POR_DISENO_3,	
			REVISION_CIRCULAR_AREA_DE_OCUPACION,         	
			AREA_TOTAL_CONSTRUIDA_PLANTA_PROYECTO,       	
			AREA_TOTAL_CONSTRUIDA_PROYECTO,					
			AREA_EFECTIVA_PROYECTO,							
			PUNTOS_FIJOS_PORCENTAJE_AREA_TOTAL_CONSTRUIDA,	
			CIRCULACIONES_M2_PORCENTAJE_DEL_AREA_TOTAL,
			EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_1,
			EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_1,
			---------------
			AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20,							
			PF_2, 															
			AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2, 				
			NO_DE_APTOS_APROXIMADOS_2, 										
			NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2, 								
			AREA_DE_CONSTRUCCION_EFECTIVA_UNIDAD_DE_APTO_OFICINA_2,			
			CIRCULACIONES_20, 												
			AREA_DE_VENTAS_UNIDAD_DE_APTO_U_OFICINA_2, 						
			AREA_DE_VENTAS_PISO_TIPO_2
			)			
			SELECT 
			ID_ORIGINAL,
			NUM_CONSECUTIVO,
			CHIP,
			CODIGO_BARRIO,
			CODIGO_MANZANA,
			CODIGO_PREDIO,
			CODIGO_CONSTRUCCION,
			CODIGO_RESTO, 
			TRIM(TRANSLATE(UPPER(NOMBRE_AREA_ACTIVIDAD || ' - ' || ZONA_AREA_ACTIVIDAD), 'ÁÉÍÓÚáéíóú', 'AEIOUaeiou')),
			FORMATO_TRABAJO,
            VIGENCIA,
			AREA_NETA_URBANIZABLE_M2_2,
			0 AS ES_UNA_MANZANA,
			AN_LOTE_10_APTOS,
			NO_DE_PISOS,
			OFERTAS_RESIDENCIAL,
			PRODUCTO_INMOBILIARIO_PRINCIPAL,
			REPLACE(REPLACE(RANGO_1_TRABAJAR,',00',''),'.00','') AS RANGO_1_TRABAJAR,
			INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2,
			INDICE_OCUPACION_NORMA_AREA_OCUPACION_1,
			INDICE_OCUPACION_NORMA_AREA_OCUPACION_2,
			FRENTE_ANCHO,
			0 AS PARTE_POSTERIOR_LOTE,
			FONDO_ANCHO AS LINDERO_ORIENTAL_NORTE,
			0 AS LINDERO_OCCIDENTAL_SUR,
			0 AS AISLAMIENTO_LATERAL_NIVEL_DEL_SUELO,
			0 AS PATIO,
			0 AS AISLAMIENTO_POSTERIOR_ALTURA_EDIFICIO,
			AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2,
			0 AS OCUPACION_MAXIMA_CONTROL_AMBIENTAL,				
			FRENTE_ANCHO AS FRENTE_DESARROLLABLE,							
			FONDO_ANCHO  AS FONDO_DESARROLLABLE,								
			0 AS OCUPACION_MAXIMA_UTILIZAR_POR_DISENO,			
			0 AS OCUPACION_MAXIMA_UTILIZAR_POR_DISENO_3,
			0 AS REVISION_CIRCULAR_AREA_DE_OCUPACION,         	
			0 AS AREA_TOTAL_CONSTRUIDA_PLANTA_PROYECTO,       	
			0 AS AREA_TOTAL_CONSTRUIDA_PROYECTO,					
			0 AS AREA_EFECTIVA_PROYECTO,							
			0 AS PUNTOS_FIJOS_PORCENTAJE_AREA_TOTAL_CONSTRUIDA,	
			0 AS CIRCULACIONES_M2_PORCENTAJE_DEL_AREA_TOTAL,
			EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_1,
			EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_1,
			--VIVIENDA U OFICINAS PISO TIPO
			0 AS AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20,							
			0 AS PF_2, 															
			0 AS AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2, 				
			0 AS NO_DE_APTOS_APROXIMADOS_2, 										
			0 AS NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2, 								
			0 AS AREA_DE_CONSTRUCCION_EFECTIVA_UNIDAD_DE_APTO_OFICINA_2,			
			0 AS CIRCULACIONES_20, 												
			0 AS AREA_DE_VENTAS_UNIDAD_DE_APTO_U_OFICINA_2, 						
			0 AS AREA_DE_VENTAS_PISO_TIPO_2 										
			
			FROM TBL_TEMP_RESULTADO_PREDIOS;


			--E238 E239 E229
			-- UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			-- SET T.PUNTOS_FIJOS_PORCENTAJE_AREA_TOTAL_CONSTRUIDA = 0.10,
				-- CIRCULACIONES_M2_PORCENTAJE_DEL_AREA_TOTAL = 0.05,
				-- AISLAMIENTO_POSTERIOR_ALTURA_EDIFICIO = 8.30
			-- WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL); 


			--E238 E239 E229
            --INICIO TOMA EL NUMERO DE PISOS EN FORMA AUTOMATICA F4 Y F6
			MERGE INTO TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
            USING (
                SELECT 
                    T1.CHIP,
                    T1.ID_ORIGINAL,
					T1.FORMATO_TRABAJO,
                    T1.N_PISOS_SOBRE_INDICE_MAXIMO_2 AS N_PISOS_SOBRE_INDICE_MAXIMO_2
                FROM TBL_TEMP_RESULTADO_PREDIOS T1
				WHERE FORMATO_TRABAJO IN ('F2_4B','F4','F6') AND NO_DE_PISOS = 0  
            ) SRC
            ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F2_4B','F4','F6'))
            WHEN MATCHED THEN
            UPDATE SET
                T.NO_DE_PISOS = SRC.N_PISOS_SOBRE_INDICE_MAXIMO_2;

			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET 
				T.NO_DE_PISOS = N_PISOS_SOBRE_INDICE_MAXIMO_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F2_4B','F4','F6') AND T.NO_DE_PISOS = 0 );  
			--FIN TOMA EL NUMERO DE PISOS EN FORMA AUTOMATICA F4
 
			--H219
 			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.OFERTAS_RESIDENCIAL = 
			CASE
			WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5','F6') THEN
				CASE
					WHEN T.OFERTAS_RESIDENCIAL = '6' 	THEN '6'
					WHEN T.OFERTAS_RESIDENCIAL = 'VIS'  THEN 'VIS'
					WHEN T.OFERTAS_RESIDENCIAL = 'VIP'  THEN 'VIP'
					ELSE T.OFERTAS_RESIDENCIAL
				END			
			WHEN T.FORMATO_TRABAJO IN ('F2_4A') THEN
				 T.OFERTAS_RESIDENCIAL
			END	
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 
 
 
            MERGE INTO TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
            USING (
                SELECT 
                    T1.CHIP,
                    T1.ID_ORIGINAL,
					T1.FORMATO_TRABAJO,
                    T1.PUNTOS_FIJOS_PORC_AREA_TOTAL_CONSTRUIDA_1 / 100 AS PUNTOS_FIJOS_PORCENTAJE_AREA_TOTAL_CONSTRUIDA,
                    T1.CIRCULACIONES_M2_PORC_AREA_TOTAL_CONSTRUIDA_1 / 100 AS CIRCULACIONES_M2_PORCENTAJE_DEL_AREA_TOTAL,
                    T1.AISLAMIENTO_POSTERIOR_1_3_ALTURA_EDIFICIO_2 AS AISLAMIENTO_POSTERIOR_ALTURA_EDIFICIO
                FROM TBL_TEMP_RESULTADO_PREDIOS T1
            ) SRC
            ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
            WHEN MATCHED THEN
            UPDATE SET
                T.PUNTOS_FIJOS_PORCENTAJE_AREA_TOTAL_CONSTRUIDA = SRC.PUNTOS_FIJOS_PORCENTAJE_AREA_TOTAL_CONSTRUIDA,
                T.CIRCULACIONES_M2_PORCENTAJE_DEL_AREA_TOTAL = SRC.CIRCULACIONES_M2_PORCENTAJE_DEL_AREA_TOTAL,
                T.AISLAMIENTO_POSTERIOR_ALTURA_EDIFICIO = SRC.AISLAMIENTO_POSTERIOR_ALTURA_EDIFICIO;


			--H233 F3
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.OCUPACION_MAXIMA_UTILIZAR_POR_DISENO = 
			NVL(
				CASE 
					   WHEN T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2 / (NULLIF(T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2,0) / NULLIF(T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_2,0)) < 
							T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2 / (NULLIF(T.NO_DE_PISOS,0) * NULLIF(T.AN_LOTE_10_APTOS,0)) 
					   THEN T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2 / (NULLIF(T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2,0) / NULLIF(T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_2,0))
					   ELSE T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2 / (NULLIF(T.NO_DE_PISOS,0) * NULLIF(T.AN_LOTE_10_APTOS,0))
				END
			,0)
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F2_4B','F3')); 


			--J233 F3
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.OCUPACION_MAXIMA_UTILIZAR_POR_DISENO_3 = 
			NVL(
				CASE 
					   WHEN T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2 / (NULLIF(T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2,0) / NULLIF(T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_2,0)) > 
							T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2 / (NULLIF(T.NO_DE_PISOS,0) * NULLIF(T.AN_LOTE_10_APTOS,0)) 
					   THEN T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2 / (NULLIF(T.NO_DE_PISOS,0) * NULLIF(T.AN_LOTE_10_APTOS,0))
					   ELSE -10
				END
			,0)
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F2_4B','F3')); 


			--E234 F3
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.REVISION_CIRCULAR_AREA_DE_OCUPACION = 
			NVL(
				CASE 
					   WHEN T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2 / (NULLIF(T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2,0) / NULLIF(T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_2,0)) < 
							T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2 / (NULLIF(T.NO_DE_PISOS,0) * NULLIF(T.AN_LOTE_10_APTOS,0)) 
					   THEN T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2 / (NULLIF(T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2,0) / NULLIF(T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_2,0))
					   ELSE T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2 / (NULLIF(T.NO_DE_PISOS,0) * NULLIF(T.AN_LOTE_10_APTOS,0))
				END
			,0)				
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F2_4B','F3')); 

			--E235 F1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_TOTAL_CONSTRUIDA_PLANTA_PROYECTO = 
				(CASE 
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) IN('VIS','VIP','2') 	THEN 529.41  
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '3' 			THEN 564.71  
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '4' 			THEN 752.94  
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '5' 			THEN 1000.00 
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '6' 			THEN 1375.00 
					ELSE 0
				END) * T.AN_LOTE_10_APTOS
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F5')); 

			--E235 F3 F4
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_TOTAL_CONSTRUIDA_PLANTA_PROYECTO = 
			CASE 
				 WHEN T.FORMATO_TRABAJO IN ('F3') THEN T.REVISION_CIRCULAR_AREA_DE_OCUPACION
				 WHEN T.FORMATO_TRABAJO IN ('F4') THEN T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 * T.AREA_NETA_URBANIZABLE_M2_2 
				 ELSE 0
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F3','F4')); 

			--E236
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_TOTAL_CONSTRUIDA_PROYECTO = T.NO_DE_PISOS * AREA_TOTAL_CONSTRUIDA_PLANTA_PROYECTO
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E247 F1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20 = T.AREA_TOTAL_CONSTRUIDA_PLANTA_PROYECTO
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F5')); 

			--E233 F1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.OCUPACION_MAXIMA_UTILIZAR_POR_DISENO = T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20 / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0)
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1')); 

			--E247 F3
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20 = 
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F3') THEN T.OCUPACION_MAXIMA_UTILIZAR_POR_DISENO
				WHEN T.FORMATO_TRABAJO IN ('F2_4B') THEN T.OCUPACION_MAXIMA_UTILIZAR_POR_DISENO_3
				WHEN T.FORMATO_TRABAJO IN ('F4','F6') THEN T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 * T.AREA_NETA_URBANIZABLE_M2_2 
				ELSE 0
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F2_4B','F3','F4','F6')); 

			--E248
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.PF_2 = 
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F5') THEN T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20 * T.PUNTOS_FIJOS_PORCENTAJE_AREA_TOTAL_CONSTRUIDA
				WHEN T.FORMATO_TRABAJO IN ('F4') THEN T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 * T.AREA_NETA_URBANIZABLE_M2_2  * (10 / 100)
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20 * (10 / 100)
				ELSE 0 
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E249
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2 = 
			CASE 
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F5') THEN T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20 - T.PF_2
				WHEN T.FORMATO_TRABAJO IN ('F4') THEN ((T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 * T.AREA_NETA_URBANIZABLE_M2_2) - (T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 * T.AREA_NETA_URBANIZABLE_M2_2  * (10 / 100)))
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN (T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20 - (T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20 * (10 / 100)))
				ELSE 0
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E253
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET CIRCULACIONES_20 = AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20 * CIRCULACIONES_M2_PORCENTAJE_DEL_AREA_TOTAL
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 



			MERGE INTO TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
            USING (
                SELECT 
                    T1.CHIP, 
                    T1.ID_ORIGINAL, 
					T1.FORMATO_TRABAJO,
                    T1.OFERTAS_RESIDENCIAL, --E22
					T1.NOMBRE_LOCALIDAD,
					T1.CODIGO_BARRIO,
					T1.VIGENCIA
                FROM TBL_TEMP_RESULTADO_PREDIOS T1
            ) SRC
            ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
            WHEN MATCHED THEN
            UPDATE SET 
			 T.NO_DE_APTOS_APROXIMADOS_2 = 
				CASE 
				WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' THEN
						CASE 
							WHEN UPPER(T.OFERTAS_RESIDENCIAL) IN('VIS','2') THEN (T.AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2 - CIRCULACIONES_20) /
								 NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',SRC.VIGENCIA,UPPER(SRC.NOMBRE_LOCALIDAD),UPPER(SRC.CODIGO_BARRIO),UPPER(SRC.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL)	
							
							WHEN UPPER(T.OFERTAS_RESIDENCIAL) IN('3') THEN (T.AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2 - CIRCULACIONES_20) /
								 NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',SRC.VIGENCIA,UPPER(SRC.NOMBRE_LOCALIDAD),UPPER(SRC.CODIGO_BARRIO),UPPER(SRC.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL)	
							ELSE (T.AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2 - CIRCULACIONES_20) /
								 NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',SRC.VIGENCIA,UPPER(SRC.NOMBRE_LOCALIDAD),UPPER(SRC.CODIGO_BARRIO),UPPER(SRC.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL)	
						END
				ELSE
					CASE	
						WHEN UPPER(SRC.OFERTAS_RESIDENCIAL) IN('VIP') THEN (T.AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2 - CIRCULACIONES_20) / 
							NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',SRC.VIGENCIA,UPPER(SRC.NOMBRE_LOCALIDAD),UPPER(SRC.CODIGO_BARRIO),UPPER(SRC.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL)
						
						WHEN UPPER(SRC.OFERTAS_RESIDENCIAL) IN('VIS','2') THEN (T.AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2 - CIRCULACIONES_20) / 
							NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',SRC.VIGENCIA,UPPER(SRC.NOMBRE_LOCALIDAD),UPPER(SRC.CODIGO_BARRIO),UPPER(SRC.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL)
						
						WHEN UPPER(SRC.OFERTAS_RESIDENCIAL) = '3' THEN (T.AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2 - CIRCULACIONES_20) / 
							NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',SRC.VIGENCIA, UPPER(SRC.NOMBRE_LOCALIDAD),UPPER(SRC.CODIGO_BARRIO),UPPER(SRC.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL)
						
						WHEN UPPER(SRC.OFERTAS_RESIDENCIAL) = '4' THEN (T.AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2 - CIRCULACIONES_20) / 
							NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',SRC.VIGENCIA, UPPER(SRC.NOMBRE_LOCALIDAD),UPPER(SRC.CODIGO_BARRIO),UPPER(SRC.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL)

						WHEN UPPER(SRC.OFERTAS_RESIDENCIAL) = '5' THEN (T.AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2 - CIRCULACIONES_20) / 
							NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',SRC.VIGENCIA, UPPER(SRC.NOMBRE_LOCALIDAD),UPPER(SRC.CODIGO_BARRIO),UPPER(SRC.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL)
						
						WHEN UPPER(SRC.OFERTAS_RESIDENCIAL) = '6' THEN (T.AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2 - CIRCULACIONES_20) / 
							NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',SRC.VIGENCIA, UPPER(SRC.NOMBRE_LOCALIDAD),UPPER(SRC.CODIGO_BARRIO),UPPER(SRC.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL)
						ELSE 0 
					END	
				END;

			--E251 F1 F3 F4 REDONDEAR.MENOS (FLOOR) MAS (CEIL) REDONDEAR(ROUND)
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2 = ROUND(T.NO_DE_APTOS_APROXIMADOS_2,0)
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E252
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_DE_CONSTRUCCION_EFECTIVA_UNIDAD_DE_APTO_OFICINA_2 = T.AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2 / NULLIF(T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2,0)
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E254
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_DE_VENTAS_UNIDAD_DE_APTO_U_OFICINA_2 = T.AREA_DE_CONSTRUCCION_EFECTIVA_UNIDAD_DE_APTO_OFICINA_2 - (T.CIRCULACIONES_20 / NULLIF(T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2,0))
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E255
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_DE_VENTAS_PISO_TIPO_2 = T.AREA_DE_VENTAS_UNIDAD_DE_APTO_U_OFICINA_2 * T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E257_1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.NO_DE_ESTACIONAMIENTOS_BICICLETAS_PISO_TIPO_1 = 
				CASE
					WHEN AREA_DE_CONSTRUCCION_EFECTIVA_UNIDAD_DE_APTO_OFICINA_2 < 80  THEN 1
					WHEN AREA_DE_CONSTRUCCION_EFECTIVA_UNIDAD_DE_APTO_OFICINA_2 < 120 THEN 2
					WHEN AREA_DE_CONSTRUCCION_EFECTIVA_UNIDAD_DE_APTO_OFICINA_2 > 120 THEN 3
					ELSE NULL
				 END   
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E257_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.NO_DE_ESTACIONAMIENTOS_BICICLETAS_PISO_TIPO_2 = T.NO_DE_ESTACIONAMIENTOS_BICICLETAS_PISO_TIPO_1 * T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E258_1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_CONSTRUIDA_PARA_EL_CALCULO_DE_ESTACIONAMIENTOS_1 = 1.70
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E258_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_CONSTRUIDA_PARA_EL_CALCULO_DE_ESTACIONAMIENTOS_2 = T.AREA_CONSTRUIDA_PARA_EL_CALCULO_DE_ESTACIONAMIENTOS_1 * T.NO_DE_ESTACIONAMIENTOS_BICICLETAS_PISO_TIPO_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


			--E259_1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_1 = 
				CASE 
					WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'GRANDES SERVICIOS METROPOLITANOS - GRANDES SERVICIOS METROPOLITANOS' THEN
					  CASE
						WHEN REGEXP_LIKE(T.OFERTAS_RESIDENCIAL, '^\d+$') AND TO_NUMBER(T.OFERTAS_RESIDENCIAL) >= 4 THEN 35 / 100
						ELSE 20 / 100
					END
				ELSE 	
					CASE 
						WHEN UPPER(T.OFERTAS_RESIDENCIAL) IN ('VIS','VIP') THEN
							CASE
								WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'ESTRUCTURANTE - RECEPTORA DE VIVIENDA DE INTERES SOCIAL' THEN 0
								WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'ESTRUCTURANTE - RECEPTORA DE ACTIVIDADES ECONOMICAS'     THEN 0
								WHEN T.AREA_VENDIBLE_DE_COMERCIO_1_PISO_2 > 4000 OR  T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - GENERADORA DE SOPORTES URBANOS' THEN 5 / 100
								WHEN T.AREA_VENDIBLE_DE_COMERCIO_1_PISO_2 > 4000 AND T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS'  THEN 5 / 100
								WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS'  AND T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS' THEN 6 / 100
								WHEN UPPER(T.OFERTAS_RESIDENCIAL) <> 'VIS' AND T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS' THEN 8 / 100
								WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'GRANDES SERVICIOS METROPOLITANOS - GRANDES SERVICIOS METROPOLITANOS' THEN 0
								ELSE 0
							END
						WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '3' THEN
							CASE
								WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'ESTRUCTURANTE - RECEPTORA DE VIVIENDA DE INTERES SOCIAL' THEN 10 / 100
								WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'ESTRUCTURANTE - RECEPTORA DE ACTIVIDADES ECONOMICAS' THEN 15 / 100
								WHEN T.AREA_VENDIBLE_DE_COMERCIO_1_PISO_2 > 4000 OR  T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - GENERADORA DE SOPORTES URBANOS' THEN 15 / 100
								WHEN T.AREA_VENDIBLE_DE_COMERCIO_1_PISO_2 > 4000 AND T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS'  THEN 20 / 100
								WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS'  AND T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS' THEN 20 / 100
								WHEN UPPER(T.OFERTAS_RESIDENCIAL) <> 'VIS' AND T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS' THEN 20 / 100
								WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'GRANDES SERVICIOS METROPOLITANOS - GRANDES SERVICIOS METROPOLITANOS' THEN 20 / 100
								ELSE 0
							END
						WHEN UPPER(T.OFERTAS_RESIDENCIAL) IN ('4', '5', '6') THEN
							CASE
								WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'ESTRUCTURANTE - RECEPTORA DE VIVIENDA DE INTERES SOCIAL' THEN 25 / 100
								WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'ESTRUCTURANTE - RECEPTORA DE ACTIVIDADES ECONOMICAS'     THEN 30 / 100
								WHEN T.AREA_VENDIBLE_DE_COMERCIO_1_PISO_2 > 4000 OR  T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - GENERADORA DE SOPORTES URBANOS' THEN 25 / 100
								WHEN T.AREA_VENDIBLE_DE_COMERCIO_1_PISO_2 > 4000 AND T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS'  THEN 35 / 100
								WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS'  AND T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS' THEN 35 / 100
								WHEN UPPER(T.OFERTAS_RESIDENCIAL) <> 'VIS' AND T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS' THEN 35 / 100
								WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'GRANDES SERVICIOS METROPOLITANOS - GRANDES SERVICIOS METROPOLITANOS' THEN 35 / 100
								ELSE 0
							END
						ELSE 0
					END
				END	
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));   			
	
			--E259_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_2 = T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_1 * T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E260_1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.NO_MINIMO_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_1 = 23.10
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E260_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.NO_MINIMO_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_2 = T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_2 / NULLIF(T.NO_MINIMO_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_1,0)
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E268_1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.FRENTE_1 = 0.70
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E268_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.FRENTE_2 = T.FRENTE_1 * T.FRENTE_ANCHO
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


            --E269_1
			MERGE INTO TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
            USING (
                SELECT 
                    T1.CHIP, 
                    T1.ID_ORIGINAL, 
					T1.FORMATO_TRABAJO,
                    T1.PORCENTAJE_DESTINACION / 100 AS FACHADA_ACTIVA_COMERCIO_1
                FROM TBL_TEMP_RESULTADO_PREDIOS T1
            ) SRC
            ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
            WHEN MATCHED THEN
            UPDATE SET 
                T.FACHADA_ACTIVA_COMERCIO_1 = SRC.FACHADA_ACTIVA_COMERCIO_1;            

			--E269_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.FACHADA_ACTIVA_COMERCIO_2 = T.FACHADA_ACTIVA_COMERCIO_1 * T.FRENTE_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E270_1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1 = 4.0
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 



			--E261_2 PAR
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_2 = 
			CASE
				WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' AND T.AREA_EFECTIVA_PROYECTO < 800 THEN 0
				WHEN (T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2 * (T.NO_DE_PISOS - 1)) < 5 THEN 0
				WHEN  UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN 
					CASE 
							WHEN (T.NO_DE_PISOS - 1) * T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2 < 150 THEN (T.NO_DE_PISOS - 1) * T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2 * 6 / NULLIF(T.NO_DE_PISOS - 1, 0)
							ELSE 
							  (((T.NO_DE_PISOS - 1) * T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2 - 150) * 8.5 + 150 * 6) / NULLIF(T.NO_DE_PISOS - 1, 0)
					END 
				WHEN  UPPER(T.OFERTAS_RESIDENCIAL) = 'OFICINAS' THEN T.EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_1 * T.AREA_DE_CONSTRUCCION_EFECTIVA_UNIDAD_DE_APTO_OFICINA_2
				ELSE T.AREA_DE_CONSTRUCCION_EFECTIVA_UNIDAD_DE_APTO_OFICINA_2 * T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2 * T.EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_1
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


			--E267_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_21 = T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E263_1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.SERVICIOS_COMUNALES_EN_AREAS_CONSTRUIDAS_10 = 0.20
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E263_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.SERVICIOS_COMUNALES_EN_AREAS_CONSTRUIDAS_20 = T.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_2 * T.SERVICIOS_COMUNALES_EN_AREAS_CONSTRUIDAS_10
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 





			--L270
			MERGE INTO TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
            USING (
                SELECT 
                    T1.CHIP, 
                    T1.ID_ORIGINAL, 
					T1.FORMATO_TRABAJO,
                    T1.PORCENTAJE_DESTINACION / 100 AS FACHADA_ACTIVA_COMERCIO_1,
					T1.NOMBRE_AREA_ACTIVIDAD
                FROM TBL_TEMP_RESULTADO_PREDIOS T1
            ) SRC
            ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
            WHEN MATCHED THEN
            UPDATE SET 
            T.AREA_CALCULADA_LOCALES = 
			CASE 
				WHEN UPPER(SRC.NOMBRE_AREA_ACTIVIDAD) = 'PROXIMIDAD' THEN
				CASE 
						WHEN ((T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_21 - T.PF_2 - T.SERVICIOS_COMUNALES_EN_AREAS_CONSTRUIDAS_20 * (T.NO_DE_PISOS-1) - T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_2 * (T.NO_DE_PISOS-1) - T.AREA_CONSTRUIDA_PARA_EL_CALCULO_DE_ESTACIONAMIENTOS_2 * (T.NO_DE_PISOS-1)) * 0.8) < 100
						THEN (T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_21  - T.PF_2 - T.SERVICIOS_COMUNALES_EN_AREAS_CONSTRUIDAS_20 * (T.NO_DE_PISOS-1) - T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_2 * (T.NO_DE_PISOS-1) - T.AREA_CONSTRUIDA_PARA_EL_CALCULO_DE_ESTACIONAMIENTOS_2 * (T.NO_DE_PISOS-1)) * 0.8
						ELSE 100
				END
			ELSE
				CASE 
						WHEN ((T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_21 - T.PF_2 - T.SERVICIOS_COMUNALES_EN_AREAS_CONSTRUIDAS_20 * (T.NO_DE_PISOS-1) - T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_2 * (T.NO_DE_PISOS-1) - T.AREA_CONSTRUIDA_PARA_EL_CALCULO_DE_ESTACIONAMIENTOS_2 * (T.NO_DE_PISOS-1)) * 0.8 ) < 500
						THEN (T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_21  - T.PF_2 - T.SERVICIOS_COMUNALES_EN_AREAS_CONSTRUIDAS_20 * (T.NO_DE_PISOS-1) - T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_2 * (T.NO_DE_PISOS-1) - T.AREA_CONSTRUIDA_PARA_EL_CALCULO_DE_ESTACIONAMIENTOS_2 * (T.NO_DE_PISOS-1)) * 0.8
						ELSE 500
				END
			END;	

			--I270
			MERGE INTO TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
            USING (
                SELECT 
                    T1.CHIP, 
                    T1.ID_ORIGINAL, 
					T1.FORMATO_TRABAJO,
                    T1.PORCENTAJE_DESTINACION / 100 AS FACHADA_ACTIVA_COMERCIO_1,
					T1.NOMBRE_AREA_ACTIVIDAD
                FROM TBL_TEMP_RESULTADO_PREDIOS T1
            ) SRC
            ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
            WHEN MATCHED THEN
            UPDATE SET 
			T.AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_2 = 
			CASE 
			WHEN T.FORMATO_TRABAJO IN ('F1','F3','F4','F5','F6') THEN
				CASE 
					WHEN UPPER(SRC.NOMBRE_AREA_ACTIVIDAD) = 'PROXIMIDAD' THEN
					CASE 
						WHEN (CASE WHEN AREA_CALCULADA_LOCALES < (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1) THEN (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1) ELSE AREA_CALCULADA_LOCALES END) > 100 THEN 100
						WHEN (CASE WHEN AREA_CALCULADA_LOCALES < (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1) THEN (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1) ELSE AREA_CALCULADA_LOCALES END) < (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1) THEN (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1)
						ELSE (CASE WHEN AREA_CALCULADA_LOCALES < (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1) THEN (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1) ELSE AREA_CALCULADA_LOCALES END)
					END
				ELSE
					CASE 
						WHEN (CASE WHEN AREA_CALCULADA_LOCALES < (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1) THEN (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1) ELSE AREA_CALCULADA_LOCALES END) > 500 THEN 500
						WHEN (CASE WHEN AREA_CALCULADA_LOCALES < (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1) THEN (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1) ELSE AREA_CALCULADA_LOCALES END) < (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1) THEN (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1)
						ELSE (CASE WHEN AREA_CALCULADA_LOCALES < (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1) THEN (FACHADA_ACTIVA_COMERCIO_2 * AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1) ELSE AREA_CALCULADA_LOCALES END)
					END
				END	
			WHEN T.FORMATO_TRABAJO IN ('F2_4A','F2_4B') THEN				
				 T.FACHADA_ACTIVA_COMERCIO_2 * T.AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_1	
			END;				


			--E271_1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.CIRCULACIONES_21 = AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_2 * CIRCULACIONES_M2_PORCENTAJE_DEL_AREA_TOTAL
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E272_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_VENDIBLE_DE_COMERCIO_1_PISO_2 = AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_2 - CIRCULACIONES_21
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E273-1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.NO_DE_ESTACIONAMIENTOS_BICICLETAS_LOCALES_1 = 1 / 100
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E273-2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.NO_DE_ESTACIONAMIENTOS_BICICLETAS_LOCALES_2 = T.NO_DE_ESTACIONAMIENTOS_BICICLETAS_LOCALES_1 * T.AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 



			--E237 F1 F3 F5
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_EFECTIVA_PROYECTO = 
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F5') THEN (AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2 * (NO_DE_PISOS - 1)) + AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_2
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN (((T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 * AREA_NETA_URBANIZABLE_M2_2) - (T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 * T.AREA_NETA_URBANIZABLE_M2_2 * 0.1)) * NO_DE_PISOS)
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F5','F6')); 

			--E237 F4
            MERGE INTO TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
            USING (
                SELECT 
                    T1.CHIP, 
                    T1.ID_ORIGINAL, 
					T1.FORMATO_TRABAJO,
                    T1.PORCENTAJE_DESTINACION AS PORCENTAJE_DESTINACION,
					T1.TBL_CONSOLIDACION_ALTURA_PR_1 AS TBL_CONSOLIDACION_ALTURA_PR_1
                FROM TBL_TEMP_RESULTADO_PREDIOS T1
            ) SRC
            ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F4'))
            WHEN MATCHED THEN
            UPDATE SET 
                T.AREA_EFECTIVA_PROYECTO = (((T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 * T.AREA_NETA_URBANIZABLE_M2_2) - 
											 (T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 * T.AREA_NETA_URBANIZABLE_M2_2 * 0.1)) * (SRC.TBL_CONSOLIDACION_ALTURA_PR_1 - 1)) +  
											 (T.FRENTE_1 * T.FRENTE_ANCHO * (SRC.PORCENTAJE_DESTINACION / 100) * (T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 * T.AREA_NETA_URBANIZABLE_M2_2 * 0.1));

			--E261_2 PAR
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_2 = 
			CASE
				WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' AND T.AREA_EFECTIVA_PROYECTO < 800 THEN 0
				WHEN (T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2 * (T.NO_DE_PISOS - 1)) < 5 THEN 0
				WHEN  UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN 
					CASE 
							WHEN (T.NO_DE_PISOS - 1) * T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2 < 150 THEN (T.NO_DE_PISOS - 1) * T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2 * 6 / NULLIF(T.NO_DE_PISOS - 1, 0)
							ELSE 
							  (((T.NO_DE_PISOS - 1) * T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2 - 150) * 8.5 + 150 * 6) / NULLIF(T.NO_DE_PISOS - 1, 0)
					END 
				WHEN  UPPER(T.OFERTAS_RESIDENCIAL) = 'OFICINAS' THEN T.EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_1 * T.AREA_DE_CONSTRUCCION_EFECTIVA_UNIDAD_DE_APTO_OFICINA_2
				ELSE T.AREA_DE_CONSTRUCCION_EFECTIVA_UNIDAD_DE_APTO_OFICINA_2 * T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2 * T.EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_1
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


			--E261_1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_1 = T.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_2 * (T.NO_DE_PISOS - 1)
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E262_1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.EQUIPAMIENTO_DESTINADO_A_ESTACIONAMIENTOS_PARA_BICICLETAS_10 = 0.40
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E262_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.EQUIPAMIENTO_DESTINADO_A_ESTACIONAMIENTOS_PARA_BICICLETAS_20 = T.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_2 * T.EQUIPAMIENTO_DESTINADO_A_ESTACIONAMIENTOS_PARA_BICICLETAS_10
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 



			--E264_1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.ZONAS_VERDES_RECREATIVAS_EN_AREAS_LIBRES_10 = 0.40
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E264_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.ZONAS_VERDES_RECREATIVAS_EN_AREAS_LIBRES_20 = T.ZONAS_VERDES_RECREATIVAS_EN_AREAS_LIBRES_10 * T.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 




			--E274-1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_1 = 
				CASE 
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN
						CASE
							WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'ESTRUCTURANTE - RECEPTORA DE VIVIENDA DE INTERES SOCIAL' THEN 0
							WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'ESTRUCTURANTE - RECEPTORA DE ACTIVIDADES ECONOMICAS' THEN 0
							WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - GENERADORA DE SOPORTES URBANOS' THEN 5 / 100
							WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS' THEN 5 / 100
							WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS' THEN 6 / 100
							WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS' THEN 8 / 100
							WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'GRANDES SERVICIOS METROPOLITANOS - GRANDES SERVICIOS METROPOLITANOS' THEN 0
							ELSE 0
						END
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) <> 'VIS' THEN
						CASE
							WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'ESTRUCTURANTE - RECEPTORA DE VIVIENDA DE INTERES SOCIAL' THEN 10 / 100
							WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'ESTRUCTURANTE - RECEPTORA DE ACTIVIDADES ECONOMICAS' THEN 15 / 100
							WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - GENERADORA DE SOPORTES URBANOS' THEN 15 / 100
							WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS' THEN 20 / 100
							WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS' THEN 20 / 100
							WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS' THEN 20 / 100
							WHEN T.NOMBRE_AREA_ZONA_AREA_ACTIVIDAD = 'GRANDES SERVICIOS METROPOLITANOS - GRANDES SERVICIOS METROPOLITANOS' THEN 20 / 100
							ELSE 0
						END
					ELSE -10 --'Revisar'
				END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

			--E274-2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_2 = 
				CASE
					WHEN T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_1 * T.AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_2 < 23.1 THEN 23.1
					ELSE T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_1 * T.AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_2
				END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E275-1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.NO_MINIMO_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_1 = T.NO_MINIMO_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_1
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E275-2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.NO_MINIMO_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_2 = T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_2 / NULLIF(T.NO_MINIMO_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_1,0)
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E276-1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_CONSTRUIDA_1 = 0.08
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL); 

			--E276-2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_CONSTRUIDA_2 = 
			CASE 
				WHEN T.AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_2 < 800 THEN 0 
				ELSE T.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_CONSTRUIDA_1 * T.AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_2
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E277-1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.EQUIPAMIENTO_DESTINADO_A_ESTACIONAMIENTOS_PARA_BICICLETAS_11 = 0.40
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E277-2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.EQUIPAMIENTO_DESTINADO_A_ESTACIONAMIENTOS_PARA_BICICLETAS_21 = T.EQUIPAMIENTO_DESTINADO_A_ESTACIONAMIENTOS_PARA_BICICLETAS_11 * T.AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E278-1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.SERVICIOS_COMUNALES_EN_AREAS_CONSTRUIDAS_11 = 0.20
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E278-2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.SERVICIOS_COMUNALES_EN_AREAS_CONSTRUIDAS_21 = T.SERVICIOS_COMUNALES_EN_AREAS_CONSTRUIDAS_11 * T.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_CONSTRUIDA_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E279-1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.ZONAS_VERDES_RECREATIVAS_EN_AREAS_LIBRES_11 = 0.40
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E279-2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.ZONAS_VERDES_RECREATIVAS_EN_AREAS_LIBRES_21 = T.ZONAS_VERDES_RECREATIVAS_EN_AREAS_LIBRES_11 * T.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_CONSTRUIDA_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 
			

		----=======================================================================================================================CALCULOS TEMPORAL

			----E54_2--FORMULA
            MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
            USING (
                SELECT 
                    T1.CHIP, 
                    T1.ID_ORIGINAL, 
					T1.FORMATO_TRABAJO,
                    T1.AREA_EFECTIVA_PROYECTO AS INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_2
                FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
            ) SRC
            ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F5','F6'))
            WHEN MATCHED THEN
            UPDATE SET 
                T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_2 = SRC.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_2;


			--E54_2--FORMULA
			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET 
				T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_2 = 
				ROUND((((T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 * AREA_NETA_URBANIZABLE_M2_2) - (T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 * AREA_NETA_URBANIZABLE_M2_2 * 0.1)) * (T.TBL_CONSOLIDACION_ALTURA_PR_1 -1)) +
				(0.7 * T.FRENTE_ANCHO * (T.PORCENTAJE_DESTINACION / 100) * (T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 * T.AREA_NETA_URBANIZABLE_M2_2 * 0.1)),2)
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F4'));  


			--E54_1--FORMULA
			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET 
			T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 = 
			CASE 
			WHEN T.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F5') THEN
				CASE
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_2 / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0) > T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_1 THEN -10
					ELSE T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_2 / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0)
				END		
			WHEN T.FORMATO_TRABAJO IN ('F4','F6') THEN
				 T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_2 / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0)
			END	
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

			--E70_2 1 Y 2 PAR
			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_MENOS_PUNTOS_FIJOS_CIRCULACIONES_2 = AREA_CONSTRUIDA_ANTES_CIRCULACIONES_EQUIPAMIENTO_2 - PUNTOS_FIJOS_PORC_AREA_TOTAL_CONSTRUIDA_2 - CIRCULACIONES_M2_PORC_AREA_TOTAL_CONSTRUIDA_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));     	

			--E70_2 E71_1
			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_1  = 
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3') THEN 0.80
				WHEN T.FORMATO_TRABAJO IN ('F4') THEN 
					CASE 
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 3 THEN 0
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 4 THEN 0.025
						ELSE 0.03
					END
				WHEN T.FORMATO_TRABAJO IN ('F5') THEN	
					CASE
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2 THEN 0
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 3 THEN 0.04
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 4 THEN 0.06
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 5 THEN 0.03
						ELSE 0.06
					END	
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN	
					CASE
						WHEN T.AREA_NETA_URBANIZABLE_CALCULO_2 > 2000 THEN (20 / 100)
						ELSE 0
					END		
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));     	


			--E38_2--FORMULA
			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET T.CARGA_GENERAL_ARTICULO_285_1 = 
			CASE
				WHEN T.PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO <> 0 AND T.FORMATO_TRABAJO IN('F4','F5','F6') THEN 0
				WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 0.2  THEN 0
				WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1.57 THEN 3
				WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1.82 THEN 6
				WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.32 THEN 12
				WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.57 THEN 15
				WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.82 THEN 18
				ELSE -10 --'Revisar'
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  


			--E38_2--FORMULA
			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET T.CARGA_GENERAL_ARTICULO_285_2 = 
			CASE 
				WHEN T.PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO <> 0 AND T.FORMATO_TRABAJO IN('F4','F5','F6') THEN 0
				ELSE 
				(T.CARGA_GENERAL_ARTICULO_285_1 * T.AREA_NETA_URBANIZABLE_CALCULO_2) / 100
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET T.CARGA_LOCAL_EN_SUELO_1 = 
			CASE
			WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3') THEN
				CASE 
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1     THEN 17
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1.25  THEN 23
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1.75  THEN 34
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2     THEN 34
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.25  THEN 34
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.5   THEN 34
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.82  THEN 35
					ELSE -10 --'Revisar'
				END
			WHEN T.FORMATO_TRABAJO IN ('F4') THEN
			CASE 
				WHEN T.PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO <> 0 THEN
					CASE
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2 THEN 0
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 3 THEN 5
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 4 THEN 10
						ELSE 10
					END
				ELSE
					CASE
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1 	THEN 17
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1.25 	THEN 23
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1.75 	THEN 34
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2 	THEN 34
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.25 	THEN 34
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.5 	THEN 34
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.82 	THEN 35
						ELSE -10 --'Revisar'
					END
			END			
			WHEN T.FORMATO_TRABAJO IN ('F5') THEN	
			CASE
				WHEN T.PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO <> 0 THEN
					CASE
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1.3 THEN 0
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2   THEN 20
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 3   THEN 20
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 4   THEN 20
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 5   THEN 20
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 6   THEN 20
						ELSE 25 
					END
				ELSE
					CASE
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1 	THEN 17
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1.25 	THEN 23
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1.75 	THEN 34
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2 	THEN 34
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.25 	THEN 34
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.5 	THEN 34
						WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.82 	THEN 35
						ELSE -10 --'Revisar' 
					END
			END
			WHEN T.FORMATO_TRABAJO IN ('F6') THEN	
				CASE 
					WHEN (T.AREA_TERRENO_CALCULADA - T.AREA_TOTAL_RESERVAS_URBANAS) > 2000 AND (T.AREA_TERRENO_CALCULADA - T.AREA_TOTAL_RESERVAS_URBANAS) <= 5000 THEN 25
					WHEN (T.AREA_TERRENO_CALCULADA - T.AREA_TOTAL_RESERVAS_URBANAS) > 5000 THEN 30
					ELSE 0
				END
			END	
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  


			--E40_2
			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET T.CARGA_LOCAL_EN_SUELO_2 = (T.CARGA_LOCAL_EN_SUELO_1 / 100) * T.AREA_NETA_URBANIZABLE_CALCULO_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

			--E42_1 F1,F3,F5,F4
			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET T.CARGA_LOCAL_COMPENSAR_EN_DINERO_1 = 
			CASE
			WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3') THEN
				CASE
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1     THEN 0
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1.25  THEN 0
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1.75  THEN 0 
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2     THEN 5
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.25  THEN 11
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.5   THEN 16
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.82  THEN 22
					ELSE -10 --'Revisar'
				END
			WHEN T.FORMATO_TRABAJO IN ('F4','F6') THEN
				CASE 
				WHEN T.PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO <> 0 THEN
						CASE
							WHEN T.AREA_TERRENO_CALCULADA > (10000 - T.AREA_TOTAL_RESERVAS_URBANAS) THEN 0
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 > 4 THEN 5
							ELSE 0
						END
				ELSE
						CASE
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1 	THEN 0
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1.25 	THEN 0
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1.75 	THEN 0
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2 	THEN 5
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.25 	THEN 11
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.5 	THEN 16
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.82 	THEN 22
							ELSE -10 --'Revisar' 
						END
				END
			WHEN T.FORMATO_TRABAJO IN ('F5') THEN
				CASE 
				WHEN T.PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO <> 0 THEN
						CASE 
							--WHEN (D30 - D32) > 10000 THEN 0
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2 THEN 0
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 3 THEN 7
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 4 THEN 15
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 5 THEN 25
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 6 THEN 34
							ELSE 35				
						END				
				ELSE
						CASE
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1 	THEN 17
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1.25 	THEN 23
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 1.75 	THEN 34
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2 	THEN 34
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.25 	THEN 34
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.5 	THEN 34
							WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 <= 2.82 	THEN 35
							ELSE -10 --'Revisar' 
						END
				END	
			END	
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

			--E42_2
			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET T.CARGA_LOCAL_COMPENSAR_EN_DINERO_2 = (T.CARGA_LOCAL_COMPENSAR_EN_DINERO_1 / 100) * AREA_NETA_URBANIZABLE_CALCULO_2,
				T.EQUIPAMIENTO_COMUNAL_PUBLICO_1 = 
			CASE 
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F5') THEN 8
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN 3
				WHEN T.FORMATO_TRABAJO IN ('F4') THEN
					CASE 
						WHEN T.PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO <> 0 THEN 3
						ELSE 8
					END				
			END	
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

			--E41_2
			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET T.CARGA_LOCAL_COMPENSAR_EN_CONTROL_2 = 
			CASE
				WHEN (T.CONTROL_AMBIENTAL_154_2 / 1.5) > (0.25 * (T.CARGA_LOCAL_EN_SUELO_2 + T.CARGA_LOCAL_COMPENSAR_EN_DINERO_2)) THEN 0.25 * (T.CARGA_LOCAL_EN_SUELO_2 + T.CARGA_LOCAL_COMPENSAR_EN_DINERO_2)
				ELSE (T.CONTROL_AMBIENTAL_154_2 / 1.5)
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

			--E43_2
			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET T.EQUIPAMIENTO_COMUNAL_PUBLICO_2 = 
			CASE
				WHEN T.PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO <> 0 AND T.FORMATO_TRABAJO IN('F4','F5','F6') THEN 0
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F6') THEN (T.EQUIPAMIENTO_COMUNAL_PUBLICO_1 / 100) * T.AREA_NETA_URBANIZABLE_CALCULO_2
				WHEN T.FORMATO_TRABAJO IN ('F4') AND  (T.AREA_TERRENO_CALCULADA - T.AREA_TOTAL_RESERVAS_URBANAS) > 20000 THEN (T.EQUIPAMIENTO_COMUNAL_PUBLICO_1 / 100) * (T.AREA_TERRENO_CALCULADA - T.AREA_TOTAL_RESERVAS_URBANAS)
				WHEN T.FORMATO_TRABAJO IN ('F5') AND  (T.AREA_TERRENO_CALCULADA - T.AREA_TOTAL_RESERVAS_URBANAS) > 20000 THEN (T.EQUIPAMIENTO_COMUNAL_PUBLICO_1 / 100) * T.AREA_NETA_URBANIZABLE_CALCULO_2
				ELSE 0
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E44_2
			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET T.TOTAL_CARGA_LOCAL_EN_SITIO_2 = 
				CASE
					WHEN T.EQUIPAMIENTO_COMUNAL_PUBLICO_2 < 500 THEN (T.CARGA_LOCAL_EN_SUELO_2 - T.CARGA_LOCAL_COMPENSAR_EN_CONTROL_2)
					ELSE (T.CARGA_LOCAL_EN_SUELO_2 - T.CARGA_LOCAL_COMPENSAR_EN_CONTROL_2 + T.EQUIPAMIENTO_COMUNAL_PUBLICO_2)
				END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

		----=======================================================================================================================FIN CALCULOS TEMPORAL

			--E98 1 Y 2 PAR
			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET 
			T.INDICE_DE_CONSTRUCCION_EFECTIVO_CONCRETADO_AREA_2 = T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));     	

			--E71_2 1 Y 2 PAR
			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2 = 
			CASE
				WHEN T.PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO <> 0 AND T.FORMATO_TRABAJO IN('F4','F5','F6') THEN 0
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3') THEN T.AREA_NETA_URBANIZABLE_M2_2 * (T.AREA_UTIL_PARA_CARGA_VIP_293_1 / 100) * T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_1
				WHEN T.FORMATO_TRABAJO IN ('F4','F5') THEN T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_1 * T.INDICE_DE_CONSTRUCCION_EFECTIVO_CONCRETADO_AREA_2
			    WHEN T.FORMATO_TRABAJO IN ('F6') THEN T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_1 * (T.AREA_VENDIBLE_COMERCIO_2 + T.AREA_VENDIBLE_OFICINA_2 + T.AREA_VENDIBLE_VIVIENDA_2)
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));     	

			--E71_2 1 Y 2 PAR
			MERGE INTO TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
            USING (
                SELECT 
                    T1.CHIP,
                    T1.ID_ORIGINAL,
					T1.FORMATO_TRABAJO,
                    T1.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2 AS AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2
                FROM TBL_TEMP_RESULTADO_PREDIOS T1
            ) SRC
            ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
            WHEN MATCHED THEN
            UPDATE SET
                T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2 = SRC.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2;


			--E283 E285 E286
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.NO_PISOS_CONSTRUIDOS_2 							= T.NO_DE_PISOS ,
			T.AREA_CONSTRUIDA_EFECTIVA_COMERCIO_2				= T.AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_2 ,
			T.AREA_CONSTRUIDA_EFECTIVA_VIVIENDA_U_OFICINAS_2 	=
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5') THEN T.AREA_DE_CONSTRUCCION_EFECTIVA_UNIDAD_DE_APTO_OFICINA_2 * T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2 * (T.NO_DE_PISOS - 1)
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN T.AREA_DE_CONSTRUCCION_EFECTIVA_UNIDAD_DE_APTO_OFICINA_2 * T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2 * (T.NO_DE_PISOS - 1)	+ 0
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E288_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_VIVIENDA_VIP_2 = 
			CASE 
				WHEN UPPER(T.OFERTAS_RESIDENCIAL) IN('VIP') THEN T.AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2 * (T.NO_DE_PISOS - 1)
				WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) <> 'VIVIENDA' THEN 0
				WHEN UPPER(T.OFERTAS_RESIDENCIAL) IN('VIS','3') THEN T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2
				ELSE 0
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E288_1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_VIVIENDA_VIP_1 = T.AREA_CONSTRUIDA_VIVIENDA_VIP_2 /  NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0)
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E284 --E287 --E289 --E280 
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_EFECTIVA_2 				= T.AREA_CONSTRUIDA_EFECTIVA_COMERCIO_2 + T.AREA_CONSTRUIDA_EFECTIVA_VIVIENDA_U_OFICINAS_2,
			T.AREA_CONSTRUIDA_APTO_U_OFICINAS_2 		= AREA_CONSTRUIDA_EFECTIVA_POR_PISO_PLANTA_TIPO_2 * (T.NO_DE_PISOS - 1) - T.AREA_CONSTRUIDA_VIVIENDA_VIP_2,
			T.PUNTOS_FIJOS_2							= T.PF_2 * T.NO_DE_PISOS,
			T.CIRCULACIONES_2							= T.CIRCULACIONES_20 * (T.NO_DE_PISOS - 1) + T.CIRCULACIONES_21
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E295_2 1 Y 2 PAR
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_VIVIENDA_VIP_20 = 
			CASE
				WHEN UPPER(T.OFERTAS_RESIDENCIAL) IN ('VIP') THEN T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20 * (T.NO_DE_PISOS - 1)
				WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) <> 'VIVIENDA' THEN 0
				WHEN UPPER(T.OFERTAS_RESIDENCIAL) IN ('VIS','3') THEN T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2 / NULLIF((1 - T.PUNTOS_FIJOS_PORCENTAJE_AREA_TOTAL_CONSTRUIDA),0)
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


			--E295_1 1 Y 2 PAR
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_VIVIENDA_VIP_10 = T.AREA_CONSTRUIDA_VIVIENDA_VIP_20 / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0)
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E291 --E292 --E293 --E294 --E295 --E296
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_TOTAL_CONSTRUIDA_USOS_VENDIBLES_2	= T.AREA_CONSTRUIDA_EFECTIVA_2 + T.PUNTOS_FIJOS_2,
			T.AREA_CONSTRUIDA_COMERCIO_2				= T.AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_2,
			T.AREA_CONSTRUIDA_VIVIENDA_U_OFICINAS_2		= T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20 * (T.NO_DE_PISOS - 1) + PF_2,
			T.AREA_CONSTRUIDA_APTO_U_OFICINAS_20        = T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20 * (T.NO_DE_PISOS - 1) - T.AREA_CONSTRUIDA_VIVIENDA_VIP_20,
			T.AREA_CONSTRUIDA_ECP_2						= 
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN T.SERVICIOS_COMUNALES_EN_AREAS_CONSTRUIDAS_21 + SERVICIOS_COMUNALES_EN_AREAS_CONSTRUIDAS_20 *  (T.NO_DE_PISOS - 1)
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN T.SERVICIOS_COMUNALES_EN_AREAS_CONSTRUIDAS_21 + SERVICIOS_COMUNALES_EN_AREAS_CONSTRUIDAS_20 *  (T.NO_DE_PISOS - 1) + 0
				ELSE 0
			END	
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E297_1 E298_1 E299_1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_DESTINADA_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_1 = 1.70,
			T.COMERCIO_1 = 1.70,
			T.APTO_U_OFICINAS_1 = 1.70
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.COMERCIO_2 =
			CASE 
				WHEN T.AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_2 = 0 THEN 0
				WHEN T.NO_DE_ESTACIONAMIENTOS_BICICLETAS_LOCALES_2 * T.COMERCIO_1 < 1.7 THEN 1.7
				ELSE T.NO_DE_ESTACIONAMIENTOS_BICICLETAS_LOCALES_2 * T.COMERCIO_1
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E297_2 E298_2 E299_2 E300_2 E301_1 E301_2 E302_1 E302_2 E303_2 E304_2 E305_2 1 Y 2 PAR
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.APTO_U_OFICINAS_2 = T.NO_DE_ESTACIONAMIENTOS_BICICLETAS_PISO_TIPO_2 * (T.NO_DE_PISOS - 1) * T.APTO_U_OFICINAS_1,
			T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_2 = T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_2 * (T.NO_DE_PISOS - 1) + T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_2,
			T.AREA_VENTA_COMERCIO_1 = T.NO_MINIMO_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_1,
			T.AREA_VENTA_COMERCIO_2 = T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_2,
			T.AREA_VENTA_VIVIENDA_U_OFICINAS_1 = T.NO_MINIMO_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_1,
			T.AREA_VENTA_VIVIENDA_U_OFICINAS_2 = 
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_2 * (T.NO_DE_PISOS - 1)
			    WHEN T.FORMATO_TRABAJO IN ('F6') THEN T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_2 * (T.NO_DE_PISOS - 1) + 0
			END,
			T.AREA_TOTAL_VENTA_2 = AREA_DE_VENTAS_PISO_TIPO_2 * (T.NO_DE_PISOS - 1) + CIRCULACIONES_21,
			T.AREA_TOTAL_VENTA_COMERCIO_2 = T.AREA_VENDIBLE_DE_COMERCIO_1_PISO_2,
			T.AREA_VENTA_VIVIENDA_U_OFICINAS_20 = 
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN T.AREA_DE_VENTAS_PISO_TIPO_2 * (T.NO_DE_PISOS - 1)
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN T.AREA_DE_VENTAS_PISO_TIPO_2 * (T.NO_DE_PISOS - 1) + 0
				ELSE 0
			END		
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 
			
			--E307_2 1 Y 2 PAR
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_VENTA_APTO_U_OFICINAS_VIP_2 = (T.AREA_CONSTRUIDA_VIVIENDA_VIP_20 * (1 - PUNTOS_FIJOS_PORCENTAJE_AREA_TOTAL_CONSTRUIDA - CIRCULACIONES_M2_PORCENTAJE_DEL_AREA_TOTAL)) 
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E310 1 Y 2 PAR
			MERGE INTO TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			USING (
				SELECT 
					T1.CHIP,
					T1.ID_ORIGINAL,
					T1.FORMATO_TRABAJO,
					NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',T1.VIGENCIA,UPPER(T1.NOMBRE_LOCALIDAD),UPPER(T1.CODIGO_BARRIO),UPPER(T1.OFERTAS_RESIDENCIAL),UPPER(T1.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) AS VAL_M2
				FROM TBL_TEMP_RESULTADO_PREDIOS T1
			) SRC
			ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
			WHEN MATCHED THEN
			UPDATE SET
				T.NO_APTOS_VIP_2 = 
				(CEIL(T.AREA_VENTA_APTO_U_OFICINAS_VIP_2 / SRC.VAL_M2));


			--E309 1 Y 2 PAR
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.NO_APTOS_U_OFICINAS_2 =  
			CASE
				WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIP' THEN 0 
				ELSE (T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2 * (T.NO_DE_PISOS - 1)) - NO_APTOS_VIP_2
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 
			
			--E306_2 E308_2 1 Y 2 PAR
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_VENTA_APTO_U_OFICINAS_2 = T.AREA_VENTA_VIVIENDA_U_OFICINAS_20 - T.AREA_VENTA_APTO_U_OFICINAS_VIP_2,
			T.AREA_VENTA_VIVIENDA_VIP_2 = T.NO_APTOS_U_OFICINAS_2 + T.NO_APTOS_VIP_2	
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E311
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_VENTA_APTO_U_OFICINAS_3 = 
			CASE 
				WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIP' THEN T.AREA_VENTA_APTO_U_OFICINAS_VIP_2 / NULLIF(T.NO_APTOS_VIP_2, 0)
				ELSE NVL(T.AREA_VENTA_APTO_U_OFICINAS_2 / NULLIF(T.NO_APTOS_U_OFICINAS_2,0),0)
			END,			
			T.NO_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_EMISIONES_CERO_2 =  TRUNC(T.NO_DE_ESTACIONAMIENTOS_BICICLETAS_LOCALES_2 + T.NO_DE_ESTACIONAMIENTOS_BICICLETAS_PISO_TIPO_2 * (T.NO_DE_PISOS - 1)),
			T.NO_ESTACIONAMIENTOS_VEHICULOS_1 = 23.10
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E313
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_DESTINADA_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_2 = T.NO_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_EMISIONES_CERO_2 * T.AREA_CONSTRUIDA_DESTINADA_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_1 ,
			T.COMERCIO_20 =  NVL(TRUNC(T.AREA_VENTA_COMERCIO_2 / NULLIF(T.NO_ESTACIONAMIENTOS_VEHICULOS_1,0)),0)
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E314
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.VIVIENDA_U_OFICINAS_2 = TRUNC(T.NO_MINIMO_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_2 * (T.NO_DE_PISOS - 1))
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E311
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.NO_ESTACIONAMIENTOS_VEHICULOS_2 = TRUNC(T.COMERCIO_20 + T.VIVIENDA_U_OFICINAS_2),
			T.AREA_CONSTRUIDA_1_PISO_2 = T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_21,
			T.AREA_CONSTRUIDA_COMERCIO_20 = 
			CASE 
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN T.AREA_CONSTRUIDA_COMERCIO_2
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN 0
				ELSE 0
			END,
			T.AREA_CONSTRUIDA_ECP_20 = 
			CASE 
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN T.AREA_CONSTRUIDA_ECP_2
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN T.AREA_CONSTRUIDA_COMERCIO_2
				ELSE 0
			END,
			T.AREA_PUNTO_FIJO_PRIMER_PISO_2 = 
			CASE 
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN T.PF_2
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN T.AREA_CONSTRUIDA_ECP_2 + 0
				ELSE 0
			END			
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E311
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_SOBRANTE_ESTACIONAMIENTOS_2 = 
			CASE 
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN T.AREA_CONSTRUIDA_1_PISO_2 - T.AREA_CONSTRUIDA_COMERCIO_20 - T.AREA_CONSTRUIDA_ECP_20 - T.AREA_PUNTO_FIJO_PRIMER_PISO_2
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN T.PF_2
				ELSE 0
			END,
			T.NO_ESTACIONAMIENTO_PRIMER_PISO_CUBIERTO_1 = 
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN 23.10
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN 0
				ELSE 0
			END,
			T.AREA_SOBRANTE_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_CERO_1 = 
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN 0
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN 23.10
				ELSE 0
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E323
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_20 = 
			CASE 
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN
					CASE 
						WHEN T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_2 < T.AREA_SOBRANTE_ESTACIONAMIENTOS_2 THEN T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_2
						ELSE T.AREA_SOBRANTE_ESTACIONAMIENTOS_2
					END
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN T.AREA_CONSTRUIDA_1_PISO_2 - T.AREA_CONSTRUIDA_COMERCIO_20 - T.AREA_CONSTRUIDA_ECP_20 - T.AREA_PUNTO_FIJO_PRIMER_PISO_2 - T.AREA_SOBRANTE_ESTACIONAMIENTOS_2		
			END	
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E324_2  E325_2
			--E329
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.NO_ESTACIONAMIENTO_PRIMER_PISO_CUBIERTO_2 =  
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN NVL(TRUNC(T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_20 / NULLIF(T.NO_ESTACIONAMIENTO_PRIMER_PISO_CUBIERTO_1,0)),0)
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN 
					CASE 
						WHEN T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_2 < T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_20 THEN T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_2
						ELSE T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_20
					END
				ELSE 0
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_SOBRANTE_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_CERO_2 = 
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN T.AREA_SOBRANTE_ESTACIONAMIENTOS_2 - T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_20
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN NVL(TRUNC(T.NO_ESTACIONAMIENTO_PRIMER_PISO_CUBIERTO_2 / NULLIF(T.AREA_SOBRANTE_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_CERO_1,0)),0)
				ELSE 0
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


			--E333_2 E334_2 E335_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_CERO_2 = 
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN T.AREA_SOBRANTE_ESTACIONAMIENTOS_2 - T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_20
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_20 - NO_ESTACIONAMIENTO_PRIMER_PISO_CUBIERTO_2
				ELSE 0
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E333_2 E334_2 E335_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_SOBRANTE_CUBIERTA_2 = 
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN T.AREA_SOBRANTE_ESTACIONAMIENTOS_2 - T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_20
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN 
					CASE 
						WHEN T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_CERO_2 > T.AREA_CONSTRUIDA_DESTINADA_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_2 THEN T.AREA_CONSTRUIDA_DESTINADA_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_2
						ELSE T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_CERO_2
					END				
				ELSE 0
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E333_2 E334_2 E335_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_FALTANTE_ESTACIONAMIENTOS_VEHICULARES_2 = 
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_20 - T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_2
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_CERO_2 - T.AREA_CONSTRUIDA_SOBRANTE_CUBIERTA_2
				ELSE 0
			END				
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E333_2 E334_2 E335_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
            T.NUMERO_ESTACIONAMIENTOS_FALTANTES_2 = 
			CASE
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN NVL(T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_20 / NULLIF(T.NO_ESTACIONAMIENTO_PRIMER_PISO_CUBIERTO_1, 0), 0)
				WHEN T.FORMATO_TRABAJO IN ('F6') THEN T.NO_ESTACIONAMIENTO_PRIMER_PISO_CUBIERTO_2 - T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_2
				ELSE 0
			END,				
            T.AREA_NETA_DPP_2 = T.AREA_NETA_URBANIZABLE_M2_2,
			T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_DPP_1 = 0.40
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

            MERGE INTO TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
            USING (
                SELECT 
                    T1.CHIP, 
                    T1.ID_ORIGINAL,
					T1.FORMATO_TRABAJO,
                    T1.CARGA_GENERAL_ARTICULO_285_2 AS AREA_CARGA_GENERAL_DPP_2,
                    T1.TOTAL_CARGA_LOCAL_EN_SITIO_2 AS AREA_CARGA_LOCAL_DPP_2,
                    T1.CONTROL_AMBIENTAL_154_2 AS CONTROL_AMBIENTAL_DPP_2
                FROM TBL_TEMP_RESULTADO_PREDIOS T1
            ) SRC
            ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
            WHEN MATCHED THEN
            UPDATE SET
                T.AREA_CARGA_GENERAL_DPP_2 = SRC.AREA_CARGA_GENERAL_DPP_2,
                T.AREA_CARGA_LOCAL_DPP_2 = SRC.AREA_CARGA_LOCAL_DPP_2,
                T.CONTROL_AMBIENTAL_DPP_2 = SRC.CONTROL_AMBIENTAL_DPP_2;
            
			--E339	
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_UTIL_APLICAR_CARGA_VIP_ANU_DPP_2 =  T.AREA_NETA_DPP_2 - T.AREA_CARGA_GENERAL_DPP_2 - T.AREA_CARGA_LOCAL_DPP_2 - CONTROL_AMBIENTAL_DPP_2,
			T.AREA_CONSTRUIDA_1_PISO_DPP_2 = T.AREA_CONSTRUIDA_1_PISO_2,
			T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_DPP_2 = ((T.ZONAS_VERDES_RECREATIVAS_EN_AREAS_LIBRES_20 * (T.NO_DE_PISOS - 1)) + ZONAS_VERDES_RECREATIVAS_EN_AREAS_LIBRES_21) * ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_DPP_1
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E341	
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_SOBRANTE_ESTACIONAMIENTOS_AISLAMIENTOS_DPP_2 =  T.AREA_UTIL_APLICAR_CARGA_VIP_ANU_DPP_2 - T.AREA_AISLAMIENTOS_DPP_2 - T.AREA_CONSTRUIDA_1_PISO_DPP_2 - T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_DPP_2,
			T.AREA_CONSTRUIDA_DESTINADA_BICICLETAS_VEHICULOS_EMISIONES_CERO_DPP_2 = 
			CASE 
				WHEN T.AREA_CONSTRUIDA_DESTINADA_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_2 > T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_CERO_2 THEN 
											T.AREA_CONSTRUIDA_DESTINADA_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_2 - T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_CERO_2
				ELSE 0
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


			--E343	
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_SOBRANTE_AISLAMIENTOS_ESTACIONAMIENTOS_VEHICULARES_DPP_2 =  
			CASE 
				WHEN T.OFERTAS_RESIDENCIAL = 'VIS' OR T.OFERTAS_RESIDENCIAL = '3' THEN T.AREA_SOBRANTE_ESTACIONAMIENTOS_AISLAMIENTOS_DPP_2 - T.AREA_CONSTRUIDA_DESTINADA_BICICLETAS_VEHICULOS_EMISIONES_CERO_DPP_2
				ELSE 0
			END,
			T.ESTACIONAMIENTOS_DESCUBIERTOS_1_PISO_DPP_1 = 18.00
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


			--E344
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET T.AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_DPP_2 =
			CASE 
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5') THEN
					CASE 
						WHEN T.AREA_FALTANTE_ESTACIONAMIENTOS_VEHICULARES_2 < 0 THEN
							CASE 
								WHEN T.AREA_SOBRANTE_AISLAMIENTOS_ESTACIONAMIENTOS_VEHICULARES_DPP_2 > ABS(T.AREA_FALTANTE_ESTACIONAMIENTOS_VEHICULARES_2) THEN ABS(T.AREA_FALTANTE_ESTACIONAMIENTOS_VEHICULARES_2)
								ELSE T.AREA_SOBRANTE_AISLAMIENTOS_ESTACIONAMIENTOS_VEHICULARES_DPP_2
							END
						ELSE 0
					END

				WHEN T.FORMATO_TRABAJO IN ('F6') THEN
					CASE 
						WHEN T.NUMERO_ESTACIONAMIENTOS_FALTANTES_2 < 0 THEN
							CASE 
								WHEN T.AREA_SOBRANTE_AISLAMIENTOS_ESTACIONAMIENTOS_VEHICULARES_DPP_2 > ABS(T.NUMERO_ESTACIONAMIENTOS_FALTANTES_2) THEN ABS(T.NUMERO_ESTACIONAMIENTOS_FALTANTES_2)
								ELSE T.AREA_SOBRANTE_AISLAMIENTOS_ESTACIONAMIENTOS_VEHICULARES_DPP_2
							END
						ELSE 0
					END
			END		
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E346 E350
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.ESTACIONAMIENTOS_DESCUBIERTOS_1_PISO_DPP_2 = 	TRUNC(AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_DPP_2 / NULLIF(ESTACIONAMIENTOS_DESCUBIERTOS_1_PISO_DPP_1,0)),
			T.AREA_SOBRANTE_DPP_1 = T.ESTACIONAMIENTOS_DESCUBIERTOS_1_PISO_DPP_1 / 2,
			T.AREA_SOBRANTE_DPP_2 = T.AREA_SOBRANTE_AISLAMIENTOS_ESTACIONAMIENTOS_VEHICULARES_DPP_2 - AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_DPP_2,
			T.CONTROL_ESTACIONAMIENTOS_CE_2 = T.NO_ESTACIONAMIENTOS_VEHICULOS_2,
			T.PRIMER_PISO_CUBIERTO_CE_2 = T.NO_ESTACIONAMIENTO_PRIMER_PISO_CUBIERTO_2,
			T.SOTANO_TIPOLOGIA_CE_2 = 32.00,
			T.SOTANO_FUERA_TIPOLOGIA_CE_2 = 40.00
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


			--E346 E350
            UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
                T.PRIMER_PISO_DESCUBIERTO_CE_2 = T.ESTACIONAMIENTOS_DESCUBIERTOS_1_PISO_DPP_2,
                T.AREA_SOTANOS_1 = 
                    (CASE 
                        WHEN T.OFERTAS_RESIDENCIAL = '5' THEN 90 * 2
                        ELSE 0
                    END) - T.VIVIENDA_U_OFICINAS_2,
                T.AREA_SOTANOS_3 = 
                    CASE 
                        WHEN T.OFERTAS_RESIDENCIAL = 'VIS' OR T.OFERTAS_RESIDENCIAL = '3' THEN T.AREA_FALTANTE_ESTACIONAMIENTOS_VEHICULARES_2 + T.AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_DPP_2
                        ELSE T.AREA_FALTANTE_ESTACIONAMIENTOS_VEHICULARES_2
                    END,
                T.AREA_SOTANOS_4 = T.AREA_CONSTRUIDA_1_PISO_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 
			
			
			--E353 E354 E56
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.ESTACIONAMIENTOS_FALTANTES_CE_2 = T.NO_ESTACIONAMIENTOS_VEHICULOS_2 - T.PRIMER_PISO_CUBIERTO_CE_2 - T.PRIMER_PISO_DESCUBIERTO_CE_2 - T.SOTANO_TIPOLOGIA_CE_2-SOTANO_FUERA_TIPOLOGIA_CE_2,
			T.AREA_SOTANOS_5 = 
			CASE 
                   WHEN (T.AREA_SOTANOS_3 * -1) < 100 THEN 0
                   WHEN (T.AREA_SOTANOS_3 + T.AREA_SOTANOS_4) > 0 THEN 0
                   ELSE (T.AREA_SOTANOS_3 + T.AREA_SOTANOS_4)
            END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E46_2 1 Y 2 PAR
			UPDATE TBL_TEMP_RESULTADO_PREDIOS T
			SET T.AREA_UTIL_PARA_APLICAR_CARGA_VIP_2 = T.AREA_NETA_URBANIZABLE_CALCULO_2 - T.CARGA_GENERAL_ARTICULO_285_2 - T.TOTAL_CARGA_LOCAL_EN_SITIO_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

			MERGE INTO TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
            USING (
                SELECT 
                    T1.CHIP,
                    T1.ID_ORIGINAL,
					T1.FORMATO_TRABAJO,
                    T1.AREA_UTIL_PARA_APLICAR_CARGA_VIP_2
                FROM TBL_TEMP_RESULTADO_PREDIOS T1
            ) SRC
            ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
            WHEN MATCHED THEN
            UPDATE SET
            T.AREA_SOTANOS_6 = 
			CASE 
				WHEN AREA_SOTANOS_5 >= 0 THEN 0
				WHEN (NVL(SRC.AREA_UTIL_PARA_APLICAR_CARGA_VIP_2, 0) - AREA_CONSTRUIDA_1_PISO_DPP_2) < (AREA_SOTANOS_5 * -1) THEN (NVL(SRC.AREA_UTIL_PARA_APLICAR_CARGA_VIP_2, 0) - AREA_CONSTRUIDA_1_PISO_DPP_2)
				ELSE (AREA_SOTANOS_5 * -1)
			END;

			--AREA_SOTANOS_7
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.AREA_SOTANOS_7 = 
			CASE 
				WHEN (T.AREA_SOTANOS_5 + T.AREA_SOTANOS_6) >= 0 THEN 0
				ELSE (T.AREA_SOTANOS_5 + T.AREA_SOTANOS_6)
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--AREA_SOTANOS_8
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.AREA_SOTANOS_8 = 
			CASE 
				WHEN (T.AREA_SOTANOS_7 * -1) <= 0 THEN 0
				WHEN (T.AREA_SOTANOS_5 * -1) > (T.AREA_SOTANOS_4 + T.AREA_SOTANOS_6) THEN T.AREA_SOTANOS_4
				ELSE 0
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--AREA_SOTANOS_9
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.AREA_SOTANOS_9 =
			CASE 
                   WHEN (T.AREA_SOTANOS_3 + T.AREA_SOTANOS_4 + T.AREA_SOTANOS_8 + T.AREA_SOTANOS_6) > 0 THEN 0
                   ELSE (T.AREA_SOTANOS_3 + T.AREA_SOTANOS_4 + T.AREA_SOTANOS_8 + T.AREA_SOTANOS_6)
            END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--AREA_SOTANOS_10
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.AREA_SOTANOS_10 = 
			CASE 
                   WHEN T.AREA_SOTANOS_9 > 0 THEN 0
                   WHEN (T.AREA_SOTANOS_9 * -1) < T.AREA_SOTANOS_6 THEN (T.AREA_SOTANOS_9 * -1)
                   ELSE T.AREA_SOTANOS_6
            END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


			--AREA_SOTANOS_11
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.AREA_SOTANOS_11 = 
			CASE 
                   WHEN CASE 
                           WHEN (T.AREA_SOTANOS_3 * -1) < 100 THEN 0 
                           ELSE (T.AREA_SOTANOS_3 + T.AREA_SOTANOS_4 + T.AREA_SOTANOS_8 + T.AREA_SOTANOS_10) 
                        END > 0 THEN 0
                   WHEN (T.AREA_SOTANOS_3 * -1) < 100 THEN 0
                   ELSE (T.AREA_SOTANOS_3 + T.AREA_SOTANOS_4 + T.AREA_SOTANOS_8 + T.AREA_SOTANOS_10)
            END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--AREA_SOTANOS_12
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.AREA_SOTANOS_12 = 
			CASE 
                   WHEN AREA_SOTANOS_11 = 0 THEN 0
                   WHEN (AREA_SOTANOS_11 * -1) > AREA_SOTANOS_6 THEN AREA_SOTANOS_6
                   ELSE (AREA_SOTANOS_11 * -1)
            END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--AREA_SOTANOS_13
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.AREA_SOTANOS_13 = 
			CASE 
                   WHEN (T.AREA_SOTANOS_3 + T.AREA_SOTANOS_4 + T.AREA_SOTANOS_8 + T.AREA_SOTANOS_10 + T.AREA_SOTANOS_12) >= 0 THEN 0
                   ELSE -10
                END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--NO_SOTANOS_4
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.NO_SOTANOS_4 =
			CASE 
                   WHEN T.AREA_SOTANOS_3 > -100 THEN 0
                   WHEN T.AREA_SOTANOS_8 > 0 	THEN 2
                   WHEN T.AREA_SOTANOS_4 >= (0.3 * T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20) AND T.AREA_SOTANOS_8 = 0 THEN 1
                   ELSE 0
            END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E357
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.NO_SOTANOS_1 = 
			CASE 
				WHEN T.AREA_SOTANOS_3 > -100 THEN 0
				ELSE T.NO_SOTANOS_4
			END	
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E358_1
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.AREA_CONSTRUIDA_SOTANO_TIPOLOGIA_1 = T.NO_SOTANOS_1
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E358_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.AREA_CONSTRUIDA_SOTANO_TIPOLOGIA_2 =   T.AREA_CONSTRUIDA_1_PISO_2 * T.AREA_CONSTRUIDA_SOTANO_TIPOLOGIA_1
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E358_3
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.AREA_CONSTRUIDA_SOTANO_TIPOLOGIA_3 =   T.AREA_CONSTRUIDA_SOTANO_TIPOLOGIA_1 * AREA_CONSTRUIDA_SOTANO_TIPOLOGIA_2,
			T.NO_ESTACIONAMIENTOS_SOTANO_TIPOLOGIA_1 = T.NO_ESTACIONAMIENTO_PRIMER_PISO_CUBIERTO_1
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 
			
			--E359
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.NO_ESTACIONAMIENTOS_SOTANO_TIPOLOGIA_2 =   NVL(TRUNC(AREA_CONSTRUIDA_SOTANO_TIPOLOGIA_2 / NULLIF(NO_ESTACIONAMIENTOS_SOTANO_TIPOLOGIA_1,0)),0)
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 
            
			--E360_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET
			T.AREA_CONSTRUIDA_ESTACIONAMIENTO_SOTANO_TIPOLOGIA_2 = T.NO_ESTACIONAMIENTOS_SOTANO_TIPOLOGIA_1 * T.NO_ESTACIONAMIENTOS_SOTANO_TIPOLOGIA_2,
			T.AREA_CONSTRUIDA_SOTANO_TIPOLOGIA_4 = 
			CASE 
				WHEN T.AREA_SOTANOS_10 <> 0 THEN 2
				WHEN T.AREA_SOTANOS_6  <> 0 THEN 1
				ELSE 0
			END,
			T.NO_ESTACIONAMIENTOS_SOTANO_TIPOLOGIA_3 = 
			CASE 
				WHEN T.AREA_SOTANOS_3 = 0 THEN 0
				ELSE T.AREA_SOTANOS_4 
			END,
			T.AREA_CONSTRUIDA_ESTACIONAMIENTO_SOTANO_TIPOLOGIA_3 = 
			CASE 
                   WHEN T.AREA_SOTANOS_5 >= 0 THEN 0
                   WHEN T.AREA_SOTANOS_9 >= 0 THEN 0
                   WHEN T.AREA_SOTANOS_6 > (T.AREA_SOTANOS_9 * -1) THEN (T.AREA_SOTANOS_9 * -1)
                   ELSE T.AREA_SOTANOS_6
            END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E358_2 E359
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_ESTACIONAMIENTO_SOTANO_TIPOLOGIA_4 = T.AREA_CONSTRUIDA_ESTACIONAMIENTO_SOTANO_TIPOLOGIA_3 + T.NO_ESTACIONAMIENTOS_SOTANO_TIPOLOGIA_3,
			T.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_1 = AREA_CONSTRUIDA_SOTANO_TIPOLOGIA_4
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 
            
			--E361
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_4 = T.AREA_SOTANOS_12, 
			T.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_1 = AREA_CONSTRUIDA_SOTANO_TIPOLOGIA_4
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E361_2
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_2 = T.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_4 + T.AREA_CONSTRUIDA_ESTACIONAMIENTO_SOTANO_TIPOLOGIA_3
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 
			
			--E362_3
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_3 = T.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_1 * T.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_1,
			T.NO_ESTACIONAMIENTOS_SOTANO_FUERA_TIPOLOGIA_1 = 23.10
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E362_3
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.NO_ESTACIONAMIENTOS_SOTANO_FUERA_TIPOLOGIA_2 = NVL(TRUNC(CEIL(AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_2 / NULLIF(NO_ESTACIONAMIENTOS_SOTANO_FUERA_TIPOLOGIA_1,0))),0)
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E351 E352
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.SOTANO_TIPOLOGIA_CE_2 = T.NO_ESTACIONAMIENTOS_SOTANO_TIPOLOGIA_2,
			T.SOTANO_FUERA_TIPOLOGIA_CE_2 = T.NO_ESTACIONAMIENTOS_SOTANO_FUERA_TIPOLOGIA_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.ESTACIONAMIENTOS_FALTANTES_CE_20 = T.PRIMER_PISO_CUBIERTO_CE_2 + T.SOTANO_TIPOLOGIA_CE_2 + T.SOTANO_FUERA_TIPOLOGIA_CE_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--E350_3 E350_4 
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.NO_ESTACIONAMIENTOS_SOTANO_FUERA_TIPOLOGIA_3 = T.AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_DPP_2,
			T.CONTROL_AREAS_ESTACIONAMIENTOS_3 = (T.NO_ESTACIONAMIENTOS_SOTANO_TIPOLOGIA_3 * T.NO_SOTANOS_4) + T.AREA_CONSTRUIDA_ESTACIONAMIENTO_SOTANO_TIPOLOGIA_3 + T.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_4,
			T.CONTROL_ESTACIONAMIENTOS_CE_3 = T.COMERCIO_20,
			T.CONTROL_ESTACIONAMIENTOS_CE_4 = T.VIVIENDA_U_OFICINAS_2
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--J350
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.PRIMER_PISO_DESCUBIERTO_CE_3 = 
			CASE 
				WHEN T.PRIMER_PISO_DESCUBIERTO_CE_2 > T.CONTROL_ESTACIONAMIENTOS_CE_3 THEN T.CONTROL_ESTACIONAMIENTOS_CE_3
				ELSE T.PRIMER_PISO_DESCUBIERTO_CE_2	
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--K350
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.PRIMER_PISO_DESCUBIERTO_CE_4 = 
			CASE 
				WHEN PRIMER_PISO_DESCUBIERTO_CE_2 > CONTROL_ESTACIONAMIENTOS_CE_4 THEN CONTROL_ESTACIONAMIENTOS_CE_4
				ELSE PRIMER_PISO_DESCUBIERTO_CE_2 - PRIMER_PISO_DESCUBIERTO_CE_3
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--(J349)
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.PRIMER_PISO_CUBIERTO_CE_3 = 
			CASE 
				WHEN (CONTROL_ESTACIONAMIENTOS_CE_3 - PRIMER_PISO_DESCUBIERTO_CE_3) >= 0 THEN 
					CASE 
						WHEN (CONTROL_ESTACIONAMIENTOS_CE_3 - PRIMER_PISO_DESCUBIERTO_CE_3) > T.PRIMER_PISO_CUBIERTO_CE_2 THEN T.PRIMER_PISO_CUBIERTO_CE_2
						ELSE (CONTROL_ESTACIONAMIENTOS_CE_3 - PRIMER_PISO_DESCUBIERTO_CE_3)
					END
				ELSE 0
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			--(K349)
			UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
			SET 
			T.PRIMER_PISO_CUBIERTO_CE_4 =	
			CASE 
				WHEN (T.CONTROL_ESTACIONAMIENTOS_CE_4 - T.PRIMER_PISO_DESCUBIERTO_CE_4) >= 0 THEN 
					CASE 
						WHEN (T.CONTROL_ESTACIONAMIENTOS_CE_4 - T.PRIMER_PISO_DESCUBIERTO_CE_4) > (T.PRIMER_PISO_CUBIERTO_CE_2 - T.PRIMER_PISO_CUBIERTO_CE_3) THEN (T.PRIMER_PISO_CUBIERTO_CE_2 - T.PRIMER_PISO_CUBIERTO_CE_3)
						ELSE (T.CONTROL_ESTACIONAMIENTOS_CE_4 - T.PRIMER_PISO_DESCUBIERTO_CE_4)
					END
				ELSE 0
			END
			WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

			DBMS_OUTPUT.PUT_LINE('FINALIZA SP_ACTUALIZAR_PREDIOS_GEOMETRIA_3');

			COMMIT;
		END;


	PROCEDURE SP_ACTUALIZAR_PREDIOS_2 IS --NIVEL_0
	V_VIP_T52        NUMBER := 20; --T52
	
	
	
	BEGIN

		DBMS_OUTPUT.PUT_LINE('INICIO SP_ACTUALIZAR_PREDIOS_2');
		
		--EXECUTE IMMEDIATE 'TRUNCATE TABLE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS';
		
	------DATOS PRUEBA--------------
		-- Actualizar fórmulas en la tabla temporal
		
		--E8 E9 E10
		--UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		--SET 
		--T.SPD_1 	 = 3661215.14,
		--T.SPD_2 	 = 3022948.80,
		--T.VTOPE_2024 = 409000.00,
		--T.RESERVAS_SISTEMAS_GENERALES = T.AREA_TOTAL_RESERVAS_URBANAS + T.AREA_TOTAL_AFECTACIONES
		--WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  
		
		--E8 E9 E10
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET
			(T.SPD_1, T.SPD_2, T.VTOPE_2024) = 
			(
				SELECT V.SPD_1,	V.SPD_2,V.VTOPE_2024 
				FROM TBL_VALORES_INMUEBLES_TBL1 V WHERE V.VIGENCIA = T.VIGENCIA
			),
			T.RESERVAS_SISTEMAS_GENERALES = T.AREA_TOTAL_RESERVAS_URBANAS + T.AREA_TOTAL_AFECTACIONES
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  
		COMMIT;
		
		
		--TABLA CONSOLIDACION F4 (1)
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		TBL_CONSOLIDACION_MAXIMA_1 =
		CASE 
			WHEN T.ES_MANZANA = 1 AND UPPER(T.NOMBRE_AREA_ACTIVIDAD) = 'PROXIMIDAD' THEN 
			  CASE 
				WHEN T.ALTURA_PISOS_2 * 2 >= 12 THEN 12
				ELSE T.ALTURA_PISOS_2 * 2
			  END
			ELSE T.ALTURA_PISOS_2
		END,
		TBL_CONSOLIDACION_MAXIMA_2 =
		CASE 
			WHEN T.ES_MANZANA = 1 AND UPPER(T.NOMBRE_AREA_ACTIVIDAD) = 'PROXIMIDAD' THEN 
			CASE 
				WHEN T.ALTURA_PISOS * 2 >= 12 THEN 12
				ELSE T.ALTURA_PISOS * 2
			END
			ELSE T.ALTURA_PISOS
		END		
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F4'));  

		--TABLA CONSOLIDACION F4 (2)
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		TBL_CONSOLIDACION_ALTURA_P_1 =
		CASE 
			WHEN T.TIPOLOGIA_URBANISTICA = 'C' THEN 
			  CASE 
				WHEN T.ALTURA_PISOS_2 = 0 THEN T.ALTURA_PISOS
				WHEN T.CONTROL_AMBIENTAL >= 14 AND T.ALTURA_PISOS_2 <> 0 THEN T.ALTURA_PISOS_2
				ELSE T.ALTURA_PISOS
			  END
			ELSE 0
		END,
		TBL_CONSOLIDACION_ALTURA_P_2 =
		CASE 
			WHEN T.ALTURA_PISOS_2 = 0 THEN T.ALTURA_PISOS
			WHEN UPPER(T.TIPOLOGIA_URBANISTICA) = 'A' 
				AND T.FRENTE_ANCHO >= 24 
				AND (AREA_TERRENO_CALCULADA - T.AREA_TOTAL_RESERVAS_URBANAS) > 1200 
				AND T.ANCHO_VIA > 22 
				AND T.TBL_CONSOLIDACION_MAXIMA_1 >= 8 
			THEN T.TBL_CONSOLIDACION_MAXIMA_1
			ELSE T.TBL_CONSOLIDACION_MAXIMA_2
		END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F4'));  


		--TABLA CONSOLIDACION F4 (2)
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		TBL_CONSOLIDACION_ALTURA_PR_1 =
		CASE 
			WHEN T.TBL_CONSOLIDACION_ALTURA_P_2 = 0 THEN TBL_CONSOLIDACION_ALTURA_P_1
			ELSE T.TBL_CONSOLIDACION_ALTURA_P_2
		END,
		TBL_CONSOLIDACION_ALTURA_PR_2 =
		CASE 
			WHEN T.TBL_CONSOLIDACION_ALTURA_P_2 = 0 THEN TBL_CONSOLIDACION_ALTURA_P_1
			ELSE T.TBL_CONSOLIDACION_ALTURA_P_2
		END		
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F4'));  

		--TABLA CONSOLIDACION F4 (3)
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		TBL_CONSOLIDACION_ALTURA_PR_3 =
		CASE 
			WHEN UPPER(T.TIPOLOGIA_URBANISTICA) = 'C' THEN T.TBL_CONSOLIDACION_ALTURA_PR_1
			ELSE T.ALTURA_PISOS
		END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F4'));  

		--TABLA CONSOLIDACION F4 (4)
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		TBL_CONSOLIDACION_ALTURA_PR_4 =
		CASE 
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' AND UPPER(T.ZONA_AREA_ACTIVIDAD) = 'RECEPTORA DE VIVIENDA DE INTERES SOCIAL Y PRIORITARIO' THEN 
			  CASE 
				WHEN T.ALTURA_PISOS_2 * 2 >= 12 THEN 12
				ELSE T.ALTURA_PISOS_2 * 2
			  END
			ELSE T.TBL_CONSOLIDACION_ALTURA_PR_3
		END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F4'));  

		
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
			T.AREA_NETA_URBANIZABLE_M2_2 = T.AREA_TERRENO_CALCULADA - T.RESERVAS_SISTEMAS_GENERALES,
			T.CONTROL_AMBIENTAL_154_1 = 
				CASE 
					WHEN UPPER(T.CONTROL_AMBIENTAL) = 'NO' THEN 0
					WHEN T.TRATAMIENTO_URBANISTICO = 'DESARROLLO' THEN 10
					WHEN T.TRATAMIENTO_URBANISTICO IN ('RENOVACION', 'MEJORAMIENTO INTEGRAL') THEN 5
					ELSE 0
				END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

		--E45_2 
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
			T.AREA_NETA_URBANIZABLE_M2_1 = TRUNC(ROUND(NVL(T.AREA_NETA_URBANIZABLE_M2_2 / NULLIF(T.AREA_TERRENO_CALCULADA,0),0)  * 100,2)),
			T.CONTROL_AMBIENTAL_154_2 = 
				CASE 
					WHEN UPPER(T.CONTROL_AMBIENTAL) = 'SI' THEN T.FRENTE_ANCHO * T.CONTROL_AMBIENTAL_154_1
					ELSE 0
				END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

		--E26_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
			T.PORCENTAJE_DESTINACION = 
				CASE 
					WHEN CONTROL_AMBIENTAL_154_2 = 0 THEN 30 
					ELSE 50 
				END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

		--E36_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
			T.AREA_NETA_URBANIZABLE_CALCULO_2 = AREA_NETA_URBANIZABLE_M2_2 - CONTROL_AMBIENTAL_154_2
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  


	----=======================================================================================================================CALCULOS TEMPORAL FORMULA EN SP GEOMETRIA
		--E37_2 Y E39_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.SISTEMA_DE_CARGA_OBLIGACIONES_2 = T.CARGA_GENERAL_ARTICULO_285_2 + T.CARGA_LOCAL_EN_SUELO_2 + 
												T.CARGA_LOCAL_COMPENSAR_EN_DINERO_2 + T.EQUIPAMIENTO_COMUNAL_PUBLICO_2,
			T.CARGA_LOCAL_ASOCIADA_PARQUES_2 =  T.CARGA_LOCAL_EN_SUELO_2 + T.CARGA_LOCAL_COMPENSAR_EN_DINERO_2
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

	   --E41-1
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.CARGA_LOCAL_COMPENSAR_EN_CONTROL_1 =
		CASE
		WHEN T.FORMATO_TRABAJO IN ('F6') THEN
			CASE
			WHEN T.PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO <> 0 THEN
				CASE
				WHEN T.CARGA_LOCAL_COMPENSAR_EN_CONTROL_2 > T.CARGA_LOCAL_ASOCIADA_PARQUES_2 * 0.25 THEN -10 --'Revisar'
					ELSE 0
				END
			END	
		ELSE
			T.CARGA_LOCAL_COMPENSAR_EN_CONTROL_2 / NULLIF(T.CARGA_LOCAL_ASOCIADA_PARQUES_2,0)
		END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  
	   
	   
		--E46_2 1 Y 2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.AREA_UTIL_PARA_APLICAR_CARGA_VIP_2 = T.AREA_NETA_URBANIZABLE_CALCULO_2 - T.CARGA_GENERAL_ARTICULO_285_2 - T.TOTAL_CARGA_LOCAL_EN_SITIO_2
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

		--E46_1
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.AREA_UTIL_PARA_APLICAR_CARGA_VIP_1 = (ROUND(T.AREA_UTIL_PARA_APLICAR_CARGA_VIP_2 / T.AREA_TERRENO_CALCULADA, 2) * 100)
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  
		
		--E47_1 (PARAMETRO)
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.AREA_UTIL_PARA_CARGA_VIP_293_1 = 
		CASE
			WHEN T.PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO <> 0 AND T.FORMATO_TRABAJO IN('F4','F5','F6') THEN 0
			WHEN T.OFERTAS_RESIDENCIAL = 'VIP' THEN 0
			ELSE V_VIP_T52
		END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

		--E47_1    
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.AREA_UTIL_PARA_CARGA_VIP_293_2 = (T.AREA_UTIL_PARA_APLICAR_CARGA_VIP_2 / 100) * T.AREA_UTIL_PARA_CARGA_VIP_293_1
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

		--E48_2    
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.AREA_UTIL_PARA_AISLAMIENTOS_2 = T.AREA_UTIL_PARA_APLICAR_CARGA_VIP_2 - T.AREA_UTIL_PARA_CARGA_VIP_293_2
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  


		--E48_1    
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.AREA_UTIL_PARA_AISLAMIENTOS_1 = (ROUND(T.AREA_UTIL_PARA_AISLAMIENTOS_2 / T.AREA_TERRENO_CALCULADA,2) * 100)
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  
	
	----ANÁLISIS DE OCUPACIÓN DEL SUELO    
		--D50_1    
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_1 = 
		CASE 
		WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3') THEN
			CASE 
				WHEN T.ACTUACION_ESTRATEGICA  = 0 THEN  
						CASE 
							WHEN RANGO_1_TRABAJAR = '4A'    THEN 3 * 0.1
							WHEN RANGO_1_TRABAJAR = '4B'    THEN 8 * 0.15
							WHEN RANGO_1_TRABAJAR = '1'     THEN 2.82
							WHEN RANGO_1_TRABAJAR = '2'     THEN 2.57
							WHEN RANGO_1_TRABAJAR = '3'     THEN 2.32
							WHEN RANGO_1_TRABAJAR = '4C'    THEN
								CASE 
									WHEN OFERTAS_RESIDENCIAL = 'VIS' THEN 1.75
									ELSE 1.2
								END
							WHEN RANGO_1_TRABAJAR = '4D' THEN
								CASE 
									WHEN OFERTAS_RESIDENCIAL = 'VIS' THEN 1.75
									ELSE 1.2
								END
							ELSE -10 --'Revisar'
						END
					ELSE 1.3
				END
		WHEN T.FORMATO_TRABAJO IN ('F4') THEN	
			  CASE 
				WHEN UPPER(T.TRATAMIENTO_URBANISTICO) = 'CONSOLIDACION' THEN 
					CASE 	
						WHEN T.ACTUACION_ESTRATEGICA = 0 THEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1 
						ELSE 1.3  
					END
				WHEN UPPER(T.TRATAMIENTO_URBANISTICO) IN ('RENOVACION', 'MEJORAMIENTO INTEGRAL') THEN 
					CASE 
						WHEN T.ACTUACION_ESTRATEGICA = 0 THEN -10 
						ELSE 1.3 
					END
				ELSE -10
			  END
		WHEN T.FORMATO_TRABAJO IN ('F5') THEN	
			CASE 
				WHEN T.ACTUACION_ESTRATEGICA = 1 THEN 1.3
				WHEN T.ES_MANZANA = 1 THEN 7
				WHEN T.ENGLOBE_MINIMO_400 = 1 THEN 6
				ELSE 5
			END
		WHEN T.FORMATO_TRABAJO IN ('F6') THEN				  
			  CASE 
				WHEN UPPER(T.TRATAMIENTO_URBANISTICO) = 'MEJORAMIENTO INTEGRAL' THEN 
				  CASE 
					WHEN T.ACTUACION_ESTRATEGICA = 0 THEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1
					ELSE 1.3 
				  END
				WHEN UPPER(T.TRATAMIENTO_URBANISTICO) = 'RENOVACION' THEN 
				  CASE 
					WHEN T.ACTUACION_ESTRATEGICA = 0 THEN -10 
					ELSE 1.3 
				  END
				WHEN UPPER(T.TRATAMIENTO_URBANISTICO) = 'CONSOLIDACION' THEN 
				  CASE 
					WHEN T.ACTUACION_ESTRATEGICA = 0 THEN -10 
					ELSE 0.2 
				  END
				ELSE -10 
			  END
		END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

		--E50_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2 = INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_1 * AREA_NETA_URBANIZABLE_M2_2
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

	   --E51_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.N_PISOS_SOBRE_INDICE_MAXIMO_2 = 
			CASE 
				WHEN T.RANGO_1_TRABAJAR = '4A' THEN 3
				WHEN T.RANGO_1_TRABAJAR = '4B' THEN 8
				ELSE 0
			END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4B','F3'));  

		--E51_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.N_PISOS_SOBRE_INDICE_MAXIMO_2 = 
		CASE 
			WHEN UPPER(T.ZONA_AREA_ACTIVIDAD) = 'GRANDES SERVICIOS METROPOLITANOS' THEN 5
			WHEN T.TBL_CONSOLIDACION_ALTURA_PR_1 > T.TBL_CONSOLIDACION_ALTURA_PR_4 THEN 
			  CASE 
				WHEN T.TBL_CONSOLIDACION_ALTURA_PR_1 > T.TBL_CONSOLIDACION_ALTURA_PR_2 THEN T.TBL_CONSOLIDACION_ALTURA_PR_1 
				ELSE T.TBL_CONSOLIDACION_ALTURA_PR_4 
			  END
			ELSE T.TBL_CONSOLIDACION_ALTURA_PR_4
		END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F4')); 


		--E51_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.N_PISOS_SOBRE_INDICE_MAXIMO_2 = 
		CASE 
			WHEN T.ANCHO_VIA <  12 THEN 3
			WHEN T.ANCHO_VIA <= 16 THEN 5
			WHEN T.ANCHO_VIA <= 22 THEN 12
			ELSE 12
		END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F6')); 


		--E53_1
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 = 
			CASE 
				WHEN T.RANGO_1_TRABAJAR = '4A' AND T.FORMATO_TRABAJO IN('F1','F2_4B','F3') THEN 0.1
				WHEN T.RANGO_1_TRABAJAR = '4B' AND T.FORMATO_TRABAJO IN('F1','F2_4B','F3') THEN 0.15
				WHEN T.RANGO_1_TRABAJAR = '4C' AND T.FORMATO_TRABAJO IN('F1','F2_4B','F3') THEN 0.15
				WHEN T.RANGO_1_TRABAJAR = '4D' AND T.FORMATO_TRABAJO IN('F1') THEN 0.28
				WHEN T.RANGO_1_TRABAJAR = '4D' AND T.FORMATO_TRABAJO IN('F3','F2_4B') THEN 0.28
				WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' AND T.FORMATO_TRABAJO IN('F4','F6') THEN  (529.41 * T.AN_LOTE_10_APTOS) / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0)
				WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '2'   AND T.FORMATO_TRABAJO IN('F4','F6') THEN  (529.41 * T.AN_LOTE_10_APTOS) / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0)
				WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '3'   AND T.FORMATO_TRABAJO IN('F4','F6') THEN  (564.71 * T.AN_LOTE_10_APTOS) / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0)
				WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '4'   AND T.FORMATO_TRABAJO IN('F4','F6') THEN  (752.94 * T.AN_LOTE_10_APTOS) / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0)
				WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '5'   AND T.FORMATO_TRABAJO IN('F4','F6') THEN (1000.00 * T.AN_LOTE_10_APTOS) / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0)
				WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '6'   AND T.FORMATO_TRABAJO IN('F4','F6') THEN (1375.00 * T.AN_LOTE_10_APTOS) / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0)
				ELSE 0
			END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

		--E53_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_2 = INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 * T.AREA_NETA_URBANIZABLE_M2_2
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));     	
		
		--E55_1
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.PORCENTAJE_DESTINACION_USO_COMERCIAL_CUMPLIMIENTO_1 = T.PORCENTAJE_DESTINACION
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

		--E55_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.PORCENTAJE_DESTINACION_USO_COMERCIAL_CUMPLIMIENTO_2 = 
		(
			SELECT T1.AREA_CONSTRUIDA_EFECTIVA_DE_COMERCIO_1_PISO_2
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
			WHERE T.CHIP = T1.CHIP AND T.ID_ORIGINAL = T1.ID_ORIGINAL
		)
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));     

		--E56_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET T.AREA_INDICE_DESTINADA_USO_RESIDENCIAL_OFICINAS_2 = 
		(
			SELECT T1.AREA_CONSTRUIDA_EFECTIVA_VIVIENDA_U_OFICINAS_2
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
			WHERE T.CHIP = T1.CHIP AND T.ID_ORIGINAL = T1.ID_ORIGINAL
		)
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));         
		
		--E58_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.NO_PISO_SOBRE_INDICE_MAXIMO_2 = 
		(
			SELECT T1.NO_PISOS_CONSTRUIDOS_2
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
			WHERE T.CHIP = T1.CHIP AND T.ID_ORIGINAL = T1.ID_ORIGINAL
		)
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));         

		--E59_1
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1 = T.NO_PISO_SOBRE_INDICE_MAXIMO_2
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));     	

		--E59_2 E60_1 E62_1
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_2 = 
		CASE 
			WHEN UPPER(T.PRODUCTO_INMOBILIARIO_SECUNDARIO) = 'LOCAL' THEN ((T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1 - 1) * 2.3 + 4.2)
			ELSE (PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1 * 2.3)
		END,
		T.AISLAMIENTO_LATERAL_DESDE_NIVEL_SUELO_MINIMO_1 =
		CASE 
			WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F5') THEN 0.33
			WHEN T.FORMATO_TRABAJO IN ('F4','F6') THEN 0.2
		END,
		T.AISLAMIENTO_POSTERIOR_1_3_ALTURA_EDIFICIO_1 =
		CASE 
			WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3') THEN 0.33
			WHEN T.FORMATO_TRABAJO IN ('F4','F5','F6') THEN 0
		END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));    

		--E60_2 E62_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.AISLAMIENTO_LATERAL_DESDE_NIVEL_SUELO_MINIMO_2 = 
		CASE 
			WHEN UPPER(T.TIPOLOGIA_URBANISTICA) = 'A' THEN 
				CASE 
					WHEN T.AISLAMIENTO_LATERAL_DESDE_NIVEL_SUELO_MINIMO_1 * T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_2 > 4 THEN T.AISLAMIENTO_LATERAL_DESDE_NIVEL_SUELO_MINIMO_1 * T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_2
					ELSE 4
				END
			ELSE 0
		END,
		T.RETROCESO_SOBRE_VIA_1 = 
		CASE 
			WHEN T.FORMATO_TRABAJO IN ('F6') THEN PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_2 / NULLIF(NO_PISO_SOBRE_INDICE_MAXIMO_2,0)
			ELSE 0
		END,
		T.AISLAMIENTO_POSTERIOR_1_3_ALTURA_EDIFICIO_2 = 
		CASE 
			WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3') THEN
				CASE 
					WHEN T.AISLAMIENTO_POSTERIOR_1_3_ALTURA_EDIFICIO_1 * T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_2 > 4 THEN T.AISLAMIENTO_POSTERIOR_1_3_ALTURA_EDIFICIO_1 * T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_2
					ELSE 4
				END		
			WHEN T.FORMATO_TRABAJO IN ('F4') THEN	
				CASE 
					WHEN T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1 <= 3  THEN 4
					WHEN T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1 <= 6  THEN 5
					WHEN T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1 <= 9  THEN 6
					WHEN T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1 <= 12 THEN 8
					WHEN T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1 <= 15 THEN 10
					WHEN T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1 <= 18 THEN 12
					WHEN T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1 <= 22 THEN 14
					WHEN T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1 <= 15 THEN 16
					WHEN T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1 <= 28 THEN 18
					ELSE 20
				END
			WHEN T.FORMATO_TRABAJO IN ('F5') THEN
				CASE
					WHEN T.NO_PISO_SOBRE_INDICE_MAXIMO_2 <= 12 THEN 4
					WHEN T.NO_PISO_SOBRE_INDICE_MAXIMO_2 <= 18 THEN 5
					WHEN T.NO_PISO_SOBRE_INDICE_MAXIMO_2 <= 27 THEN 6
					WHEN T.NO_PISO_SOBRE_INDICE_MAXIMO_2 <= 36 THEN 8
					WHEN T.NO_PISO_SOBRE_INDICE_MAXIMO_2 <= 45 THEN 10
					WHEN T.NO_PISO_SOBRE_INDICE_MAXIMO_2 <= 54 THEN 12
					WHEN T.NO_PISO_SOBRE_INDICE_MAXIMO_2 <= 66 THEN 14
					WHEN T.NO_PISO_SOBRE_INDICE_MAXIMO_2 <= 75 THEN 16
					WHEN T.NO_PISO_SOBRE_INDICE_MAXIMO_2 <= 84 THEN 18
					ELSE 20
				END
			WHEN T.FORMATO_TRABAJO IN ('F6') THEN	
				CASE 
					WHEN T.ES_MANZANA = 1 THEN 0
					WHEN T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1 <= 3  THEN 0
					WHEN T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1 <= 6  THEN 5
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1   <= 9  THEN 6
					WHEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1   <= 12 THEN 8
					ELSE 0
				  END			
		END	
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));    

		--E63_2 E64_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.OCUPACION_MAXIMA_CONTROL_AMBIENTAL_AISLAMIENTOS_2 = 
		CASE 
				WHEN T.RANGO_1_TRABAJAR = '4A' OR T.RANGO_1_TRABAJAR = '4B' THEN T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_2
				ELSE 0
		END,
		T.OCUPACION_MAXIMA_UTILIZAR_DISENO_2 = 
		(
			SELECT T1.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
			WHERE T.CHIP = T1.CHIP AND T.ID_ORIGINAL = T1.ID_ORIGINAL AND T1.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')
		),
		T.PUNTOS_FIJOS_PORC_AREA_TOTAL_CONSTRUIDA_1 = 10
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));   

		--E63_1 E64_1 --E66_2 --E67_2 --E68_1 --E68_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.OCUPACION_MAXIMA_CONTROL_AMBIENTAL_AISLAMIENTOS_1 = NVL(T.OCUPACION_MAXIMA_CONTROL_AMBIENTAL_AISLAMIENTOS_2 / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2, 0), 0),
		T.OCUPACION_MAXIMA_UTILIZAR_DISENO_1 = 	NVL(T.OCUPACION_MAXIMA_UTILIZAR_DISENO_2 / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2, 0) * 100, 0)
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));   
		
		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING (
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				T1.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20 AS AREA_CONSTRUIDA_PISO_TIPO_2,
				T1.AREA_TOTAL_CONSTRUIDA_USOS_VENDIBLES_2 AS AREA_CONSTRUIDA_ANTES_CIRCULACIONES_EQUIPAMIENTO_2,
				T1.PUNTOS_FIJOS_2 AS PUNTOS_FIJOS_PORC_AREA_TOTAL_CONSTRUIDA_2,
				T1.CIRCULACIONES_2 AS CIRCULACIONES_M2_PORC_AREA_TOTAL_CONSTRUIDA_2
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		UPDATE SET
			T.AREA_CONSTRUIDA_PISO_TIPO_2 = 
			CASE 
				WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F5') THEN SRC.AREA_CONSTRUIDA_PISO_TIPO_2
				WHEN T.FORMATO_TRABAJO IN ('F4') THEN 0
			END,
			T.AREA_CONSTRUIDA_ANTES_CIRCULACIONES_EQUIPAMIENTO_2 = SRC.AREA_CONSTRUIDA_ANTES_CIRCULACIONES_EQUIPAMIENTO_2,
			T.PUNTOS_FIJOS_PORC_AREA_TOTAL_CONSTRUIDA_2 = SRC.PUNTOS_FIJOS_PORC_AREA_TOTAL_CONSTRUIDA_2,
			T.CIRCULACIONES_M2_PORC_AREA_TOTAL_CONSTRUIDA_2 = SRC.CIRCULACIONES_M2_PORC_AREA_TOTAL_CONSTRUIDA_2;

		--E69_1
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.CIRCULACIONES_M2_PORC_AREA_TOTAL_CONSTRUIDA_1 = 
		CASE 
				WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'VIVIENDA' THEN 
					CASE
						WHEN (UPPER(T.OFERTAS_RESIDENCIAL) = 'VIP' OR UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' OR T.OFERTAS_RESIDENCIAL = '3' OR T.OFERTAS_RESIDENCIAL = '4') THEN 5
						ELSE 10
					END
				ELSE 15
		END  
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));     
		


	--EQUIPAMIENTO COMUNAL PRIVADO (ECP) E82 PAR
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.TOTAL_UNIDADES_VIVIENDA_GENERADAS_2 = T.NO_UNIDADES_GENERADAS_CUMPLIR_OBLIGACION_VIP_2 + T.NO_UNIDADES_VIS_GENERADAS_2 + T.NO_UNIDADES_NO_VIS_NI_VIP_GENERADAS_2,
		T.EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_1 = 0.08,
		T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_CERO_1 = 40,
		T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_1 = 20,
		T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_1 = 40,
		T.EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_1 = 0.19,
		T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_NO_VIP_VIS_1 = 40,
		T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_NO_VIP_VIS_1 = 20,
		T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_NO_VIP_VIS_1 = 40,
		T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_VIS_1 = 40,
		T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_RESIDENCIAL_VIP_VIS_1 = 20,
		T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_RESIDENCIAL_VIP_VIS_1 = 40
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  



		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING (
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				T1.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_CONSTRUIDA_2,
				T1.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_1
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		UPDATE SET
			T.EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_2 = 
				CASE 
                   WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' THEN (SRC.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_CONSTRUIDA_2 + SRC.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_1) 
                   ELSE SRC.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_CONSTRUIDA_2
                END,			
			T.EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_VIP_VIS_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' THEN 0
				ELSE 
					CASE
						WHEN UPPER(T.OFERTAS_RESIDENCIAL) IN('VIS','VIP') AND T.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6') THEN SRC.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_1
						ELSE 0
					END	
				END,
			T.EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_2 = 
				CASE 
					WHEN (UPPER(T.OFERTAS_RESIDENCIAL) = 'VIP' OR UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' OR UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS') THEN 0
					ELSE SRC.EQUIPAMIENTO_COMUNAL_EXIGIDO_EN_COMERCIO_SOBRE_AREA_1
				END;

		--E85_2 -E86_2 -E87_2  -E88_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_CERO_2 = T.EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_2 * (T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_CERO_1 / 100),
		T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_2 = T.EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_2 * (T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_1 / 100),
		T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_2 = T.EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_2 * (T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_1 / 100)
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  


	--ÁREAS VENDIBLES PAR 1
		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING (
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				T1.AREA_TOTAL_VENTA_COMERCIO_2,
				T1.AREA_VENTA_VIVIENDA_U_OFICINAS_20,
				T1.AREA_VENTA_APTO_U_OFICINAS_2,
				T1.AREA_VENTA_APTO_U_OFICINAS_VIP_2,
				T1.NO_APTOS_U_OFICINAS_2,
				T1.NO_APTOS_VIP_2
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		UPDATE SET
			T.AREA_VENDIBLE_COMERCIO_2 = SRC.AREA_TOTAL_VENTA_COMERCIO_2,
			T.AREA_VENDIBLE_OFICINA_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' THEN SRC.AREA_VENTA_VIVIENDA_U_OFICINAS_20
					ELSE 0
				END,
			T.AREA_VENDIBLE_VIVIENDA_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'VIVIENDA' THEN SRC.AREA_VENTA_VIVIENDA_U_OFICINAS_20
					ELSE 0
				END,
			T.AREA_NO_VIP_NI_VIS_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' OR UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN 0
					ELSE SRC.AREA_VENTA_APTO_U_OFICINAS_2
				END,
			T.AREA_VIS_2 = 
				CASE 
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN SRC.AREA_VENTA_APTO_U_OFICINAS_2
					ELSE 0
				END,
			T.AREA_VIP_2 = SRC.AREA_VENTA_APTO_U_OFICINAS_VIP_2,
			T.NO_UNIDADES_NO_VIS_NI_VIP_GENERADAS_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' OR UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN 0
					ELSE SRC.NO_APTOS_U_OFICINAS_2
				END,
			T.NO_UNIDADES_VIS_GENERADAS_2 = 
				CASE 
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN SRC.NO_APTOS_U_OFICINAS_2
					ELSE 0
				END,
			T.NO_UNIDADES_GENERADAS_CUMPLIR_OBLIGACION_VIP_2 = SRC.NO_APTOS_VIP_2;




		--E98 1 Y 2 PAR
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.INDICE_DE_CONSTRUCCION_EFECTIVO_CONCRETADO_AREA_2 = T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_2
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));     	


		--E70_2 1 Y 2 PAR
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.AREA_CONSTRUIDA_MENOS_PUNTOS_FIJOS_CIRCULACIONES_2 = AREA_CONSTRUIDA_ANTES_CIRCULACIONES_EQUIPAMIENTO_2 - PUNTOS_FIJOS_PORC_AREA_TOTAL_CONSTRUIDA_2 - CIRCULACIONES_M2_PORC_AREA_TOTAL_CONSTRUIDA_2
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));     	

		--E71_2 1 Y 2 PAR
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2 = 
		CASE
			WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3') THEN T.AREA_NETA_URBANIZABLE_M2_2 * (T.AREA_UTIL_PARA_CARGA_VIP_293_1 / 100) * T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_1
			WHEN T.FORMATO_TRABAJO IN ('F4','F5') THEN T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_1 * T.INDICE_DE_CONSTRUCCION_EFECTIVO_CONCRETADO_AREA_2
		    WHEN T.FORMATO_TRABAJO IN ('F6') THEN T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_1 * (T.AREA_VENDIBLE_COMERCIO_2 + T.AREA_VENDIBLE_OFICINA_2 + T.AREA_VENDIBLE_VIVIENDA_2)
		END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));     	

		--E71_2 1 Y 2 PAR
		MERGE INTO TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
        USING (
                SELECT 
                    T1.CHIP,
                    T1.ID_ORIGINAL,
					T1.FORMATO_TRABAJO,
                    T1.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2 AS AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2
                FROM TBL_TEMP_RESULTADO_PREDIOS T1
        ) SRC
        ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
        WHEN MATCHED THEN
        UPDATE SET
                T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2 = SRC.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2;

		--E295_2 1 Y 2 PAR
		UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
		SET 
		T.AREA_CONSTRUIDA_VIVIENDA_VIP_20 = 
		CASE 
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIP' THEN T.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20 * (T.NO_DE_PISOS - 1)
			WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) <> 'VIVIENDA' THEN 0
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) IN ('VIS','3') THEN T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2 / NULLIF((1 - T.PUNTOS_FIJOS_PORCENTAJE_AREA_TOTAL_CONSTRUIDA),0)
			ELSE 0
		END		
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


		--E295_1 1 Y 2 PAR
		UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
		SET 
		T.AREA_CONSTRUIDA_VIVIENDA_VIP_10 = T.AREA_CONSTRUIDA_VIVIENDA_VIP_20 / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0)
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 
		
		--E297_2 E298_2 E299_2 E300_2 E301_1 E301_2 E302_1 E302_2 E303_2 E304_2 E305_2 1 Y 2 PAR
		UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
		SET 
		T.APTO_U_OFICINAS_2 = T.NO_DE_ESTACIONAMIENTOS_BICICLETAS_PISO_TIPO_2 * (T.NO_DE_PISOS - 1) * T.APTO_U_OFICINAS_1,
		T.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_2 = AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_2 * (T.NO_DE_PISOS - 1) + T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_2,
		T.AREA_VENTA_COMERCIO_1 = T.NO_MINIMO_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_1,
		T.AREA_VENTA_COMERCIO_2 = T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_2,
		T.AREA_VENTA_VIVIENDA_U_OFICINAS_1 = T.NO_MINIMO_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_PARA_TODAS_1,
		T.AREA_VENTA_VIVIENDA_U_OFICINAS_2 = 
		CASE
			WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_2 * (T.NO_DE_PISOS - 1)
		    WHEN T.FORMATO_TRABAJO IN ('F6') THEN T.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_2 * (T.NO_DE_PISOS - 1) + 0
		END,
		T.AREA_TOTAL_VENTA_2 = AREA_DE_VENTAS_PISO_TIPO_2 * (T.NO_DE_PISOS - 1) + CIRCULACIONES_21,
		T.AREA_TOTAL_VENTA_COMERCIO_2 = T.AREA_VENDIBLE_DE_COMERCIO_1_PISO_2,
		T.AREA_VENTA_VIVIENDA_U_OFICINAS_20 = 
		CASE
			WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F4','F5') THEN T.AREA_DE_VENTAS_PISO_TIPO_2 * (T.NO_DE_PISOS - 1)
			WHEN T.FORMATO_TRABAJO IN ('F6') THEN T.AREA_DE_VENTAS_PISO_TIPO_2 * (T.NO_DE_PISOS - 1) + 0
			ELSE 0
		END		
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 
		
		--E307_2 1 Y 2 PAR
		UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
		SET 
		T.AREA_VENTA_APTO_U_OFICINAS_VIP_2 = (T.AREA_CONSTRUIDA_VIVIENDA_VIP_20 * (1 - PUNTOS_FIJOS_PORCENTAJE_AREA_TOTAL_CONSTRUIDA - CIRCULACIONES_M2_PORCENTAJE_DEL_AREA_TOTAL)) 
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

		--E310 1 Y 2 PAR
		MERGE INTO TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
		USING (
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',T1.VIGENCIA,UPPER(T1.NOMBRE_LOCALIDAD),UPPER(T1.CODIGO_BARRIO),UPPER(T1.OFERTAS_RESIDENCIAL),UPPER(T1.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) AS VAL_M2
			FROM TBL_TEMP_RESULTADO_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		UPDATE SET
			T.NO_APTOS_VIP_2 = 
			(CEIL(T.AREA_VENTA_APTO_U_OFICINAS_VIP_2 / SRC.VAL_M2));

		--E309 1 Y 2 PAR
		UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
		SET 
		T.NO_APTOS_U_OFICINAS_2 =  
		CASE
				WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIP' THEN 0 
				ELSE (T.NO_DE_APTOS_U_OFICINAS_PISO_TIPO_2 * (T.NO_DE_PISOS - 1)) - NO_APTOS_VIP_2
		END		
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 
		
		--E306_2 E308_2 1 Y 2 PAR
		UPDATE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T
		SET 
		T.AREA_VENTA_APTO_U_OFICINAS_2 = T.AREA_VENTA_VIVIENDA_U_OFICINAS_20 - T.AREA_VENTA_APTO_U_OFICINAS_VIP_2,
		T.AREA_VENTA_VIVIENDA_VIP_2 = T.NO_APTOS_U_OFICINAS_2 + T.NO_APTOS_VIP_2	
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


	--ÁREAS VENDIBLES PAR 1
		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING (
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				T1.AREA_TOTAL_VENTA_COMERCIO_2,
				T1.AREA_VENTA_VIVIENDA_U_OFICINAS_20,
				T1.AREA_VENTA_APTO_U_OFICINAS_2,
				T1.AREA_VENTA_APTO_U_OFICINAS_VIP_2,
				T1.NO_APTOS_U_OFICINAS_2,
				T1.NO_APTOS_VIP_2
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		UPDATE SET
			T.AREA_VENDIBLE_COMERCIO_2 = SRC.AREA_TOTAL_VENTA_COMERCIO_2,
			T.AREA_VENDIBLE_OFICINA_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' THEN SRC.AREA_VENTA_VIVIENDA_U_OFICINAS_20
					ELSE 0
				END,
			T.AREA_VENDIBLE_VIVIENDA_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'VIVIENDA' THEN SRC.AREA_VENTA_VIVIENDA_U_OFICINAS_20
					ELSE 0
				END,
			T.AREA_NO_VIP_NI_VIS_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' OR UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN 0
					ELSE SRC.AREA_VENTA_APTO_U_OFICINAS_2
				END,
			T.AREA_VIS_2 = 
				CASE 
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN SRC.AREA_VENTA_APTO_U_OFICINAS_2
					ELSE 0
				END,
			T.AREA_VIP_2 = SRC.AREA_VENTA_APTO_U_OFICINAS_VIP_2,
			T.NO_UNIDADES_NO_VIS_NI_VIP_GENERADAS_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' OR UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN 0
					ELSE SRC.NO_APTOS_U_OFICINAS_2
				END,
			T.NO_UNIDADES_VIS_GENERADAS_2 = 
				CASE 
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN SRC.NO_APTOS_U_OFICINAS_2
					ELSE 0
				END,
			T.NO_UNIDADES_GENERADAS_CUMPLIR_OBLIGACION_VIP_2 = SRC.NO_APTOS_VIP_2;

	--EQUIPAMIENTO COMUNAL PRIVADO (ECP) PAR
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.TOTAL_UNIDADES_VIVIENDA_GENERADAS_2 = T.NO_UNIDADES_GENERADAS_CUMPLIR_OBLIGACION_VIP_2 + T.NO_UNIDADES_VIS_GENERADAS_2 + T.NO_UNIDADES_NO_VIS_NI_VIP_GENERADAS_2,
		T.EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_1 = 0.08,
		T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_CERO_1 = 40,
		T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_1 = 20,
		T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_1 = 40,
		T.EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_1 = 0.19,
		T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_NO_VIP_VIS_1 = 40,
		T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_NO_VIP_VIS_1 = 20,
		T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_NO_VIP_VIS_1 = 40,
		T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_VIS_1 = 40,
		T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_RESIDENCIAL_VIP_VIS_1 = 20,
		T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_RESIDENCIAL_VIP_VIS_1 = 40
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

		--E88_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_VIS_2 = (T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_VIS_1 / 100) * T.EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_VIP_VIS_2,
		T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_RESIDENCIAL_VIP_VIS_2 = EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_VIP_VIS_2 * (SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_RESIDENCIAL_VIP_VIS_1 / 100),
		T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_NO_VIP_VIS_2 = T.EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_2 * (T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_NO_VIP_VIS_1 / 100),
		T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_NO_VIP_VIS_2 = T.EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_2 * (T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_NO_VIP_VIS_1 / 100),
		T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_NO_VIP_VIS_2 = T.EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_2 * (T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_NO_VIP_VIS_1 / 100),
		T.INDICE_DE_CONSTRUCCION_EFECTIVO_CONCRETADO_AREA_1  = NVL(T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_2 / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0),0)
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  


		--E95_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_RESIDENCIAL_VIP_VIS_2 = EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_VIP_VIS_2 * (ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_RESIDENCIAL_VIP_VIS_1 / 100)
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));


		--E96_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.TOTAL_EQUIPAMIENTO_CONSTRUIDO_1_PISO_2 = T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_2 + T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_NO_VIP_VIS_2 + T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_RESIDENCIAL_VIP_VIS_2,
		T.SISTEMA_DE_CARGA_OBLIGACIONES_1 = 
		CASE
			WHEN T.PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO <> 0 AND T.FORMATO_TRABAJO IN('F6') THEN T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_2 / NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0)
			ELSE 
			T.INDICE_DE_CONSTRUCCION_EFECTIVO_CONCRETADO_AREA_1	
		END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

	--CARGAS URBANÍSTICAS
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.AREA_ESTACIONAMIENTOS_BICICLETAS_MICROMOVILIDAD_1 = 1.70
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  


		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING (
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				T1.AREA_VENTA_COMERCIO_2,
				T1.AREA_VENTA_VIVIENDA_U_OFICINAS_2,
				T1.AREA_CONSTRUIDA_1_PISO_2,
				T1.AREA_SOBRANTE_ESTACIONAMIENTOS_AISLAMIENTOS_DPP_2,
				T1.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_20,
				T1.NO_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_EMISIONES_CERO_2,
				T1.AREA_CONSTRUIDA_DESTINADA_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_2,
				T1.AREA_SOBRANTE_AISLAMIENTOS_ESTACIONAMIENTOS_VEHICULARES_DPP_2,
				T1.PRIMER_PISO_CUBIERTO_CE_2
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL  AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		UPDATE SET
			T.AREA_ESTACIONAMIENTOS_COMERCIO_2 = SRC.AREA_VENTA_COMERCIO_2,
			T.AREA_ESTACIONAMIENTOS_OFICINAS_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' THEN SRC.AREA_VENTA_VIVIENDA_U_OFICINAS_2
					ELSE 0
				END,
			T.AREA_ESTACIONAMIENTOS_VIVIENDA_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'VIVIENDA' THEN SRC.AREA_VENTA_VIVIENDA_U_OFICINAS_2
					ELSE 0
				END,
			T.AREA_DISPONIBLE_SOTANO_2 = SRC.AREA_CONSTRUIDA_1_PISO_2,
			T.AREA_DISPONIBLE_PRIMER_PISO_DESCUBIERTO_2 = SRC.AREA_SOBRANTE_ESTACIONAMIENTOS_AISLAMIENTOS_DPP_2,
			T.AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_2 = SRC.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_20,
			T.NUMERO_ESTACIONAMIENTOS_BICICLETAS_MICROMOVILIDAD_2 = SRC.NO_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_EMISIONES_CERO_2,
			T.AREA_ESTACIONAMIENTOS_BICICLETAS_MICROMOVILIDAD_2 = SRC.AREA_CONSTRUIDA_DESTINADA_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_2,
			T.AREA_DISPONIBLE_PRIMER_PISO_DESC_BICICLETAS_2 = 
			CASE 
				WHEN SRC.AREA_SOBRANTE_AISLAMIENTOS_ESTACIONAMIENTOS_VEHICULARES_DPP_2 < 0 THEN 0
				ELSE SRC.AREA_SOBRANTE_AISLAMIENTOS_ESTACIONAMIENTOS_VEHICULARES_DPP_2
			END,
			T.AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_DESC_BICICLETAS_2 = SRC.PRIMER_PISO_CUBIERTO_CE_2;

	--ESTACIONAMIENTOS
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_DESCUBIERTO_1 = 
		CASE 
			WHEN T.AREA_DISPONIBLE_PRIMER_PISO_DESC_BICICLETAS_2 = 0 THEN 0
			ELSE 18	
		END,		
		T.NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_CUBIERTO_1 = 
		CASE 
			WHEN T.AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_DESC_BICICLETAS_2 = 0 THEN 0
			ELSE 23.1	
		END,
		T.NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_CUBIERTO_2 = T.AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_DESC_BICICLETAS_2,
		T.NUMERO_ESTACIONAMIENTOS_COMERCIO_1 = 
		CASE 
			WHEN T.AREA_ESTACIONAMIENTOS_COMERCIO_2 = 0 THEN 0
			ELSE 23.1	
		END,
		T.NUMERO_ESTACIONAMIENTOS_VIVIENDA_1 = 
		CASE 
			WHEN T.AREA_ESTACIONAMIENTOS_VIVIENDA_2 = 0 THEN 0
			WHEN T.AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_DESC_BICICLETAS_2 = 0 THEN 18
			ELSE 23.1
		END,	
		T.NUMERO_ESTACIONAMIENTOS_OFICINAS_1 = 
		CASE 
			WHEN T.AREA_ESTACIONAMIENTOS_OFICINAS_2 = 0 THEN 0
			ELSE 23.1	
		END,		
		T.CUPOS_PERSONAS_CON_DISCAPACIDAD_1 = 2
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND ROWNUM = 1 AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  


		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING (
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				T1.PRIMER_PISO_DESCUBIERTO_CE_2,
				T1.COMERCIO_20,
				T1.VIVIENDA_U_OFICINAS_2,
				T1.CONTROL_ESTACIONAMIENTOS_CE_2
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		UPDATE SET
			T.NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_DESCUBIERTO_2 = SRC.PRIMER_PISO_DESCUBIERTO_CE_2,
			T.NUMERO_ESTACIONAMIENTOS_COMERCIO_2 = SRC.COMERCIO_20,
			T.NUMERO_ESTACIONAMIENTOS_OFICINAS_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' THEN SRC.VIVIENDA_U_OFICINAS_2
					ELSE 0	
				END,
			T.NUMERO_ESTACIONAMIENTOS_VIVIENDA_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'VIVIENDA' THEN SRC.CONTROL_ESTACIONAMIENTOS_CE_2
					ELSE 0	
				END;

		--E96_2
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.CUPOS_PERSONAS_CON_DISCAPACIDAD_2 = 
		CASE 
			WHEN TRUNC(NVL(T.CUPOS_PERSONAS_CON_DISCAPACIDAD_1 / 100, 0) * 
							   (NVL(T.NUMERO_ESTACIONAMIENTOS_COMERCIO_2, 0) + 
								NVL(T.NUMERO_ESTACIONAMIENTOS_OFICINAS_2, 0) + 
								NVL(T.NUMERO_ESTACIONAMIENTOS_VIVIENDA_2, 0))) < 1 THEN 1
			ELSE TRUNC(NVL(T.CUPOS_PERSONAS_CON_DISCAPACIDAD_1 / 100, 0) * 
							   (NVL(T.NUMERO_ESTACIONAMIENTOS_COMERCIO_2, 0) + 
								NVL(T.NUMERO_ESTACIONAMIENTOS_OFICINAS_2, 0) + 
								NVL(T.NUMERO_ESTACIONAMIENTOS_VIVIENDA_2, 0)))
		END,
		T.AREA_TOTAL_OCUPADA_SOTANOS_1 = 
		CASE 
			WHEN NVL(T.AREA_DISPONIBLE_SOTANO_1, 0) = 0 THEN 0
			ELSE 0
		END		
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 



		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING (
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				T1.AREA_CONSTRUIDA_SOTANO_TIPOLOGIA_2,
				T1.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_2,
				T1.NO_SOTANOS_1,
				T1.SOTANO_TIPOLOGIA_CE_2,
				T1.SOTANO_FUERA_TIPOLOGIA_CE_2
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		UPDATE SET
			T.AREA_TOTAL_OCUPADA_SOTANOS_2 = SRC.AREA_CONSTRUIDA_SOTANO_TIPOLOGIA_2 + SRC.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_2,
			T.NUMERO_ESTACIONAMIENTOS_DISPONIBLES_SOTANO_1 = 
				CASE 
					WHEN SRC.NO_SOTANOS_1 = 0 THEN 0
					ELSE T.NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_CUBIERTO_1
				END,
			T.NUMERO_ESTACIONAMIENTOS_DISPONIBLES_SOTANO_2 = SRC.SOTANO_TIPOLOGIA_CE_2 + SRC.SOTANO_FUERA_TIPOLOGIA_CE_2;

	--VARIABLES DEFINITIVAS PARA  EL CÁLCULO
		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING (
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				T1.AREA_TOTAL_CONSTRUIDA_PROYECTO,
				T1.AREA_CONSTRUIDA_SOTANO_TIPOLOGIA_2,
				T1.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_2,
				T1.AREA_CONSTRUIDA_DESTINADA_BICICLETAS_VEHICULOS_EMISIONES_CERO_DPP_2,
				T1.AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_DPP_2,
				T1.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		UPDATE SET
			T.AREA_TOTAL_CONSTRUIDA_SIN_SOTANOS_2 = SRC.AREA_CONSTRUIDA_POR_PISO_PLANTA_TIPO_20 * T.NO_DE_PISOS,
			T.AREA_SOTANO_CONSTRUIDA_INCLUIDA_TIPOLOGIA_2 = SRC.AREA_CONSTRUIDA_SOTANO_TIPOLOGIA_2,
			T.AREA_SOTANO_ADICIONAL_CONSTRUIR_2 = SRC.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_2,
			T.AREA_ESTACIONAMIENTOS_PRIMER_PISO_DESCUBIERTOS_2 = SRC.AREA_CONSTRUIDA_DESTINADA_BICICLETAS_VEHICULOS_EMISIONES_CERO_DPP_2 + 	SRC.AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_DPP_2;

		
	--VENTAS DEL PROYECTO
		--E127
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_1 = NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),0),
		T.UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_VP_1 = 18.00,
		T.UNIDAD_ESTACIONAMIENTO_CUBIERTO_COMERCIO_VP_1 = 23.10,
		T.UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_VP_1 = 18.00,		
		T.UNIDAD_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_VP_1 = 23.10,
		T.UNIDAD_ESTACIONAMIENTO_CUBIERTO_OFICINAS_VP_1 = 23.10,
		T.UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_VP_1 = 18.00
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING (
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				T1.AREA_TOTAL_VENTA_COMERCIO_2,
				T1.AREA_VENTA_VIVIENDA_U_OFICINAS_20,
				T1.AREA_VENTA_APTO_U_OFICINAS_3,
				T1.NO_APTOS_U_OFICINAS_2,
				T1.NO_APTOS_VIP_2,
				T1.PRIMER_PISO_DESCUBIERTO_CE_3,
				T1.PRIMER_PISO_CUBIERTO_CE_3,
				T1.PRIMER_PISO_DESCUBIERTO_CE_4,
				T1.PRIMER_PISO_CUBIERTO_CE_4,
				T1.SOTANO_TIPOLOGIA_CE_2,
				T1.SOTANO_FUERA_TIPOLOGIA_CE_2
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		UPDATE SET
			T.AREA_VENDIBLE_COMERCIO_VP_2 = SRC.AREA_TOTAL_VENTA_COMERCIO_2,
			T.AREA_VENDIBLE_OFICINA_VP_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' THEN SRC.AREA_VENTA_VIVIENDA_U_OFICINAS_20
					ELSE 0
				END,
			T.AREA_VENDIBLE_VIVIENDA_VP_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'VIVIENDA' THEN SRC.AREA_VENTA_VIVIENDA_U_OFICINAS_20
					ELSE 0
				END,
			T.UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_1 = SRC.AREA_VENTA_APTO_U_OFICINAS_3,
			T.UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' THEN 0
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN 0
					ELSE SRC.NO_APTOS_U_OFICINAS_2
				END,
			T.UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_1 = 
				CASE 
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN SRC.AREA_VENTA_APTO_U_OFICINAS_3
					ELSE 0
				END,
			T.UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_2 = 
				CASE 
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN SRC.NO_APTOS_U_OFICINAS_2
					ELSE 0
				END,
			T.UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_2 = SRC.NO_APTOS_VIP_2,
			T.UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_VP_2 = SRC.PRIMER_PISO_DESCUBIERTO_CE_3,
			T.UNIDAD_ESTACIONAMIENTO_CUBIERTO_COMERCIO_VP_2 = SRC.PRIMER_PISO_CUBIERTO_CE_3,
			T.UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_VP_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' THEN SRC.PRIMER_PISO_DESCUBIERTO_CE_4
					ELSE 0
				END,
			T.UNIDAD_ESTACIONAMIENTO_CUBIERTO_OFICINAS_VP_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' THEN SRC.PRIMER_PISO_CUBIERTO_CE_4
					ELSE 0
				END,
			T.UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_VP_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'VIVIENDA' THEN SRC.PRIMER_PISO_DESCUBIERTO_CE_4
					ELSE 0
				END,
			T.UNIDAD_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_VP_2 = 
				CASE 
					WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'VIVIENDA' THEN SRC.PRIMER_PISO_CUBIERTO_CE_4 + SRC.SOTANO_TIPOLOGIA_CE_2 + SRC.SOTANO_FUERA_TIPOLOGIA_CE_2
					ELSE 0
				END;


	--ANÁLISIS DE VENTAS
	   --D142
	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.VALOR_M2_COMERCIO_AV_1 = 
		CASE 
			WHEN T.AREA_VENDIBLE_OFICINA_VP_2 = 0 THEN 
				CASE 
					WHEN T.AREA_VENDIBLE_COMERCIO_VP_2 = 0    THEN 0
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIP' THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_LOCAL',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) 
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_LOCAL',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('LOCAL_VALOR','2','') --5200000.00
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '2'   THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_LOCAL',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('LOCAL_VALOR','3','') --10600000.00
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '3'   THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_LOCAL',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('LOCAL_VALOR','3','') --10600000.00
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '4'   THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_LOCAL',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('LOCAL_VALOR','4','') --11600000.00
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '5'   THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_LOCAL',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('LOCAL_VALOR','5','') --13800000.00 
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '6'   THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_LOCAL',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('LOCAL_VALOR','6','') --14200000.00
					ELSE 0
				END
            WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIP' 						THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_LOCAL',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('LOCAL_VALOR','OFICINAS Y COMERCIO 1 PISO (ESTRATO 3)','') --10600000.00 							
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) IN('VIS', '2', '3', '4', '5') THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_LOCAL',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('LOCAL_VALOR','OFICINAS Y COMERCIO 1 PISO (ESTRATO 3)','') --10600000.00 							
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '6' 						THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_LOCAL',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('LOCAL_VALOR','OFICINAS Y COMERCIO 1 PISO (ESTRATO 4-5-6)','') --13400000.00
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'ZONA RESERVA' 				THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_LOCAL',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('LOCAL_VALOR','LOCALES DE 1 PISO (TIPO ARA)','') --5000000.00
			ELSE 0
		END,
		T.VALOR_M2_OFICINA_AV_1 = 
		CASE 
			WHEN T.AREA_VENDIBLE_OFICINA_VP_2 = 0 	  			THEN 0
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIP' 			THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_OFICINA',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('VALOR_INTEGRAL','OFICINAS Y COMERCIO 1 PISO (ESTRATO 3)','') --5900000.00
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' 			THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_OFICINA',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('VALOR_INTEGRAL','OFICINAS Y COMERCIO 1 PISO (ESTRATO 3)','') --5900000.00
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '2' 			THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_OFICINA',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('VALOR_INTEGRAL','OFICINAS Y COMERCIO 1 PISO (ESTRATO 3)','') --5900000.00
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '3' 			THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_OFICINA',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('VALOR_INTEGRAL','OFICINAS Y COMERCIO 1 PISO (ESTRATO 3)','') --5900000.00
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '4' 			THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_OFICINA',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('VALOR_INTEGRAL','OFICINAS Y COMERCIO 1 PISO (ESTRATO 4-5-6)','') --9200000.00 
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '5' 			THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_OFICINA',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('VALOR_INTEGRAL','OFICINAS Y COMERCIO 1 PISO (ESTRATO 4-5-6)','') --9200000.00 
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) = '6' 			THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_OFICINA',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('VALOR_INTEGRAL','OFICINAS Y COMERCIO 1 PISO (ESTRATO 4-5-6)','') --9200000.00 
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'ZONA RESERVA' 	THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_OFICINA',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('LOCAL_VALOR','LOCALES DE 1 PISO (TIPO ARA)','') --5000000.00 
			ELSE 0
		END,
		T.VALOR_M2_VIVIENDA_NO_VIS_VIP_AV_1 = 
		CASE 
			WHEN T.UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_2 = 0 THEN 0
			WHEN T.OFERTAS_RESIDENCIAL = '3' THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_VIVIENDA',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('VALOR_INTEGRAL','3','') --6200000.00
			WHEN T.OFERTAS_RESIDENCIAL = '4' THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_VIVIENDA',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('VALOR_INTEGRAL','4','') --8100000.00
			WHEN T.OFERTAS_RESIDENCIAL = '5' THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_VIVIENDA',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('VALOR_INTEGRAL','5','') --8800000.00
			WHEN T.OFERTAS_RESIDENCIAL = '6' THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_VIVIENDA',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),NULL) --PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('VALOR_INTEGRAL','6','') --11800000.00
			ELSE 0
		END,
		T.VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIS_150_SMMLV_AV_2 =     
		CASE
			WHEN T.UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_2 = 0 THEN 0
			ELSE T.UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_2 * 
			NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),0) *
			NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_VIVIENDA',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),0) 
		END,
		T.VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIP_90_SMMLV_AV_2 = 
		CASE
			WHEN T.UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_2 = 0 THEN 0
			ELSE T.UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_2  * 
			NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('M2',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),0) *
			NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24A('V_VIVIENDA',T.VIGENCIA,UPPER(T.NOMBRE_LOCALIDAD),UPPER(T.CODIGO_BARRIO),UPPER(T.OFERTAS_RESIDENCIAL),UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL)), 0),0) 
		END,
		T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_AV_1 = 
		CASE 
			WHEN T.AREA_VENDIBLE_OFICINA_VP_2 = 0 THEN 
				CASE 
					WHEN T.AREA_VENDIBLE_COMERCIO_VP_2 = 0 		THEN 0
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIP' 	THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'1','') --0
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' 	THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'2','') --0
					WHEN T.OFERTAS_RESIDENCIAL = '2' 			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'2','') --0
					WHEN T.OFERTAS_RESIDENCIAL = '3' 			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'3','') --13300000.00
					WHEN T.OFERTAS_RESIDENCIAL = '4' 			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'4','') --19000000.00
					WHEN T.OFERTAS_RESIDENCIAL = '5' 			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'5','') --23750000.00
					WHEN T.OFERTAS_RESIDENCIAL = '6' 			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'6','') --32250000.00
					ELSE 0
				END
			ELSE 
				CASE
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIP' 	THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'5','') --23750000.00
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' 	THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'5','') --23750000.00
					WHEN T.OFERTAS_RESIDENCIAL = '2'   			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'5','') --23750000.00
					WHEN T.OFERTAS_RESIDENCIAL = '3'   			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'6','') --32250000.00
					WHEN T.OFERTAS_RESIDENCIAL = '4'   			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'COMERCIO','') --33250000.00
					WHEN T.OFERTAS_RESIDENCIAL = '5'   			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'COMERCIO','') --33250000.00
					WHEN T.OFERTAS_RESIDENCIAL = '6'   			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'COMERCIO','') --33250000.00
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'ZONA RESERVA' THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'OFICINAS Y COMERCIO 1 PISO (ESTRATO 3)','') --33250000.00
					ELSE 0
				END
		END,
		T.VALOR_ESTACIONAMIENTO_CUBIERTO_COMERCIO_AV_1 =
		CASE 
			WHEN T.AREA_VENDIBLE_OFICINA_VP_2 = 0 THEN 
				CASE 
					WHEN T.AREA_VENDIBLE_COMERCIO_VP_2 = 0 		THEN 0
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIP' 	THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'1','') --0   
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' 	THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'2','') --0
					WHEN T.OFERTAS_RESIDENCIAL = '2' 			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'2','') --0
					WHEN T.OFERTAS_RESIDENCIAL = '3' 			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'3','') --19950000.00
					WHEN T.OFERTAS_RESIDENCIAL = '4' 			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'4','') --23000000.00
					WHEN T.OFERTAS_RESIDENCIAL = '5' 			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'5','') --28500000.00
					WHEN T.OFERTAS_RESIDENCIAL = '6' 			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'6','') --38000000.00
					ELSE 0
				END
			ELSE 
				CASE
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIP' 	THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'5','') --28500000.00
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' 	THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'5','') --28500000.00
					WHEN T.OFERTAS_RESIDENCIAL = '2' 			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'5','') --28500000.00
					WHEN T.OFERTAS_RESIDENCIAL = '3' 			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'6','') --38000000.00
					WHEN T.OFERTAS_RESIDENCIAL = '4' 			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'COMERCIO','') --38000000.00
					WHEN T.OFERTAS_RESIDENCIAL = '5' 			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'COMERCIO','') --38000000.00
					WHEN T.OFERTAS_RESIDENCIAL = '6' 			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'COMERCIO','') --38000000.00
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'ZONA RESERVA' THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'OFICINAS Y COMERCIO 1 PISO (ESTRATO 3)','') --38000000.00
					ELSE NULL
				END
		END,
		T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_AV_1 =
		CASE 
			WHEN T.AREA_VENDIBLE_OFICINA_VP_2 = 0 THEN 0
			ELSE
				CASE 
					WHEN UPPER(OFERTAS_RESIDENCIAL) IN ('VIP', 'VIS','2', '3', '4', '5', '6') THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'OFICINAS Y COMERCIO 1 PISO (ESTRATO 3)','') --33250000.00	
					WHEN UPPER(OFERTAS_RESIDENCIAL) = 'ZONA RESERVA' THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'OFICINAS Y COMERCIO 1 PISO (ESTRATO 4-5-6)','') --33250000.00
					ELSE 0
				END
		END,
		T.VALOR_ESTACIONAMIENTO_CUBIERTO_OFICINAS_AV_1 =
		 CASE 
			WHEN T.AREA_VENDIBLE_OFICINA_VP_2 = 0 THEN 0
			ELSE 
				CASE
					WHEN UPPER(OFERTAS_RESIDENCIAL) IN ('VIP', 'VIS', '2', '3', '4', '5', '6') THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'OFICINAS Y COMERCIO 1 PISO (ESTRATO 3)','') --38000000.00
					WHEN UPPER(OFERTAS_RESIDENCIAL) = 'ZONA RESERVA' THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'OFICINAS Y COMERCIO 1 PISO (ESTRATO 3)','') --38000000.00  
					ELSE 0
				END	
		END,
		T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_AV_1 =
		CASE 
			WHEN T.UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_2 = 0 THEN 0
			WHEN UPPER(OFERTAS_RESIDENCIAL) = 'VIP' THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'1','') --0
			WHEN UPPER(OFERTAS_RESIDENCIAL) = 'VIS' THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'2','') --0
			WHEN UPPER(OFERTAS_RESIDENCIAL) = '3' 	THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'3','') --13300000.00
			WHEN UPPER(OFERTAS_RESIDENCIAL) = '4' 	THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'4','') --19000000.00
			WHEN UPPER(OFERTAS_RESIDENCIAL) = '5' 	THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'5','') --23750000.00
			WHEN UPPER(OFERTAS_RESIDENCIAL) = '6' 	THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_DESCUBIERTO',T.VIGENCIA,'6','') --32250000.00
			ELSE 0
		END,
		T.VALOR_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_AV_1 =
		CASE 
			WHEN T.UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_2 = 0 THEN 0
			WHEN UPPER(OFERTAS_RESIDENCIAL) = 'VIP' THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'1','') --0
			WHEN UPPER(OFERTAS_RESIDENCIAL) = 'VIS' THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'2','') --0
			WHEN UPPER(OFERTAS_RESIDENCIAL) = '3'   THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'3','') --19950000.00
			WHEN UPPER(OFERTAS_RESIDENCIAL) = '4'   THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'4','')--23000000.00
			WHEN UPPER(OFERTAS_RESIDENCIAL) = '5'   THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'5','')--28500000.00
			WHEN UPPER(OFERTAS_RESIDENCIAL) = '6'   THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL24('ESTACIONAMIENTO_CUBIERTO',T.VIGENCIA,'6','')--38000000.00
			ELSE 0
		END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  


		DBMS_OUTPUT.PUT_LINE('FINALIZA SP_ACTUALIZAR_PREDIOS_2');

		COMMIT;
	END;


	PROCEDURE SP_ACTUALIZAR_PREDIOS_2_1 IS --NIVEL_0
	--V_DTF_ADICIONALES_PA        NUMBER := 8.92; --W406
	
	BEGIN

		DBMS_OUTPUT.PUT_LINE('INICIO SP_ACTUALIZAR_PREDIOS_2_1');
		
		--EXECUTE IMMEDIATE 'TRUNCATE TABLE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS';
		
	------DATOS PRUEBA--------------
		-- Actualizar fórmulas en la tabla temporal

	   --E142
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.VALOR_M2_COMERCIO_AV_2 = T.VALOR_M2_COMERCIO_AV_1 * T.AREA_VENDIBLE_COMERCIO_VP_2,
		T.VALOR_M2_OFICINA_AV_2 = T.VALOR_M2_OFICINA_AV_1 * T.AREA_VENDIBLE_OFICINA_VP_2,
		T.VALOR_M2_VIVIENDA_NO_VIS_VIP_AV_2 =
		CASE
              WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' THEN 0
              ELSE T.VALOR_M2_VIVIENDA_NO_VIS_VIP_AV_1 * T.UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_2 * T.UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_1
        END,
		T.VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIS_150_SMMLV_AV_1 =
			CASE 
				WHEN NVL(T.UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_1, 0) * NVL(T.UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_2, 0) = 0 THEN 0
				ELSE NVL(T.VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIS_150_SMMLV_AV_2, 0) / (NVL(T.UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_1, 0) * NVL(T.UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_2, 0))
			END,
		T.VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIP_90_SMMLV_AV_1 =
			CASE 
				WHEN NVL(T.TOTAL_UNIDADES_VIVIENDA_GENERADAS_2, 0) = 0 THEN 0
				WHEN NVL(T.UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_1, 0) * NVL(T.UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_2, 0) = 0 THEN 0
				ELSE NVL(T.VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIP_90_SMMLV_AV_2, 0) / (NVL(T.UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_1, 0) * NVL(T.UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_2, 0))
			END,
		T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_AV_2 = T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_AV_1 * T.UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_VP_2,
		T.VALOR_ESTACIONAMIENTO_CUBIERTO_COMERCIO_AV_2 = T.VALOR_ESTACIONAMIENTO_CUBIERTO_COMERCIO_AV_1 * T.UNIDAD_ESTACIONAMIENTO_CUBIERTO_COMERCIO_VP_2,
		T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_AV_2 = T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_AV_1 * T.UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_VP_2,
		T.VALOR_ESTACIONAMIENTO_CUBIERTO_OFICINAS_AV_2 = T.VALOR_ESTACIONAMIENTO_CUBIERTO_OFICINAS_AV_1 * T.UNIDAD_ESTACIONAMIENTO_CUBIERTO_OFICINAS_VP_2,
		T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_AV_2 = T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_AV_1 * T.NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_DESCUBIERTO_2,
		T.VALOR_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_AV_2 = T.VALOR_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_AV_1 * T.UNIDAD_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_VP_2 
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  


		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING (
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				T1.NO_SOTANOS_1
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		UPDATE SET
			T.COSTO_DIRECTO_M2_CONSTRUCCION_AC_3_TOT_SOTANOS = SRC.NO_SOTANOS_1;

	   --E153	
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.TOTAL_VENTAS_AV_2 = 	
				T.VALOR_M2_COMERCIO_AV_2 + T.VALOR_M2_OFICINA_AV_2 + T.VALOR_M2_VIVIENDA_NO_VIS_VIP_AV_2 + 
				T.VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIS_150_SMMLV_AV_2 + T.VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIP_90_SMMLV_AV_2 +
				T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_AV_2 + T.VALOR_ESTACIONAMIENTO_CUBIERTO_COMERCIO_AV_2 +
				T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_AV_2 + T.VALOR_ESTACIONAMIENTO_CUBIERTO_OFICINAS_AV_2 +
				T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_AV_2 + T.VALOR_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_AV_2
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  


		--E153
		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING (
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				T1.OFERTAS_RESIDENCIAL
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		--TABLA TBL27
		UPDATE SET
		T.COSTO_DIRECTO_M2_CONSTRUCCION_AC_0 = 	
		CASE 
			WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' THEN NVL(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL27(T.NO_DE_PISOS, 'O-' || SRC.OFERTAS_RESIDENCIAL || '-' || T.COSTO_DIRECTO_M2_CONSTRUCCION_AC_3_TOT_SOTANOS, T.VIGENCIA), 0)	
			ELSE NVL(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL27(T.NO_DE_PISOS, SRC.OFERTAS_RESIDENCIAL || '-' || T.COSTO_DIRECTO_M2_CONSTRUCCION_AC_3_TOT_SOTANOS, T.VIGENCIA), 0)	
		END;

		--D155(0)
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.COSTO_DIRECTO_M2_CONSTRUCCION_AC_1 = 
		CASE
			WHEN (T.UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_2 + T.UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_2 + T.UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_2) > 1000 THEN
				CASE
					WHEN T.COSTO_DIRECTO_M2_CONSTRUCCION_AC_0 = 0 THEN -10
					ELSE T.COSTO_DIRECTO_M2_CONSTRUCCION_AC_0 * 0.9
				END
			ELSE
				CASE 
					WHEN T.COSTO_DIRECTO_M2_CONSTRUCCION_AC_0 = 0 THEN -10
					ELSE T.COSTO_DIRECTO_M2_CONSTRUCCION_AC_0
				END
		END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  



		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING (
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				T1.NO_ESTACIONAMIENTOS_SOTANO_FUERA_TIPOLOGIA_3,
				T1.AREA_CONSTRUIDA_DESTINADA_BICICLETAS_VEHICULOS_EMISIONES_CERO_DPP_2,
				T1.NO_SOTANOS_4,
				T1.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_1
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		UPDATE SET
		T.COSTO_DIRECTO_M2_PLACA_PARQUEADERO_PRIMER_NIVEL_AC_1 =	
			CASE 
				WHEN SRC.NO_ESTACIONAMIENTOS_SOTANO_FUERA_TIPOLOGIA_3 = 0 THEN
					CASE 
						WHEN SRC.AREA_CONSTRUIDA_DESTINADA_BICICLETAS_VEHICULOS_EMISIONES_CERO_DPP_2 = 0 THEN 0
						ELSE ROUND(NVL(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL27(900009, 'VIS-0', T.VIGENCIA), 0), 0)	
					END
				ELSE ROUND(NVL(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL27(900009, 'VIS-0', T.VIGENCIA), 0), 0)
			END,
		T.COSTO_DIRECTO_M2_EQUIPAMIENTO_COMUNAL_CONSTRUIDO_AC_1 = 
			CASE 
				WHEN SRC.NO_SOTANOS_4 = 0 THEN 0
				ELSE 0
			END,
		T.COSTO_DIRECTO_M2_SOTANO_FUERA_TIPOLOGIA_1_AC =
			CASE 
				WHEN SRC.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_1 = 0 THEN 0
				WHEN SRC.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_1 = 1 THEN ROUND(NVL(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL27(900001, 'VIS-0', T.VIGENCIA), 0), 0)
				ELSE ROUND(NVL(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL27(900002, 'VIS-0', T.VIGENCIA), 0), 0)
			END;


	--ANÁLISIS DE COSTOS DIRECTOS
	   --E155	
	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.COSTO_DIRECTO_M2_CONSTRUCCION_AC_2 = T.COSTO_DIRECTO_M2_CONSTRUCCION_AC_1 * T.AREA_TOTAL_CONSTRUIDA_SIN_SOTANOS_2,
	   T.COSTO_DIRECTO_M2_PLACA_PARQUEADERO_PRIMER_NIVEL_AC_2 = T.COSTO_DIRECTO_M2_PLACA_PARQUEADERO_PRIMER_NIVEL_AC_1 * T.AREA_ESTACIONAMIENTOS_PRIMER_PISO_DESCUBIERTOS_2,
	   T.COSTO_DIRECTO_M2_EQUIPAMIENTO_COMUNAL_CONSTRUIDO_AC_2 = T.COSTO_DIRECTO_M2_EQUIPAMIENTO_COMUNAL_CONSTRUIDO_AC_1 * 	(T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_2 + T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_RESIDENCIAL_VIP_VIS_2)
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING (
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				T1.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_2
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		UPDATE SET
			T.COSTO_DIRECTO_M2_SOTANO_FUERA_TIPOLOGIA_2_AC = T.COSTO_DIRECTO_M2_SOTANO_FUERA_TIPOLOGIA_1_AC * SRC.AREA_CONSTRUIDA_SOTANO_FUERA_TIPOLOGIA_2;

	   --E160	
	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_2 = T.COSTO_DIRECTO_M2_CONSTRUCCION_AC_2 + T.COSTO_DIRECTO_M2_PLACA_PARQUEADERO_PRIMER_NIVEL_AC_2 +
																	 T.COSTO_DIRECTO_M2_EQUIPAMIENTO_COMUNAL_CONSTRUIDO_AC_2 + T.COSTO_DIRECTO_M2_SOTANO_FUERA_TIPOLOGIA_2_AC
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

	   
	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS = T.AREA_TOTAL_CONSTRUIDA_SIN_SOTANOS_2 + T.AREA_SOTANO_CONSTRUIDA_INCLUIDA_TIPOLOGIA_2 + T.AREA_SOTANO_ADICIONAL_CONSTRUIR_2 --(Q399+Q400+Q401)
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  
	   
	   
	   --ANÁLISIS DE COSTOS INDIRECTOS
	   
	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.COSTO_DIRECTO_TOTAL_METRO_CUADRADO =  TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_2 / NULLIF(VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,0),
	   T.PRODUCTO_CALCULO_INMOBILIARIO = 
	   CASE 
			WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) = 'OFICINAS' THEN 'LOCAL'
			ELSE 'VIVIENDA'
	   END,		
	   T.IMPUESTO_DELINEACION_URBANA_CD_AREA_VIS_EXTENTA_1 = 3,
	   T.LICENCIA_CURADURIA_CARGO_FIJO_1 = 0,  
	   T.LICENCIA_CURADURIA_1 = 0,
	   T.GASTOS_NOTARIALES_REGISTRO_VENTAS_1 = 1,
	   T.HONORARIOS_CONSTRUCCION_CD_1 = 10,
	   T.HONORARIOS_GERENCIA_PROYECTO_VENTAS_1 = 2.5
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

	   
	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.PRODUCTO_CALCULO_INMOBILIARIO_1 = 
	   CASE 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO) = 'LOCAL' THEN '0'
			ELSE T.OFERTAS_RESIDENCIAL
	   END,
	   T.HONORARIOS_PROYECTO_ARQUITECTONICO_CD_2 =  
		(
			CASE 
				WHEN  (T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS) > 10000 THEN   (((T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS) - 10000) * T.COSTO_DIRECTO_TOTAL_METRO_CUADRADO * 0.03) + 
													(5000 * T.COSTO_DIRECTO_TOTAL_METRO_CUADRADO * 0.04) + 
													(4000 * T.COSTO_DIRECTO_TOTAL_METRO_CUADRADO * 0.05) + 
													(1000 * T.COSTO_DIRECTO_TOTAL_METRO_CUADRADO * 0.07)
				WHEN (T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS) > 5000 THEN     (((T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS) - 5000) * T.COSTO_DIRECTO_TOTAL_METRO_CUADRADO * 0.04) + 
													(4000 * T.COSTO_DIRECTO_TOTAL_METRO_CUADRADO * 0.05) + 
													(1000 * T.COSTO_DIRECTO_TOTAL_METRO_CUADRADO * 0.07)
				WHEN (T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS) > 1000 THEN     (((T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS) - 1000) * T.COSTO_DIRECTO_TOTAL_METRO_CUADRADO * 0.05) + 
													(1000 * T.COSTO_DIRECTO_TOTAL_METRO_CUADRADO * 0.07)
				ELSE 
					(T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS) * T.COSTO_DIRECTO_TOTAL_METRO_CUADRADO * 0.07
			END
		) *
		(
			CASE 
				WHEN UPPER(T.CATEGORIA_PROYECTO) = 'A' THEN 50 / 100
				WHEN UPPER(T.CATEGORIA_PROYECTO) = 'B' THEN 70 / 100
				WHEN UPPER(T.CATEGORIA_PROYECTO) = 'C' THEN 85 / 100
				ELSE 100 / 100 
			END
		)
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
		T.HONORARIOS_ESTUDIOS_DISENOS_TECNICOS_ING_DETALLE_CD_1 = 
		CASE
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO_1) IN ('VIP', 'VIS') THEN 0.04 * 100 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO_1) IN ('3', '4')     THEN 0.045 * 100 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO_1) IN (5, 6) OR UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO) = 'LOCAL' THEN 0.05 * 100
			ELSE 0
		END,
	   T.PRODUCTO_CALCULO_INMOBILIARIO_2 = 
	   CASE 
			WHEN UPPER(PRODUCTO_CALCULO_INMOBILIARIO_1) IN ('VIP', 'VIS') THEN '2'
			ELSE PRODUCTO_CALCULO_INMOBILIARIO_1
	   END
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

	--COSTO TOTAL LICENCIA	(G1)
	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.VIVIENDA_E_1_2_CURADURIA_2 = 
		CASE 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO) = 'VIVIENDA' THEN 
				CASE 
					WHEN T.PRODUCTO_CALCULO_INMOBILIARIO_2 <= '2' THEN 
						CASE 
							WHEN T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS > 11001 THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E1-2','',T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,1)--AG458 
							WHEN T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS > 101   THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E1-2','',T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,2)--AG451 
							ELSE 												   PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'E1-2','',0,3) 						     --AE444
						END
					ELSE 0
				END
			ELSE 0
		END,
		T.VIVIENDA_E_3_CURADURIA_2 = 
		CASE 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO) = 'VIVIENDA' THEN 
				CASE 
					WHEN T.PRODUCTO_CALCULO_INMOBILIARIO_2 = '3' THEN 
						CASE 
							WHEN T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS > 11001 THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E3','',T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,1) --AG459 
							WHEN T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS > 101   THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E3','',T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,2) --AG452 
							ELSE 					 								PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'E3','',0,3) 							 --AE445
						END
					ELSE 0
				END
			ELSE 0
		END,	
		T.VIVIENDA_E_4_CURADURIA_2 = 
		CASE 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO) = 'VIVIENDA' THEN 
				CASE 
					WHEN T.PRODUCTO_CALCULO_INMOBILIARIO_2 = '4' THEN 
						CASE 
							WHEN T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS > 11001 THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E4','',T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,1)  --AG460 
							WHEN T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS > 101   THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E4','',T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,2)  --AG453 
							ELSE               		 								PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'E4','',0,3)  							  --AE446
						END
					ELSE 0
				END
			ELSE 0
		END,
		T.VIVIENDA_E_5_CURADURIA_2 = 
		CASE 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO) = 'VIVIENDA' THEN 
				CASE 
					WHEN T.PRODUCTO_CALCULO_INMOBILIARIO_2 = '5' THEN 
						CASE 
							WHEN T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS > 11001 THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E5','',T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,1)  --AG461
							WHEN T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS > 101   THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E5','',T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,2)  --AG454
							ELSE             									   PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'E5','',0,3)  							 --AE447
						END
					ELSE 0
				END
			ELSE 0
		END,
		T.VIVIENDA_E_6_CURADURIA_2 = 
		CASE 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO) = 'VIVIENDA' THEN 
				CASE 
					WHEN T.PRODUCTO_CALCULO_INMOBILIARIO_2 = '6' THEN 
						CASE 
							WHEN T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS > 11001 THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E6','',T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,1)  --AG462 
							WHEN T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS > 101   THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E6','',T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,2)  --AG455 
							ELSE                                            	   PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'E6','',0,3)  							 --AE448
						END
					ELSE 0
				END
			ELSE 0
		END,
		T.OTROS_CURADURIA_2 =
		CASE 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO) = 'VIVIENDA' THEN 0
			ELSE 
				CASE 
					WHEN T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS 	>= 11001 THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E11','',T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,1) --AG473 
					WHEN T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS 	>= 1001  THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E10','',T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,2) --AG472
					WHEN T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS	>= 301   THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E9','',T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,2)  --AG471 
					WHEN T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS 	>= 101   THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E8','',T.VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,2)  --AG470 
					ELSE 												       PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'E7','',0,3)  							 --AE468	
				END
		END
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.TOTAL_CURADURIA_2 =  T.VIVIENDA_E_1_2_CURADURIA_2 + T.VIVIENDA_E_3_CURADURIA_2	+ 
							  T.VIVIENDA_E_4_CURADURIA_2   + T.VIVIENDA_E_5_CURADURIA_2 +
							  T.VIVIENDA_E_6_CURADURIA_2   + T.OTROS_CURADURIA_2	 
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


	--COSTO TOTAL LICENCIA	(G2)
	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.VIVIENDA_E_1_2_CURADURIA_3 = 
		CASE 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO) = 'VIVIENDA' THEN 
				CASE 
					WHEN T.PRODUCTO_CALCULO_INMOBILIARIO_2 <= '2' THEN 
						CASE 
							WHEN T.AREA_TERRENO_CALCULADA > 11001 THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E1-12','',T.AREA_TERRENO_CALCULADA,4) --AN458 
							WHEN T.AREA_TERRENO_CALCULADA > 101   THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E1-12','',T.AREA_TERRENO_CALCULADA,4) --AN451 
							ELSE 									   PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'E1-2','',0,3) 					--AE444
						END
					ELSE 0
				END
			ELSE 0
		END,
		T.VIVIENDA_E_3_CURADURIA_3 = 
		CASE 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO) = 'VIVIENDA' THEN 
				CASE 
					WHEN T.PRODUCTO_CALCULO_INMOBILIARIO_2 = '3' THEN 
						CASE 
							WHEN T.AREA_TERRENO_CALCULADA > 11001 THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E13','',T.AREA_TERRENO_CALCULADA,4) --AN459 
							WHEN T.AREA_TERRENO_CALCULADA > 101   THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E13','',T.AREA_TERRENO_CALCULADA,4) --AN452 
							ELSE 					 					PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'E3','',0,3)  				   --AE445
						END
					ELSE 0
				END
			ELSE 0
		END,	
		T.VIVIENDA_E_4_CURADURIA_3 = 
		CASE 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO) = 'VIVIENDA' THEN 
				CASE 
					WHEN T.PRODUCTO_CALCULO_INMOBILIARIO_2 = '4' THEN 
						CASE 
							WHEN T.AREA_TERRENO_CALCULADA > 11001 THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E14','',T.AREA_TERRENO_CALCULADA,4)  --AG460 
							WHEN T.AREA_TERRENO_CALCULADA > 101   THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E14','',T.AREA_TERRENO_CALCULADA,4)  --AG453 
							ELSE               		 					PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'E4','',0,3)   			    --AE446
						END
					ELSE 0
				END
			ELSE 0
		END,
		T.VIVIENDA_E_5_CURADURIA_3 = 
		CASE 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO) = 'VIVIENDA' THEN 
				CASE 
					WHEN T.PRODUCTO_CALCULO_INMOBILIARIO_2 = '5' THEN 
						CASE 
							WHEN T.AREA_TERRENO_CALCULADA > 11001 THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E15','',T.AREA_TERRENO_CALCULADA,4)   --AG461
							WHEN T.AREA_TERRENO_CALCULADA > 101   THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E15','',T.AREA_TERRENO_CALCULADA,4)   --AG454
							ELSE             						   PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'E5','',0,3)   				    --AE447
						END
					ELSE 0
				END
			ELSE 0
		END,
		T.VIVIENDA_E_6_CURADURIA_3 = 
		CASE 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO) = 'VIVIENDA' THEN 
				CASE 
					WHEN T.PRODUCTO_CALCULO_INMOBILIARIO_2 = '6' THEN 
						CASE 
							WHEN T.AREA_TERRENO_CALCULADA > 11001 THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E16','',T.AREA_TERRENO_CALCULADA,4)  --AG462 
							WHEN T.AREA_TERRENO_CALCULADA > 101   THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E16','',T.AREA_TERRENO_CALCULADA,4)  --AG455 
							ELSE                                       PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'E6','',0,3)  				   --AE448
						END
					ELSE 0
				END
			ELSE 0
		END,
		T.OTROS_CURADURIA_3 =
		CASE 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO) = 'VIVIENDA' THEN 0
			ELSE 
				CASE 
					WHEN T.AREA_TERRENO_CALCULADA 	>= 11001 THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E21','',T.AREA_TERRENO_CALCULADA,4) --AG473 
					WHEN T.AREA_TERRENO_CALCULADA 	>= 1001  THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E20','',T.AREA_TERRENO_CALCULADA,4) --AG472
					WHEN T.AREA_TERRENO_CALCULADA	>= 301   THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E19','',T.AREA_TERRENO_CALCULADA,4) --AG471 
					WHEN T.AREA_TERRENO_CALCULADA 	>= 101   THEN  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('',T.VIGENCIA,'E18','',T.AREA_TERRENO_CALCULADA,4) --AG470 
					ELSE 										   PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'E17','',0,3) 				  --AE468	
				END
		END
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.TOTAL_CURADURIA_3 =  T.VIVIENDA_E_1_2_CURADURIA_3 + T.VIVIENDA_E_3_CURADURIA_3	+ 
							  T.VIVIENDA_E_4_CURADURIA_3   + T.VIVIENDA_E_5_CURADURIA_3 +
							  T.VIVIENDA_E_6_CURADURIA_3   + T.OTROS_CURADURIA_3	 
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 
	  ---

	   --D160	
	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_1 = NVL(TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_2 / NULLIF(T.TOTAL_VENTAS_AV_2,0),0),
	   T.IMPUESTO_DELINEACION_URBANA_CD_AREA_VIS_EXTENTA_2 = 
	   CASE 
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) IN ('VIS', 'VIP') THEN (T.IMPUESTO_DELINEACION_URBANA_CD_AREA_VIS_EXTENTA_1 / 100) * (T.PORCENTAJE_DESTINACION_USO_COMERCIAL_CUMPLIMIENTO_2 * T.COSTO_DIRECTO_TOTAL_METRO_CUADRADO)
			ELSE (T.IMPUESTO_DELINEACION_URBANA_CD_AREA_VIS_EXTENTA_1 / 100) * T.TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_2
	   END,
	   T.LICENCIA_CURADURIA_CARGO_FIJO_2 = 
	   CASE 
			WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO) = 'VIVIENDA' THEN 
				CASE 
					WHEN T.PRODUCTO_CALCULO_INMOBILIARIO_2 <= '2'   THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'ER2','',0,3)  --AF430  
					WHEN T.PRODUCTO_CALCULO_INMOBILIARIO_2  = '3'   THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'ER3','',0,3)  --AF431
					WHEN T.PRODUCTO_CALCULO_INMOBILIARIO_2  = '4'   THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'ER4','',0,3)  --AF432
					WHEN T.OFERTAS_RESIDENCIAL  = '5'   			THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'ER5','',0,3)  --AF433
					ELSE 												 PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'ER6','',0,3)  --AF434
				END
			ELSE 
				CASE 
					WHEN (VALOR_AREA_TOTAL_COSTOS_INDIRECTOS) > 1000 THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'ER1000','',0,3) --AF437
					WHEN (VALOR_AREA_TOTAL_COSTOS_INDIRECTOS) > 301  THEN PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'ER301','',0,3)  --AF436
					ELSE 												  PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBLAB450('TOTAL_3',T.VIGENCIA,'ER300','',0,3)  --AF435
				END
		END,
		T.LICENCIA_CURADURIA_2 =  T.TOTAL_CURADURIA_2 + T.TOTAL_CURADURIA_3 , --232624182, --AF483
		T.GASTOS_NOTARIALES_REGISTRO_VENTAS_2 = T.TOTAL_VENTAS_AV_2 * (T.GASTOS_NOTARIALES_REGISTRO_VENTAS_1 / 100),
		T.HONORARIOS_CONSTRUCCION_CD_2 =  T.TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_2 * (T.HONORARIOS_CONSTRUCCION_CD_1 / 100),
		T.HONORARIOS_PROYECTO_ARQUITECTONICO_CD_1 = (T.HONORARIOS_PROYECTO_ARQUITECTONICO_CD_2 / NULLIF(T.TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_2,0)) * 100,
		T.HONORARIOS_GERENCIA_PROYECTO_VENTAS_2 = T.TOTAL_VENTAS_AV_2 * (T.HONORARIOS_GERENCIA_PROYECTO_VENTAS_1 / 100),
		T.HONORARIOS_ESTUDIOS_DISENOS_TECNICOS_ING_DETALLE_CD_2 = (T.HONORARIOS_ESTUDIOS_DISENOS_TECNICOS_ING_DETALLE_CD_1 / 100) * TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_2,
		T.PUNTOS_ADICIONALES_PA	=
		CASE 
		   WHEN UPPER(T.PRODUCTO_CALCULO_INMOBILIARIO_1) IN ('VIP', 'VIS') THEN 3 / 100
		   ELSE 5 / 100
		END * 100,
		T.DTF_ADICIONALES_PA = NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL28('DIRECTO',T.VIGENCIA,4), 0),0),
		T.TOTAL_PORCENTAJE_COSTOS_DIRECTOS_UNITARIOS = T.TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_2 * (60 / 100)
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.COSTOS_FINANCIEROS_DIRECTOS = (T.PUNTOS_ADICIONALES_PA + T.DTF_ADICIONALES_PA) 
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.COSTOS_DIRECTOS_FINANCIEROS = (T.COSTOS_FINANCIEROS_DIRECTOS / 100) * T.TOTAL_PORCENTAJE_COSTOS_DIRECTOS_UNITARIOS
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.COSTOS_DIRECTOS_FINANCIEROS_VENTAS = (COSTOS_DIRECTOS_FINANCIEROS / NULLIF(T.TOTAL_VENTAS_AV_2,0)) * 100,
	   T.COSTOS_FINANCIEROS_1 = (T.COSTOS_DIRECTOS_FINANCIEROS / NULLIF(T.TOTAL_VENTAS_AV_2,0)) * 100   
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.COSTOS_FINANCIEROS_2 = ((T.COSTOS_FINANCIEROS_1 /100) * T.TOTAL_VENTAS_AV_2),
	   T.VENTAS_COMISIONES_PUBLICIDAD_1 = 3,
	   T.VENTAS_COMISIONES_PUBLICIDAD_2 = (3 / 100) * T.TOTAL_VENTAS_AV_2,
	   T.COSTOS_URBANISMO_ANU_1 =
	   CASE 
			WHEN SUBSTR(T.ZHFG, 6, 1) = '1' THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL28('DIRECTO',T.VIGENCIA,1), 0),0) --149000
			WHEN SUBSTR(T.ZHFG, 6, 1) = '2' THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL28('DIRECTO',T.VIGENCIA,2), 0),0) --156450
			WHEN SUBSTR(T.ZHFG, 6, 1) = '3' THEN NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL28('DIRECTO',T.VIGENCIA,3), 0),0) --162410
			ELSE 0
	   END,
	   T.COSTOS_MITIGACION_1 = NVL(NULLIF(PAQUETE_ACTUALIZACION_PREDIOS.FUNC_OBTENER_VALOR_PISO_TBL28('DIRECTO',T.VIGENCIA,5), 0),0) --400000  
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


	   --E173 F1	
	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.COSTOS_MITIGACION_2 = 
	   CASE 
			WHEN T.AREA_LOTE_CONDICION_AMENAZA < T.AREA_NETA_URBANIZABLE_M2_2 THEN T.AREA_LOTE_CONDICION_AMENAZA * T.COSTOS_MITIGACION_1
			ELSE T.COSTOS_MITIGACION_1 * T.AREA_NETA_URBANIZABLE_M2_2
	   END
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.COSTOS_URBANISMO_ANU_2 = T.COSTOS_URBANISMO_ANU_1 * ( AREA_NETA_URBANIZABLE_M2_2 - CARGA_LOCAL_COMPENSAR_EN_DINERO_2 - EQUIPAMIENTO_COMUNAL_PUBLICO_2),
	   T.PAGO_DINERO_CARGA_VIP_1 = 	
	   CASE 
			WHEN UPPER(T.PRODUCTO_INMOBILIARIO_PRINCIPAL) <> 'VIVIENDA' THEN 'LO PAGA COMO CARGA'
			ELSE 
				CASE 
					WHEN UPPER(T.OFERTAS_RESIDENCIAL) IN('VIS','3') THEN 'CONSTRUYE VIP'
					ELSE 'LO PAGA COMO CARGA'
				END
	   END,
	   T.PAGO_DINERO_CARGA_GENERAL_PORC_ANU_2 = 0,
	   T.PAGO_DINERO_CARGA_LOCAL_PORC_ANU_1 =
	   CASE
			WHEN T.CARGA_LOCAL_COMPENSAR_EN_DINERO_2 = 0 THEN 0
			WHEN T.VALOR_CATASTRAL_TERRENO <= T.VTOPE_2024 THEN T.VALOR_CATASTRAL_TERRENO
			ELSE T.VTOPE_2024
	   END,   
	   T.PAGO_DINERO_ESTACIONAMIENTOS_ADICIONALES_1 =
	   CASE 
			WHEN UPPER(T.OFERTAS_RESIDENCIAL) IN('VIS') THEN 0
			ELSE 0
	   END   
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.PAGO_DINERO_CARGA_GENERAL_PORC_ANU_1 = 
		CASE 
			WHEN T.PAGO_DINERO_CARGA_GENERAL_PORC_ANU_2 = 0 THEN 0
			ELSE T.VTOPE_2024
		END,
		T.PAGO_DINERO_CARGA_LOCAL_PORC_ANU_2 = 
		CASE 
		WHEN T.FORMATO_TRABAJO IN ('F4','F5','F6') THEN
			CASE 
				WHEN T.PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO <> 0 THEN (T.PAGO_DINERO_CARGA_LOCAL_PORC_ANU_1 * T.CARGA_LOCAL_COMPENSAR_EN_DINERO_2 * 0.45) + (T.PAGO_DINERO_CARGA_LOCAL_PORC_ANU_1 * T.CARGA_LOCAL_ASOCIADA_PARQUES_2 * 0.064)
				ELSE T.PAGO_DINERO_CARGA_LOCAL_PORC_ANU_1 * T.CARGA_LOCAL_COMPENSAR_EN_DINERO_2
			END
		WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3') THEN T.PAGO_DINERO_CARGA_LOCAL_PORC_ANU_1 * T.CARGA_LOCAL_COMPENSAR_EN_DINERO_2
		END,
		T.PAGO_DINERO_CARGA_VIP_2 = 
		CASE 
		WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F5') THEN
			CASE
			WHEN T.PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO <> 0 THEN
					CASE
						WHEN UPPER(T.PAGO_DINERO_CARGA_VIP_1) = 'CONSTRUYE VIP' THEN 0
						ELSE T.SPD_1 * T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2 * 0.18
					END
			ELSE
					CASE
						WHEN UPPER(T.PAGO_DINERO_CARGA_VIP_1) = 'CONSTRUYE VIP' THEN 0
						ELSE T.SPD_1 * T.AREA_UTIL_PARA_CARGA_VIP_293_2
					END
			END
		WHEN T.FORMATO_TRABAJO IN ('F4','F6') THEN
		     T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1 * T.AREA_NETA_URBANIZABLE_M2_2
		END,	 
		T.COSTO_PROMEDIO_TOTAL_DESARROLLO_PARQUE_1 = 0,
		T.COSTO_PROMEDIO_TOTAL_DESARROLLO_PARQUE_2 = 
		CASE 
			WHEN UPPER(T.NOMBRE_AREA_ACTIVIDAD) = 'PROXIMIDAD' THEN 
				CASE 
					WHEN T.CARGA_LOCAL_COMPENSAR_EN_DINERO_2 <= 10000 THEN 387000 * T.CARGA_LOCAL_COMPENSAR_EN_DINERO_2
					ELSE 0
				END
				WHEN UPPER(T.NOMBRE_AREA_ACTIVIDAD) = 'ESTRUCTURANTE' THEN 
					CASE 
						WHEN T.CARGA_LOCAL_COMPENSAR_EN_DINERO_2 >= 10000 THEN 520000 * T.CARGA_LOCAL_COMPENSAR_EN_DINERO_2
						ELSE 0
						END
				ELSE 0
		END,
		T.PAGO_DINERO_ECP_PORC_ANU_1 =
		
		CASE 
			WHEN T.FORMATO_TRABAJO IN ('F1','F2_4B','F3','F6') THEN
				CASE
					WHEN T.VALOR_CATASTRAL_TERRENO <= T.VTOPE_2024 THEN T.VALOR_CATASTRAL_TERRENO
					ELSE T.VTOPE_2024
				END
			WHEN T.FORMATO_TRABAJO IN ('F4') THEN 0
			WHEN T.FORMATO_TRABAJO IN ('F5') THEN T.VTOPE_2024
		END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
		T.PAGO_DINERO_ECP_PORC_ANU_2 = 
		CASE 
			WHEN T.EQUIPAMIENTO_COMUNAL_PUBLICO_2 < 500 THEN T.PAGO_DINERO_ECP_PORC_ANU_1 * T.EQUIPAMIENTO_COMUNAL_PUBLICO_2
			ELSE 0
		END
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6')); 


		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING 
		(
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				NVL(T1.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_1, 0) AS AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_1,
				NVL(T1.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_2, 0) AS AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_2
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		UPDATE SET
		T.PAGO_DINERO_ESTACIONAMIENTOS_ADICIONALES_2 =
		CASE 
			WHEN (UPPER(T.OFERTAS_RESIDENCIAL) <> 'VIS' AND UPPER(T.OFERTAS_RESIDENCIAL) <> 'VIP') THEN 
				CASE 
					WHEN TRIM(TRANSLATE(UPPER(T.NOMBRE_AREA_ACTIVIDAD || ' - ' || T.ZONA_AREA_ACTIVIDAD), 'ÁÉÍÓÚáéíóú', 'AEIOUaeiou')) = 'ESTRUCTURANTE - RECEPTORA DE VIVIENDA DE INTERES SOCIAL' THEN (SRC.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_1 - 0.1) --/ 100
					WHEN TRIM(TRANSLATE(UPPER(T.NOMBRE_AREA_ACTIVIDAD || ' - ' || T.ZONA_AREA_ACTIVIDAD), 'ÁÉÍÓÚáéíóú', 'AEIOUaeiou')) = 'ESTRUCTURANTE - RECEPTORA DE ACTIVIDADES ECONOMICAS' THEN (SRC.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_1 - 0.15) --/ 100
					WHEN TRIM(TRANSLATE(UPPER(T.NOMBRE_AREA_ACTIVIDAD || ' - ' || T.ZONA_AREA_ACTIVIDAD), 'ÁÉÍÓÚáéíóú', 'AEIOUaeiou')) = 'PROXIMIDAD - GENERADORA DE SOPORTES URBANOS' THEN (SRC.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_1 - 0.15) --/ 100
					WHEN TRIM(TRANSLATE(UPPER(T.NOMBRE_AREA_ACTIVIDAD || ' - ' || T.ZONA_AREA_ACTIVIDAD), 'ÁÉÍÓÚáéíóú', 'AEIOUaeiou')) = 'PROXIMIDAD - RECEPTORA DE SOPORTES URBANOS' THEN (SRC.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_1 - 0.2) --/ 100
					WHEN TRIM(TRANSLATE(UPPER(T.NOMBRE_AREA_ACTIVIDAD || ' - ' || T.ZONA_AREA_ACTIVIDAD), 'ÁÉÍÓÚáéíóú', 'AEIOUaeiou')) = 'GRANDES SERVICIOS METROPOLITANOS - GRANDES SERVICIOS METROPOLITANOS' THEN (SRC.AREA_MINIMA_NUMERO_DE_ESTACIONAMIENTOS_VEHICULOS_1 - 0.2) --/ 100
					ELSE 0
				END * SRC.AREA_CONSTRUIDA_ESTACIONAMIENTOS_VEHICULOS_2 * T.VALOR_REFERENCIA
			ELSE 0
		END;


	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.TOTAL_COSTOS_INDIRECTOS_2 =    
	   T.IMPUESTO_DELINEACION_URBANA_CD_AREA_VIS_EXTENTA_2 + T.LICENCIA_CURADURIA_CARGO_FIJO_2 + T.LICENCIA_CURADURIA_2 +
	   T.GASTOS_NOTARIALES_REGISTRO_VENTAS_2 + T.HONORARIOS_CONSTRUCCION_CD_2 + T.HONORARIOS_PROYECTO_ARQUITECTONICO_CD_2 +
	   T.HONORARIOS_GERENCIA_PROYECTO_VENTAS_2 + T.HONORARIOS_ESTUDIOS_DISENOS_TECNICOS_ING_DETALLE_CD_2 + T.COSTOS_FINANCIEROS_2 +
	   T.VENTAS_COMISIONES_PUBLICIDAD_2 + T.COSTOS_URBANISMO_ANU_2 + T.COSTOS_MITIGACION_2 + T.PAGO_DINERO_CARGA_VIP_2 +
	   T.PAGO_DINERO_CARGA_GENERAL_PORC_ANU_2 + T.PAGO_DINERO_CARGA_LOCAL_PORC_ANU_2 + T.COSTO_PROMEDIO_TOTAL_DESARROLLO_PARQUE_2 +
	   T.PAGO_DINERO_ECP_PORC_ANU_2 + T.PAGO_DINERO_ESTACIONAMIENTOS_ADICIONALES_2 
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.TOTAL_COSTOS_2 = T.TOTAL_COSTOS_INDIRECTOS_2 + T.TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_2
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.RELACION_COSTOS_TOTALES_VENTAS_2 = T.TOTAL_COSTOS_2 / NULLIF(T.TOTAL_VENTAS_AV_2,0),
	   T.UTILIDAD_COMERCIO_1 =  
	   CASE 
		  WHEN T.AREA_VENDIBLE_COMERCIO_VP_2 = 0 THEN 0
		  ELSE 20
	   END,
	   UTILIDAD_OFICINA_1 = 
	   CASE 
		  WHEN T.AREA_VENDIBLE_OFICINA_VP_2 = 0 THEN 0
		  ELSE 18
	   END,
	   T.UTILIDAD_NO_VIS_VIP_1  = 
	   CASE 
		  WHEN UPPER(T.OFERTAS_RESIDENCIAL) = 'VIS' THEN 0
		  WHEN T.AREA_VENDIBLE_VIVIENDA_VP_2 = 0 THEN 0
		  WHEN T.OFERTAS_RESIDENCIAL = '3' THEN 12 --K193
		  WHEN T.OFERTAS_RESIDENCIAL = '4' THEN 14 --K194
		  WHEN T.OFERTAS_RESIDENCIAL = '5' THEN 16 --K195
		  WHEN T.OFERTAS_RESIDENCIAL = '6' THEN 18 --K196
		  ELSE 0
	   END,
	   T.UTILIDAD_VIS_1 = 
	   CASE 
		  WHEN T.VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIS_150_SMMLV_AV_2 = 0 THEN 0
		  ELSE 11
	   END,   
	   T.UTILIDAD_VIP_1 = 
	   CASE 
		  WHEN T.UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_2 = 0 THEN 0
		  ELSE 11
	   END
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T 
	   SET 
	   T.UTILIDAD_COMERCIO_2   =  (T.UTILIDAD_COMERCIO_1 / 100) * (T.VALOR_M2_COMERCIO_AV_2 + T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_AV_2 + T.VALOR_ESTACIONAMIENTO_CUBIERTO_COMERCIO_AV_2),
	   T.UTILIDAD_OFICINA_2    =  (T.UTILIDAD_OFICINA_1 / 100)  * (T.VALOR_M2_OFICINA_AV_2  + T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_AV_2 + T.VALOR_ESTACIONAMIENTO_CUBIERTO_OFICINAS_AV_2),
	   T.UTILIDAD_NO_VIS_VIP_2 =  (T.UTILIDAD_NO_VIS_VIP_1 / 100) * (T.VALOR_M2_VIVIENDA_NO_VIS_VIP_AV_2 + T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_AV_2 + T.VALOR_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_AV_2),
	   T.UTILIDAD_VIS_2 = (T.UTILIDAD_VIS_1 / 100) * T.VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIS_150_SMMLV_AV_2,
	   T.UTILIDAD_VIP_2 = (T.UTILIDAD_VIP_1 / 100) * T.VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIP_90_SMMLV_AV_2
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.TOTAL_UTILIDAD_2   =  T.UTILIDAD_COMERCIO_2 + T.UTILIDAD_OFICINA_2 +  T.UTILIDAD_NO_VIS_VIP_2 + T.UTILIDAD_VIS_2 + T.UTILIDAD_VIP_2
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.VALOR_LOTE_VL_2 =  T.TOTAL_VENTAS_AV_2 - (T.TOTAL_COSTOS_2 + T.TOTAL_UTILIDAD_2)
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.VALOR_LOTE_VL_1 = T.VALOR_LOTE_VL_2 / NULLIF(TOTAL_VENTAS_AV_2,0),
	   T.VALOR_LOTE_SIN_CONSTRUCCIONES_VL_2 = VALOR_LOTE_VL_2
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.VALOR_M2_LOTE_AREA_BRUTA_VL_2 = T.VALOR_LOTE_SIN_CONSTRUCCIONES_VL_2 /  NULLIF(T.AREA_TERRENO_CALCULADA,0),
	   T.VALOR_M2_LOTE_AREA_NETA_VL_2  = T.VALOR_LOTE_SIN_CONSTRUCCIONES_VL_2 /  NULLIF(T.AREA_NETA_URBANIZABLE_M2_2,0),
	   T.VALOR_M2_LOTE_AREA_UTIL_VL_2 = (T.VALOR_LOTE_SIN_CONSTRUCCIONES_VL_2) / NULLIF(T.AREA_UTIL_PARA_APLICAR_CARGA_VIP_2,0)
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.VALOR_M2_ADOPTADO_VL_2 = ROUND(VALOR_M2_LOTE_AREA_BRUTA_VL_2, -3),
	   T.VALOR_REFERENCIA_VIG_2024_VL_2 = T.VALOR_REFERENCIA
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));
	   
	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.VARIACION_VL_2 = ((T.VALOR_M2_ADOPTADO_VL_2 - T.VALOR_REFERENCIA_VIG_2024_VL_2) / NULLIF(T.VALOR_REFERENCIA_VIG_2024_VL_2,0) * 100)
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));

---COMPARACION GENOMETRIA

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.AISLAMIENTO_ENTRE_BLOQUES_CG_2 = 6,
       T.ALTURA_EDIFICACION = 4.2 + 2.3 * (T.NO_DE_PISOS - 1),	   
	   T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_3 = 4,
	   T.AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_3 = 9.20,
	   T.AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_3 = 9.20,
	   T.CONTROL_AMBIENTAL_CG_2 = 	
		CASE 
			WHEN AREA_UTIL_PARA_APLICAR_CARGA_VIP_2 > (1.3 * 10000) THEN 15
			ELSE 0
		END,
	   T.CONTROL_AMBIENTAL_CG_3 = 
		CASE 
            WHEN T.CONTROL_AMBIENTAL_154_2 <> 0 OR T.CONTROL_AMBIENTAL_CG_2 <> 0 THEN T.FRENTE_ANCHO
            ELSE 0
        END,		
       T.AREA_UTIL_CARGA_VIP_CG_1 = T.AREA_UTIL_PARA_APLICAR_CARGA_VIP_2		
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));

		--J388
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.AREA_ANTE_JARDIN_3 = T.DIMENSION_ANTEJARDIN
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

		--J380
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.AISLAMIENTO_LATERAL_CG_3 = 
		CASE 
			WHEN T.FORMATO_TRABAJO IN ('F4','F5','F6') THEN T.FONDO_ANCHO - T.AISLAMIENTO_POSTERIOR_1_3_ALTURA_EDIFICIO_2 - T.CONTROL_AMBIENTAL_CG_3 - T.AREA_ANTE_JARDIN_3
			ELSE 0
		END,
		T.AISLAMIENTO_LATERAL_CG_4 = 
		CASE
			WHEN T.FORMATO_TRABAJO IN ('F4','F5','F6') THEN T.AISLAMIENTO_LATERAL_DESDE_NIVEL_SUELO_MINIMO_2 * 2
			ELSE 0
		END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

		--H380
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.AISLAMIENTO_LATERAL_CG_1 = 
		CASE 
			WHEN T.FORMATO_TRABAJO IN ('F4','F5','F6') THEN T.AISLAMIENTO_LATERAL_CG_3 * T.AISLAMIENTO_LATERAL_CG_4
			ELSE 0
		END,
		T.AISLAMIENTO_LATERAL_CG_2 =
		CASE 
			WHEN T.FORMATO_TRABAJO IN ('F4','F5','F6') THEN T.ALTURA_EDIFICACION / 3
			WHEN T.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3') THEN T.ALTURA_EDIFICACION / 3
			ELSE 0
		END		
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  

	   
		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.CARGA_GENERAL_ARTICULO_285_CG_1 = T.CARGA_GENERAL_ARTICULO_285_2,
		T.CARGA_GENERAL_ARTICULO_285_CG_2 = T.FRENTE_ANCHO,
		T.CARGA_GENERAL_ARTICULO_285_CG_3 = T.FRENTE_ANCHO,
		T.CARGA_LOCAL_SUELO_CG_1 = T.TOTAL_CARGA_LOCAL_EN_SITIO_2,
		T.CARGA_LOCAL_SUELO_CG_2 = T.FRENTE_ANCHO,
		T.CARGA_LOCAL_SUELO_CG_3 = T.FRENTE_ANCHO,
		T.EQUIPAMIENTO_COMUNAL_PUBLICO_ANU_CG_1 = 
		CASE 
            WHEN T.EQUIPAMIENTO_COMUNAL_PUBLICO_2 > 500 THEN T.EQUIPAMIENTO_COMUNAL_PUBLICO_2
            ELSE 0
        END,
		T.AISLAMIENTO_ENTRE_BLOQUES_CG_3 = 
		CASE 
			WHEN T.AISLAMIENTO_ENTRE_BLOQUES_CG_2 = 0 THEN 0
			ELSE T.FRENTE_ANCHO
		END,
		T.AREA_AISLAMIENTO_POSTERIOR_CG_2 = 
		CASE 
			WHEN T.ALTURA_EDIFICACION / 3 < 4 THEN 4
			ELSE T.ALTURA_EDIFICACION / 3
		END,
		T.AREA_AISLAMIENTO_POSTERIOR_CG_3 = T.FRENTE_ANCHO
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  


		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.EQUIPAMIENTO_COMUNAL_PUBLICO_ANU_CG_3 = 
		CASE 
            WHEN T.EQUIPAMIENTO_COMUNAL_PUBLICO_ANU_CG_1 = 0 THEN 0
            ELSE T.FRENTE_ANCHO
        END
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  


		UPDATE TBL_TEMP_RESULTADO_PREDIOS T
		SET 
		T.EQUIPAMIENTO_COMUNAL_PUBLICO_ANU_CG_4 = NVL(T.EQUIPAMIENTO_COMUNAL_PUBLICO_ANU_CG_1 / NULLIF(T.EQUIPAMIENTO_COMUNAL_PUBLICO_ANU_CG_3,0),0)
		WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));  


		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING (
			SELECT 
				T1.CHIP,
				T1.ID_ORIGINAL,
				T1.FORMATO_TRABAJO,
				T1.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_DPP_2,
				T1.AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_DPP_2,
				T1.AREA_CONSTRUIDA_DESTINADA_BICICLETAS_VEHICULOS_EMISIONES_CERO_DPP_2
			FROM TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS T1
		) SRC
		ON (T.CHIP = SRC.CHIP AND T.ID_ORIGINAL = SRC.ID_ORIGINAL AND SRC.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'))
		WHEN MATCHED THEN
		UPDATE SET
			T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_1 = SRC.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_DPP_2,
			T.AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_1 = SRC.AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_DPP_2,
			T.AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_1 = SRC.AREA_CONSTRUIDA_DESTINADA_BICICLETAS_VEHICULOS_EMISIONES_CERO_DPP_2;
	   
	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.CARGA_GENERAL_ARTICULO_285_CG_4 = T.CARGA_GENERAL_ARTICULO_285_CG_1 /  NULLIF(T.CARGA_GENERAL_ARTICULO_285_CG_3,0),
	   T.CARGA_LOCAL_SUELO_CG_4 = T.CARGA_LOCAL_SUELO_CG_1 /  NULLIF(T.CARGA_LOCAL_SUELO_CG_3,0),
	   T.AISLAMIENTO_ENTRE_BLOQUES_CG_1 = 0,	
		-- CASE 
			-- WHEN  FLOOR(T.AN_LOTE_10_APTOS) < 2 THEN 0
			-- ELSE (FLOOR(T.AN_LOTE_10_APTOS) - 1) * T.AISLAMIENTO_ENTRE_BLOQUES_CG_3 * T.AISLAMIENTO_ENTRE_BLOQUES_CG_2
		-- END,
	   T.AREA_AISLAMIENTO_POSTERIOR_CG_1 = 
	   CASE
                    WHEN T.AREA_UTIL_PARA_APLICAR_CARGA_VIP_2 > 5000 THEN 0
                    ELSE T.AREA_AISLAMIENTO_POSTERIOR_CG_2 * T.AREA_AISLAMIENTO_POSTERIOR_CG_3
       END,
	   T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_4 = 	T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_1 / NULLIF(ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_3,0),
	   T.AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_4 = AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_1 / NULLIF(AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_3,0),
	   T.AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_4 = AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_1 / NULLIF(AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_3,0),
	   T.CONTROL_AMBIENTAL_CG_1 = 
		CASE 
			WHEN T.CONTROL_AMBIENTAL_CG_2 = 0 THEN T.CONTROL_AMBIENTAL_154_2
			ELSE (T.CONTROL_AMBIENTAL_CG_2 * T.CONTROL_AMBIENTAL_CG_3 + T.CONTROL_AMBIENTAL_154_2)
		END
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.AREA_AISLAMIENTO_POSTERIOR_CG_4 = T.AREA_AISLAMIENTO_POSTERIOR_CG_1 / NULLIF(T.AREA_AISLAMIENTO_POSTERIOR_CG_3,0), 	
	   T.CONTROL_AMBIENTAL_CG_4 = T.CONTROL_AMBIENTAL_CG_1 / NULLIF(T.CONTROL_AMBIENTAL_CG_3,0)
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));


	   --J388 K388 ANTE_JARDIN
	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.AREA_ANTE_JARDIN_4 =	
	   CASE 
           WHEN T.DIMENSION_ANTEJARDIN = 0 THEN 0
           ELSE T.FRENTE_ANCHO
       END
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));

	   --H388 ANTE_JARDIN
	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.AREA_ANTE_JARDIN_1 = T.AREA_ANTE_JARDIN_3 * AREA_ANTE_JARDIN_4
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.AREA_UTIL_CARGA_VIP_CG_4 = NVL(T.AREA_UTIL_CARGA_VIP_CG_1,0) - NVL(T.AREA_AISLAMIENTO_POSTERIOR_CG_1,0) - NVL(AISLAMIENTO_LATERAL_CG_1,0) - 
									NVL(T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_1,0) - NVL(T.AISLAMIENTO_ENTRE_BLOQUES_CG_1,0) - NVL(T.AREA_ANTE_JARDIN_1,0),
	   T.AISLAMIENTO_ENTRE_BLOQUES_CG_4 = NVL(AISLAMIENTO_ENTRE_BLOQUES_CG_1,0) / NULLIF(AISLAMIENTO_ENTRE_BLOQUES_CG_3,0)
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));
	   
	   
	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.AREA_CONSTRUIDA_MODULO_PLANTA_CG_4 = NVL(T.FONDO_ANCHO,0) - NVL(CARGA_GENERAL_ARTICULO_285_CG_4,0) - NVL(T.CARGA_LOCAL_SUELO_CG_4,0) - NVL(T.EQUIPAMIENTO_COMUNAL_PUBLICO_ANU_CG_4,0) - 
											  NVL(T.AREA_AISLAMIENTO_POSTERIOR_CG_4,0) - NVL(T.AISLAMIENTO_ENTRE_BLOQUES_CG_4,0) - NVL(T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_3,0) - 
											  NVL(T.AREA_ANTE_JARDIN_3,0) - NVL(T.CONTROL_AMBIENTAL_CG_4,0)
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));


	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.AREA_CONSTRUIDA_MODULO_PLANTA_CG_3 = NVL(T.AREA_UTIL_CARGA_VIP_CG_4,0) / NULLIF(AREA_CONSTRUIDA_MODULO_PLANTA_CG_4,0)
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));

	   UPDATE TBL_TEMP_RESULTADO_PREDIOS T
	   SET 
	   T.HUELLA_POR_GEOMETRIA_CG_4 = NVL(T.AREA_CONSTRUIDA_MODULO_PLANTA_CG_4,0) * NVL(T.AREA_CONSTRUIDA_MODULO_PLANTA_CG_3,0)
	   WHERE EXISTS (SELECT 1 FROM TBL_TEMP_RESULTADO_PREDIOS T2 WHERE T2.CHIP = T.CHIP AND T2.ID_ORIGINAL = T.ID_ORIGINAL AND T2.FORMATO_TRABAJO IN ('F1','F2_4A','F2_4B','F3','F4','F5','F6'));


		/*
		-- Actualizar el campo NUM_CONSECUTIVO con ROW_NUMBER() basado en CHIP
		MERGE INTO TBL_TEMP_RESULTADO_PREDIOS T
		USING 
		(
			-- Subconsulta para generar el número secuencial con ROW_NUMBER()
			SELECT ROWID AS RID, 
				   ROW_NUMBER() OVER (ORDER BY T.CHIP) AS RN
			FROM TBL_TEMP_RESULTADO_PREDIOS T
		) SRC
		ON (T.ROWID = SRC.RID)
		WHEN MATCHED THEN
			-- Actualizar la columna NUM_CONSECUTIVO con el valor de RN generado
			UPDATE SET T.NUM_CONSECUTIVO = SRC.RN;
	   */		

		DBMS_OUTPUT.PUT_LINE('FINALIZA SP_ACTUALIZAR_PREDIOS_2_1');

		COMMIT;
	END;

	PROCEDURE SP_ACTUALIZAR_PREDIOS_1 --NIVEL_0
	(
		p_chip IN VARCHAR2,
		p_validacion IN NUMBER,
		p_resultado OUT SYS_REFCURSOR  -- Usamos un cursor de referencia como salida
	) 
	IS
	v_count NUMBER;
	BEGIN
		DBMS_OUTPUT.PUT_LINE('============SP_ACTUALIZAR_PREDIOS_PRINCIPAL INICIO.============');			
				
		-- Truncar la tabla temporal
		EXECUTE IMMEDIATE 'TRUNCATE TABLE TBL_TEMP_RESULTADO_PREDIOS';
		EXECUTE IMMEDIATE 'TRUNCATE TABLE TBL_TEMP_RESULTADO_ANALISIS_GEOMETRIA_PREDIOS';

		-- Insertar datos en la tabla temporal
		INSERT INTO TBL_TEMP_RESULTADO_PREDIOS
		 SELECT
			ID,
			0 AS NUM_CONSECUTIVO,
			CHIP, NOMBRE_SECTOR_ACTUALIZAR_2025, CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO,
			CODIGO_CONSTRUCCION, CODIGO_RESTO, NOMBRE_LOCALIDAD, DIRECCION_REAL, ZHFG,
			NVL(VALOR_REFERENCIA,0), NVL(VALOR_COMERCIAL_TERRENO,0), NVL(VALOR_CATASTRAL_TERRENO,0), UPL_MAYOR_PARTICIPACION,
			NVL(AREA_TERRENO_CALCULADA,0), TRATAMIENTO_URBANISTICO, TIPOLOGIA_URBANISTICA,
			NVL(PARTICIPACION_AREA_TRATAMIENTO_URBANISTICO,0), NOMBRE_AREA_ACTIVIDAD, ZONA_AREA_ACTIVIDAD,
			NVL(DIMENSION_ANTEJARDIN,0), NVL(AREA_TOTAL_RESERVAS_URBANAS,0), NVL(AREA_LOTE_CONDICION_AMENAZA,0),
			NVL(AREA_TOTAL_AFECTACIONES,0), OFERTAS_RESIDENCIAL, PRODUCTO_INMOBILIARIO_PRINCIPAL,
			PRODUCTO_INMOBILIARIO_SECUNDARIO, CONTROL_AMBIENTAL, NVL(FRENTE_ANCHO,0), NVL(FONDO_ANCHO,0),
			REPLACE(REPLACE(RANGO_1_TRABAJAR,',00',''),'.00',''),NVL(AN_LOTE_10_APTOS,0), NVL(NO_DE_PISOS,0), NVL(ACTUACION_ESTRATEGICA,0),CATEGORIA_PROYECTO,
			NVL(ALTURA_PISOS,0),NVL(ES_MANZANA,0),NVL(ALTURA_PISOS_2,0),NVL(ANCHO_VIA,0),NVL(ENGLOBE_MINIMO_400,0),FORMATO_TRABAJO,VIGENCIA, 
			0 AS SPD_1, 0 AS SPD_2, 0 AS VTOPE_2024,                			0 AS PORCENTAJE_DESTINACION,
			0 AS RESERVAS_SISTEMAS_GENERALES, 			
			0 AS AREA_NETA_URBANIZABLE_M2_1,                        			0 AS AREA_NETA_URBANIZABLE_M2_2,
			0 AS CONTROL_AMBIENTAL_154_1,                           			0 AS CONTROL_AMBIENTAL_154_2, 
			0 AS AREA_NETA_URBANIZABLE_CALCULO_2,			
			0 AS SISTEMA_DE_CARGA_OBLIGACIONES_1,                   			0 AS SISTEMA_DE_CARGA_OBLIGACIONES_2,
			0 AS CARGA_GENERAL_ARTICULO_285_1,                      			0 AS CARGA_GENERAL_ARTICULO_285_2,
			0 AS CARGA_LOCAL_ASOCIADA_PARQUES_2,			
			0 AS CARGA_LOCAL_EN_SUELO_1,                            			0 AS CARGA_LOCAL_EN_SUELO_2,
			0 AS CARGA_LOCAL_COMPENSAR_EN_CONTROL_1,                			0 AS CARGA_LOCAL_COMPENSAR_EN_CONTROL_2,
			0 AS CARGA_LOCAL_COMPENSAR_EN_DINERO_1,                 			0 AS CARGA_LOCAL_COMPENSAR_EN_DINERO_2,       
			0 AS EQUIPAMIENTO_COMUNAL_PUBLICO_1,                    			0 AS EQUIPAMIENTO_COMUNAL_PUBLICO_2,
			0 AS TOTAL_CARGA_LOCAL_EN_SITIO_2,		
			0 AS AREA_UTIL_PARA_APLICAR_CARGA_VIP_1,                			0 AS AREA_UTIL_PARA_APLICAR_CARGA_VIP_2,      
			0 AS AREA_UTIL_PARA_CARGA_VIP_293_1,                    			0 AS AREA_UTIL_PARA_CARGA_VIP_293_2,
			0 AS AREA_UTIL_PARA_AISLAMIENTOS_1,                     			0 AS AREA_UTIL_PARA_AISLAMIENTOS_2,

			0 AS INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_1,              			0 AS INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2,
			0 AS N_PISOS_SOBRE_INDICE_MAXIMO_1,                     			0 AS N_PISOS_SOBRE_INDICE_MAXIMO_2,
			0 AS INDICE_OCUPACION_NORMA_AREA_OCUPACION_1,           			0 AS INDICE_OCUPACION_NORMA_AREA_OCUPACION_2,
			0 AS INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1,           			0 AS INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_2,
			0 AS PORCENTAJE_DESTINACION_USO_COMERCIAL_CUMPLIMIENTO_1,    		0 AS PORCENTAJE_DESTINACION_USO_COMERCIAL_CUMPLIMIENTO_2,	
			0 AS AREA_INDICE_DESTINADA_USO_RESIDENCIAL_OFICINAS_1,	     		0 AS AREA_INDICE_DESTINADA_USO_RESIDENCIAL_OFICINAS_2,	
			0 AS INDICE_MAXIMO_CONSTRUCCION_CONCRETADO_AREA_MAXIMA_1,    		0 AS INDICE_MAXIMO_CONSTRUCCION_CONCRETADO_AREA_MAXIMA_2, 
			0 AS NO_PISO_SOBRE_INDICE_MAXIMO_1,						     		0 AS NO_PISO_SOBRE_INDICE_MAXIMO_2,						
			0 AS PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1,			     		0 AS PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_2,			
			0 AS AISLAMIENTO_LATERAL_DESDE_NIVEL_SUELO_MINIMO_1,	     		0 AS AISLAMIENTO_LATERAL_DESDE_NIVEL_SUELO_MINIMO_2,	
			0 AS RETROCESO_SOBRE_VIA_1,											0 AS RETROCESO_SOBRE_VIA_2, 								
			0 AS AISLAMIENTO_POSTERIOR_1_3_ALTURA_EDIFICIO_1, 					0 AS AISLAMIENTO_POSTERIOR_1_3_ALTURA_EDIFICIO_2,
			0 AS OCUPACION_MAXIMA_CONTROL_AMBIENTAL_AISLAMIENTOS_1,				0 AS OCUPACION_MAXIMA_CONTROL_AMBIENTAL_AISLAMIENTOS_2, 	
			0 AS OCUPACION_MAXIMA_UTILIZAR_DISENO_1, 							0 AS OCUPACION_MAXIMA_UTILIZAR_DISENO_2, 					
			0 AS AREA_VOLADIZOS_1, 												0 AS AREA_VOLADIZOS_2, 									
			0 AS AREA_CONSTRUIDA_PISO_TIPO_1, 									0 AS AREA_CONSTRUIDA_PISO_TIPO_2, 						
			0 AS AREA_CONSTRUIDA_ANTES_CIRCULACIONES_EQUIPAMIENTO_1, 			0 AS AREA_CONSTRUIDA_ANTES_CIRCULACIONES_EQUIPAMIENTO_2, 		
			0 AS PUNTOS_FIJOS_PORC_AREA_TOTAL_CONSTRUIDA_1, 					0 AS PUNTOS_FIJOS_PORC_AREA_TOTAL_CONSTRUIDA_2, 			
			0 AS CIRCULACIONES_M2_PORC_AREA_TOTAL_CONSTRUIDA_1, 				0 AS CIRCULACIONES_M2_PORC_AREA_TOTAL_CONSTRUIDA_2, 		
			0 AS AREA_CONSTRUIDA_MENOS_PUNTOS_FIJOS_CIRCULACIONES_1, 			0 AS AREA_CONSTRUIDA_MENOS_PUNTOS_FIJOS_CIRCULACIONES_2, 	
			0 AS AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_1, 			0 AS AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2,

			0 AS AREA_VENDIBLE_COMERCIO_1,										0 AS AREA_VENDIBLE_COMERCIO_2,
			0 AS AREA_VENDIBLE_OFICINA_1,										0 AS AREA_VENDIBLE_OFICINA_2,
			0 AS AREA_VENDIBLE_VIVIENDA_1,										0 AS AREA_VENDIBLE_VIVIENDA_2,
			0 AS AREA_NO_VIP_NI_VIS_1,											0 AS AREA_NO_VIP_NI_VIS_2,
			0 AS AREA_VIS_1,													0 AS AREA_VIS_2,
			0 AS AREA_VIP_1,													0 AS AREA_VIP_2,
			0 AS NO_UNIDADES_NO_VIS_NI_VIP_GENERADAS_1,							0 AS NO_UNIDADES_NO_VIS_NI_VIP_GENERADAS_2,
			0 AS NO_UNIDADES_VIS_GENERADAS_1,									0 AS NO_UNIDADES_VIS_GENERADAS_2,
			0 AS NO_UNIDADES_GENERADAS_CUMPLIR_OBLIGACION_VIP_1,				0 AS NO_UNIDADES_GENERADAS_CUMPLIR_OBLIGACION_VIP_2,
			0 AS TOTAL_UNIDADES_VIVIENDA_GENERADAS_1,							0 AS TOTAL_UNIDADES_VIVIENDA_GENERADAS_2,

			0 AS EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_1,						0 AS EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_2,
			0 AS EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_CERO_1,				0 AS EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_CERO_2,
			0 AS SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_1,						0 AS SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_2,
			0 AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_1,						0 AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_2,
			0 AS EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_1,			0 AS EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_2,
			0 AS EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_NO_VIP_VIS_1,			0 AS EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_NO_VIP_VIS_2,
			0 AS SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_NO_VIP_VIS_1,			0 AS SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_NO_VIP_VIS_2,
			0 AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_NO_VIP_VIS_1,			0 AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_NO_VIP_VIS_2,
			0 AS EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_VIP_VIS_1,			0 AS EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_VIP_VIS_2,
			0 AS EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_VIS_1,		0 AS EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_VIS_2,
			0 AS SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_RESIDENCIAL_VIP_VIS_1,	0 AS SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_RESIDENCIAL_VIP_VIS_2,
			0 AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_RESIDENCIAL_VIP_VIS_1,	0 AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_RESIDENCIAL_VIP_VIS_2,
			0 AS TOTAL_EQUIPAMIENTO_CONSTRUIDO_1_PISO_1,						0 AS TOTAL_EQUIPAMIENTO_CONSTRUIDO_1_PISO_2,
			
			0 AS INDICE_DE_CONSTRUCCION_EFECTIVO_CONCRETADO_AREA_1, 			0 AS INDICE_DE_CONSTRUCCION_EFECTIVO_CONCRETADO_AREA_2,

			0 AS AREA_ESTACIONAMIENTOS_COMERCIO_1,								0 AS AREA_ESTACIONAMIENTOS_COMERCIO_2,
			0 AS AREA_ESTACIONAMIENTOS_OFICINAS_1,								0 AS AREA_ESTACIONAMIENTOS_OFICINAS_2,
			0 AS AREA_ESTACIONAMIENTOS_VIVIENDA_1,								0 AS AREA_ESTACIONAMIENTOS_VIVIENDA_2,
			0 AS AREA_DISPONIBLE_SOTANO_1,										0 AS AREA_DISPONIBLE_SOTANO_2,
			0 AS AREA_DISPONIBLE_PRIMER_PISO_DESCUBIERTO_1,						0 AS AREA_DISPONIBLE_PRIMER_PISO_DESCUBIERTO_2,
			0 AS AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_1,						0 AS AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_2,
			0 AS NUMERO_ESTACIONAMIENTOS_BICICLETAS_MICROMOVILIDAD_1,			0 AS NUMERO_ESTACIONAMIENTOS_BICICLETAS_MICROMOVILIDAD_2,
			0 AS AREA_ESTACIONAMIENTOS_BICICLETAS_MICROMOVILIDAD_1,				0 AS AREA_ESTACIONAMIENTOS_BICICLETAS_MICROMOVILIDAD_2,
			0 AS AREA_DISPONIBLE_SOTANO_DESC_BICICLETAS_1,						0 AS AREA_DISPONIBLE_SOTANO_DESC_BICICLETAS_2,
			0 AS AREA_DISPONIBLE_PRIMER_PISO_DESC_BICICLETAS_1,					0 AS AREA_DISPONIBLE_PRIMER_PISO_DESC_BICICLETAS_2,
			0 AS AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_DESC_BICICLETAS_1,		0 AS AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_DESC_BICICLETAS_2,
			0 AS NUMERO_ESTACIONAMIENTOS_DISPONIBLES_SOTANO_1,					0 AS NUMERO_ESTACIONAMIENTOS_DISPONIBLES_SOTANO_2,
			0 AS NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_DESCUBIERTO_1,	0 AS NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_DESCUBIERTO_2,
			0 AS NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_CUBIERTO_1,	0 AS NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_CUBIERTO_2,
			0 AS NUMERO_ESTACIONAMIENTOS_COMERCIO_1,							0 AS NUMERO_ESTACIONAMIENTOS_COMERCIO_2,
			0 AS NUMERO_ESTACIONAMIENTOS_OFICINAS_1,							0 AS NUMERO_ESTACIONAMIENTOS_OFICINAS_2,
			0 AS NUMERO_ESTACIONAMIENTOS_VIVIENDA_1,							0 AS NUMERO_ESTACIONAMIENTOS_VIVIENDA_2,
			0 AS CUPOS_PERSONAS_CON_DISCAPACIDAD_1,								0 AS CUPOS_PERSONAS_CON_DISCAPACIDAD_2,
			0 AS AREA_TOTAL_OCUPADA_SOTANOS_1,									0 AS AREA_TOTAL_OCUPADA_SOTANOS_2,

			0 AS AREA_TOTAL_CONSTRUIDA_SIN_SOTANOS_1,							0 AS AREA_TOTAL_CONSTRUIDA_SIN_SOTANOS_2,
			0 AS AREA_SOTANO_CONSTRUIDA_INCLUIDA_TIPOLOGIA_1,					0 AS AREA_SOTANO_CONSTRUIDA_INCLUIDA_TIPOLOGIA_2,
			0 AS AREA_SOTANO_ADICIONAL_CONSTRUIR_1,								0 AS AREA_SOTANO_ADICIONAL_CONSTRUIR_2,
			0 AS AREA_ESTACIONAMIENTOS_PRIMER_PISO_DESCUBIERTOS_1,				0 AS AREA_ESTACIONAMIENTOS_PRIMER_PISO_DESCUBIERTOS_2,

			0 AS AREA_VENDIBLE_COMERCIO_VP_1,  						      		0 AS AREA_VENDIBLE_COMERCIO_VP_2,
			0 AS UNIDADES_RESULTANTES_COMERCIO_VP_1,  						    0 AS UNIDADES_RESULTANTES_COMERCIO_VP_2,
			0 AS AREA_VENDIBLE_OFICINA_VP_1,  						      		0 AS AREA_VENDIBLE_OFICINA_VP_2,
			0 AS UNIDADES_RESULTANTES_OFICINAS_VP_1,  						    0 AS UNIDADES_RESULTANTES_OFICINAS_VP_2,
			0 AS AREA_VENDIBLE_VIVIENDA_VP_1,  						      		0 AS AREA_VENDIBLE_VIVIENDA_VP_2,
			0 AS UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_1,  						0 AS UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_2,
			0 AS UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_1,  						0 AS UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_2,
			0 AS UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_1,  						0 AS UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_2,
			0 AS UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_VP_1,  			0 AS UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_VP_2,
			0 AS UNIDAD_ESTACIONAMIENTO_CUBIERTO_COMERCIO_VP_1,  				0 AS UNIDAD_ESTACIONAMIENTO_CUBIERTO_COMERCIO_VP_2,
			0 AS UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_VP_1,  			0 AS UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_VP_2,
			0 AS UNIDAD_ESTACIONAMIENTO_CUBIERTO_OFICINAS_VP_1,  				0 AS UNIDAD_ESTACIONAMIENTO_CUBIERTO_OFICINAS_VP_2,
			0 AS UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_VP_1,  			0 AS UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_VP_2,
			0 AS UNIDAD_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_VP_1,  				0 AS UNIDAD_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_VP_2,
			
			0 AS VALOR_M2_COMERCIO_AV_1,										0 AS VALOR_M2_COMERCIO_AV_2,
			0 AS VALOR_M2_OFICINA_AV_1,											0 AS VALOR_M2_OFICINA_AV_2,
			0 AS VALOR_M2_VIVIENDA_NO_VIS_VIP_AV_1,								0 AS VALOR_M2_VIVIENDA_NO_VIS_VIP_AV_2,
			0 AS VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIS_150_SMMLV_AV_1,			0 AS VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIS_150_SMMLV_AV_2,
			0 AS VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIP_90_SMMLV_AV_1,			0 AS VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIP_90_SMMLV_AV_2,
			0 AS VALOR_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_AV_1,				0 AS VALOR_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_AV_2,
			0 AS VALOR_ESTACIONAMIENTO_CUBIERTO_COMERCIO_AV_1,					0 AS VALOR_ESTACIONAMIENTO_CUBIERTO_COMERCIO_AV_2,
			0 AS VALOR_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_AV_1,				0 AS VALOR_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_AV_2,
			0 AS VALOR_ESTACIONAMIENTO_CUBIERTO_OFICINAS_AV_1,					0 AS VALOR_ESTACIONAMIENTO_CUBIERTO_OFICINAS_AV_2,
			0 AS VALOR_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_AV_1,				0 AS VALOR_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_AV_2,
			0 AS VALOR_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_AV_1,					0 AS VALOR_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_AV_2,
			0 AS TOTAL_VENTAS_AV_1,												0 AS TOTAL_VENTAS_AV_2,

			0 AS COSTO_DIRECTO_M2_CONSTRUCCION_AC_0,
			0 AS COSTO_DIRECTO_M2_CONSTRUCCION_AC_1,							0 AS COSTO_DIRECTO_M2_CONSTRUCCION_AC_2,
			0 AS COSTO_DIRECTO_M2_CONSTRUCCION_AC_3_TOT_SOTANOS,
			0 AS COSTO_DIRECTO_M2_PLACA_PARQUEADERO_PRIMER_NIVEL_AC_1,			0 AS COSTO_DIRECTO_M2_PLACA_PARQUEADERO_PRIMER_NIVEL_AC_2,
			0 AS COSTO_DIRECTO_M2_EQUIPAMIENTO_COMUNAL_CONSTRUIDO_AC_1,			0 AS COSTO_DIRECTO_M2_EQUIPAMIENTO_COMUNAL_CONSTRUIDO_AC_2,
			0 AS COSTO_DIRECTO_M2_SOTANO_FUERA_TIPOLOGIA_1_AC,					0 AS COSTO_DIRECTO_M2_SOTANO_FUERA_TIPOLOGIA_2_AC,
			0 AS TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_1,		0 AS TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_2,

			0 AS COSTO_DIRECTO_TOTAL_METRO_CUADRADO,							'' AS PRODUCTO_CALCULO_INMOBILIARIO,	'' AS PRODUCTO_CALCULO_INMOBILIARIO_1,	
			'' AS PRODUCTO_CALCULO_INMOBILIARIO_2,
			0 AS VALOR_AREA_TOTAL_COSTOS_INDIRECTOS,
			0 AS COSTOS_FINANCIEROS_DIRECTOS,									0 AS PUNTOS_ADICIONALES_PA,				0 AS DTF_ADICIONALES_PA,	
			0 AS COSTOS_DIRECTOS_FINANCIEROS,									0 AS COSTOS_DIRECTOS_FINANCIEROS_VENTAS,
			0 AS COSTOS_DIRECTOS_UNITARIOS, 									0 AS TOTAL_COSTOS_DIRECTOS_UNITARIOS, 	0 AS TOTAL_PORCENTAJE_COSTOS_DIRECTOS_UNITARIOS,
			
			0 AS VIVIENDA_E_1_2_CURADURIA_2,									0 AS VIVIENDA_E_3_CURADURIA_2,		    0 AS VIVIENDA_E_4_CURADURIA_2,  
			0 AS VIVIENDA_E_5_CURADURIA_2,										0 AS VIVIENDA_E_6_CURADURIA_2,		    0 AS OTROS_CURADURIA_2,	
			0 AS TOTAL_CURADURIA_2,         
			
			0 AS VIVIENDA_E_1_2_CURADURIA_3,									0 AS VIVIENDA_E_3_CURADURIA_3,		    0 AS VIVIENDA_E_4_CURADURIA_3,  
			0 AS VIVIENDA_E_5_CURADURIA_3,										0 AS VIVIENDA_E_6_CURADURIA_3,		    0 AS OTROS_CURADURIA_3,	
			0 AS TOTAL_CURADURIA_3,         

			0 AS IMPUESTO_DELINEACION_URBANA_CD_AREA_VIS_EXTENTA_1, 			0 AS IMPUESTO_DELINEACION_URBANA_CD_AREA_VIS_EXTENTA_2,
			0 AS LICENCIA_CURADURIA_CARGO_FIJO_1,								0 AS LICENCIA_CURADURIA_CARGO_FIJO_2,
			0 AS LICENCIA_CURADURIA_1,											0 AS LICENCIA_CURADURIA_2,
			0 AS GASTOS_NOTARIALES_REGISTRO_VENTAS_1,							0 AS GASTOS_NOTARIALES_REGISTRO_VENTAS_2,
			0 AS HONORARIOS_CONSTRUCCION_CD_1,									0 AS HONORARIOS_CONSTRUCCION_CD_2,
			0 AS HONORARIOS_PROYECTO_ARQUITECTONICO_CD_1,						0 AS HONORARIOS_PROYECTO_ARQUITECTONICO_CD_2,
			0 AS HONORARIOS_GERENCIA_PROYECTO_VENTAS_1,							0 AS HONORARIOS_GERENCIA_PROYECTO_VENTAS_2,
			0 AS HONORARIOS_ESTUDIOS_DISENOS_TECNICOS_ING_DETALLE_CD_1,			0 AS HONORARIOS_ESTUDIOS_DISENOS_TECNICOS_ING_DETALLE_CD_2,
			0 AS COSTOS_FINANCIEROS_1,											0 AS COSTOS_FINANCIEROS_2,
			0 AS VENTAS_COMISIONES_PUBLICIDAD_1,								0 AS VENTAS_COMISIONES_PUBLICIDAD_2,
			0 AS COSTOS_URBANISMO_ANU_1,										0 AS COSTOS_URBANISMO_ANU_2,
			0 AS COSTOS_MITIGACION_1,											0 AS COSTOS_MITIGACION_2,

			0 AS PAGO_DINERO_CARGA_VIP_1,										0 AS PAGO_DINERO_CARGA_VIP_2,
			'' AS PAGO_DINERO_CARGA_GENERAL_PORC_ANU_1,							0 AS PAGO_DINERO_CARGA_GENERAL_PORC_ANU_2,
			0 AS PAGO_DINERO_CARGA_LOCAL_PORC_ANU_1,							0 AS PAGO_DINERO_CARGA_LOCAL_PORC_ANU_2,
			0 AS COSTO_PROMEDIO_TOTAL_DESARROLLO_PARQUE_1,						0 AS COSTO_PROMEDIO_TOTAL_DESARROLLO_PARQUE_2,
			0 AS PAGO_DINERO_ECP_PORC_ANU_1,									0 AS PAGO_DINERO_ECP_PORC_ANU_2,
			0 AS PAGO_DINERO_ESTACIONAMIENTOS_ADICIONALES_1,					0 AS PAGO_DINERO_ESTACIONAMIENTOS_ADICIONALES_2,
			0 AS TOTAL_COSTOS_INDIRECTOS_1,										0 AS TOTAL_COSTOS_INDIRECTOS_2,
			0 AS TOTAL_COSTOS_1,												0 AS TOTAL_COSTOS_2,

			0 AS RELACION_COSTOS_TOTALES_VENTAS_1,								0 AS RELACION_COSTOS_TOTALES_VENTAS_2,
			0 AS UTILIDAD_RELACION_COSTOS_1,									0 AS UTILIDAD_RELACION_COSTOS_2,
			0 AS UTILIDAD_COMERCIO_1,											0 AS UTILIDAD_COMERCIO_2,
			0 AS UTILIDAD_OFICINA_1,											0 AS UTILIDAD_OFICINA_2,
			0 AS UTILIDAD_NO_VIS_VIP_1,											0 AS UTILIDAD_NO_VIS_VIP_2,
			0 AS UTILIDAD_VIS_1,												0 AS UTILIDAD_VIS_2,
			0 AS UTILIDAD_VIP_1,												0 AS UTILIDAD_VIP_2,
			0 AS TOTAL_UTILIDAD_1,												0 AS TOTAL_UTILIDAD_2,

			0 AS VALOR_LOTE_VL_1,												0 AS VALOR_LOTE_VL_2,
			0 AS VALOR_LOTE_SIN_CONSTRUCCIONES_VL_1,							0 AS VALOR_LOTE_SIN_CONSTRUCCIONES_VL_2,
			0 AS VALOR_M2_LOTE_AREA_BRUTA_VL_1,									0 AS VALOR_M2_LOTE_AREA_BRUTA_VL_2,
			0 AS VALOR_M2_LOTE_AREA_NETA_VL_1,									0 AS VALOR_M2_LOTE_AREA_NETA_VL_2,
			0 AS VALOR_M2_LOTE_AREA_UTIL_VL_1,									0 AS VALOR_M2_LOTE_AREA_UTIL_VL_2,
			0 AS VALOR_M2_ADOPTADO_VL_1,										0 AS VALOR_M2_ADOPTADO_VL_2,
			0 AS VALOR_REFERENCIA_VIG_2024_VL_1,								0 AS VALOR_REFERENCIA_VIG_2024_VL_2,
			0 AS VARIACION_VL_1,												0 AS VARIACION_VL_2,
			
			0 AS ALTURA_EDIFICACION,												
			0 AS CARGA_GENERAL_ARTICULO_285_CG_1,								0 AS CARGA_GENERAL_ARTICULO_285_CG_2,
			0 AS CARGA_GENERAL_ARTICULO_285_CG_3,								0 AS CARGA_GENERAL_ARTICULO_285_CG_4,
			0 AS CARGA_LOCAL_SUELO_CG_1,										0 AS CARGA_LOCAL_SUELO_CG_2,
			0 AS CARGA_LOCAL_SUELO_CG_3,										0 AS CARGA_LOCAL_SUELO_CG_4,
			0 AS EQUIPAMIENTO_COMUNAL_PUBLICO_ANU_CG_1,							0 AS EQUIPAMIENTO_COMUNAL_PUBLICO_ANU_CG_2,
			0 AS EQUIPAMIENTO_COMUNAL_PUBLICO_ANU_CG_3,							0 AS EQUIPAMIENTO_COMUNAL_PUBLICO_ANU_CG_4,
			0 AS AISLAMIENTO_ENTRE_BLOQUES_CG_1,								0 AS AISLAMIENTO_ENTRE_BLOQUES_CG_2,
			0 AS AISLAMIENTO_ENTRE_BLOQUES_CG_3,								0 AS AISLAMIENTO_ENTRE_BLOQUES_CG_4,
			0 AS AREA_AISLAMIENTO_POSTERIOR_CG_1,								0 AS AREA_AISLAMIENTO_POSTERIOR_CG_2,
			0 AS AREA_AISLAMIENTO_POSTERIOR_CG_3,								0 AS AREA_AISLAMIENTO_POSTERIOR_CG_4,
			0 AS AISLAMIENTO_LATERAL_CG_1,										0 AS AISLAMIENTO_LATERAL_CG_2,
			0 AS AISLAMIENTO_LATERAL_CG_3,										0 AS AISLAMIENTO_LATERAL_CG_4,
			0 AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_1,					0 AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_2,
			0 AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_3,					0 AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_4,
			0 AS AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_1,			0 AS AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_2,
			0 AS AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_3,			0 AS AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_4,
			0 AS AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_1,				0 AS AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_2,
			0 AS AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_3,				0 AS AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_4,
			0 AS CONTROL_AMBIENTAL_CG_1,										0 AS CONTROL_AMBIENTAL_CG_2,
			0 AS CONTROL_AMBIENTAL_CG_3,										0 AS CONTROL_AMBIENTAL_CG_4,
			0 AS AREA_UTIL_CARGA_VIP_CG_1,										0 AS AREA_UTIL_CARGA_VIP_CG_2,
			0 AS AREA_UTIL_CARGA_VIP_CG_3,										0 AS AREA_UTIL_CARGA_VIP_CG_4,
			0 AS AREA_CONSTRUIDA_MODULO_PLANTA_CG_1,							0 AS AREA_CONSTRUIDA_MODULO_PLANTA_CG_2,
			0 AS AREA_CONSTRUIDA_MODULO_PLANTA_CG_3,							0 AS AREA_CONSTRUIDA_MODULO_PLANTA_CG_4,
			0 AS HUELLA_POR_GEOMETRIA_CG_1,										0 AS HUELLA_POR_GEOMETRIA_CG_2,
			0 AS HUELLA_POR_GEOMETRIA_CG_3,										0 AS HUELLA_POR_GEOMETRIA_CG_4,
			0 AS AREA_ANTE_JARDIN_1,											0 AS AREA_ANTE_JARDIN_2,
			0 AS AREA_ANTE_JARDIN_3,											0 AS AREA_ANTE_JARDIN_4,
			0 AS TBL_CONSOLIDACION_ALTURA_P_1,									0 AS TBL_CONSOLIDACION_ALTURA_P_2,
			0 AS TBL_CONSOLIDACION_MAXIMA_1,									0 AS TBL_CONSOLIDACION_ALTURA_PR_1,
			0 AS TBL_CONSOLIDACION_MAXIMA_2,									0 AS TBL_CONSOLIDACION_ALTURA_PR_2,
			0 AS TBL_CONSOLIDACION_ALTURA_PR_3,									0 AS TBL_CONSOLIDACION_ALTURA_PR_4			
	   FROM TBL_DATOS_URBANISTICOS
	   WHERE 1 = 1 AND (p_chip IS NULL OR p_chip = '' OR CHIP = p_chip);


		--INICIALIZA
			SP_ACTUALIZAR_PREDIOS_2;
			------SP_ACTUALIZAR_PREDIOS_2_1;
			SP_ACTUALIZAR_PREDIOS_GEOMETRIA_3(0);
		--ACTUALIZA
			------SP_ACTUALIZAR_PREDIOS_2;
			------SP_ACTUALIZAR_PREDIOS_GEOMETRIA_3(1);
		--TOTALIZA
			SP_ACTUALIZAR_PREDIOS_2;
			SP_ACTUALIZAR_PREDIOS_2_1;
		
		
		OPEN p_resultado FOR
		 SELECT 
		 --ROW_NUMBER() OVER (ORDER BY T.CHIP) AS NUM_CONSECUTIVO,
		  ROW_NUMBER() OVER (ORDER BY T.CHIP,T.NO_DE_PISOS,T.AN_LOTE_10_APTOS) AS NUM_CONSECUTIVO,
		  'UPL' || ' ' || T.UPL_MAYOR_PARTICIPACION AS UPL_MAYOR_PARTICIPACION_C6,
		  FORMATO_TRABAJO AS FORMATO_TRABAJO,
		  NO_DE_PISOS AS NO_DE_PISOS_H218,
		  AN_LOTE_10_APTOS AS AN_LOTE_10_APTOS_H217, 
		  T.TRATAMIENTO_URBANISTICO AS TRATAMIENTO_URBANISTICO_C7,
		  --EXTRACT(YEAR FROM SYSTIMESTAMP) AS ANIO_ACTUAL,--
		  T.VIGENCIA AS ANIO_ACTUAL,
		  T.NOMBRE_AREA_ACTIVIDAD AS NOMBRE_AREA_ACTIVIDAD_C8,
		  T.VALOR_REFERENCIA AS VREF_M2_E8,
		  T.SPD_1 AS SPD_1_F8,
		  T.VALOR_CATASTRAL_TERRENO AS VCATASTRAL_M2_E9,
		  T.SPD_2 AS SPD_2_F9,
		  T.VTOPE_2024 AS VTOPE_2024_E10,
		  T.ZONA_AREA_ACTIVIDAD AS ZONA_C11,
		  T.NOMBRE_SECTOR_ACTUALIZAR_2025 		|| ' ' || 
		  LPAD(T.CODIGO_BARRIO, 6, '0')   		|| ' ' ||
		  LPAD(T.CODIGO_MANZANA, 2, '0')  		|| ' ' ||
		  LPAD(T.CODIGO_PREDIO, 2, '0')   		|| ' ' ||
		  LPAD(T.CODIGO_CONSTRUCCION, 3, '0') 	|| ' ' || 
		  LPAD(T.CODIGO_RESTO, 5, '0')   AS CODIGO_SECTOR_C12,
		  T.DIRECCION_REAL AS DIRECCION_C13,
		  T.CHIP AS CHIP_C14,
	--INFORMACIÓN GENERAL 	
		  T.FRENTE_ANCHO AS FRENTE_ANCHO_E16,																												--(E16)
		  T.FONDO_ANCHO AS LINDERO_ORIENTAL_NORTE_E18,																										--(E18)
		  T.RANGO_1_TRABAJAR /** 1*/  AS RANGO_TRABAJAR_EDIFICALIDAD_E20,                                   												--(E20)
		  T.NOMBRE_LOCALIDAD AS LOCALIDAD_E21,                                                              												--(E21) 
		  T.OFERTAS_RESIDENCIAL /** 1*/ AS ESTRATO_PRODUCTO_E22,																							--(E22)
		  T.TIPOLOGIA_URBANISTICA AS TIPOLOGIA_URBANISTICA_E23,                                                                 							--(E23)
		  T.PRODUCTO_INMOBILIARIO_PRINCIPAL AS PRODUCTO_INMOBILIARIO_PRINCIPAL_E24,                                             							--(E24)
		  T.PRODUCTO_INMOBILIARIO_SECUNDARIO AS PRODUCTO_INMOBILIARIO_SECUNDARIO_E25,                                           							--(E25)
		  T.PORCENTAJE_DESTINACION AS PORCENTAJE_DESTINACION_E26,                                                               							--(E26)
		  T.DIMENSION_ANTEJARDIN AS ANTEJARDIN_E27,                                                         												--(E27)
		  T.CONTROL_AMBIENTAL AS CONTROL_AMBIENTAL_E28,                                                                         							--(E28)
	--ANÁLISIS de CARGAS URBANÍSTICAS Y CÁLCULOS DEL ÁREA ÚTIL						
		  NVL(T.AREA_TERRENO_CALCULADA,0) AS AREA_BRUTA_LOTE_E30,                                                  											--(E30)
		  NVL(T.RESERVAS_SISTEMAS_GENERALES,0) AS RESERVAS_SISTEMAS_GENERALES_E31,                                                     						--(E31)
		  NVL(T.AREA_TOTAL_RESERVAS_URBANAS,0) AS RESERVAS_MALLA_VIAL_E32,                                         											--(E32)
		  NVL(T.AREA_TOTAL_AFECTACIONES,0) AS AFECTACIONES_E34,                                                    											--(E34)
		  NVL(T.AREA_NETA_URBANIZABLE_M2_1,0) AS AREA_NETA_URBANIZABLE_M2_1_D35,        																	--(D35)
		  NVL(T.AREA_NETA_URBANIZABLE_M2_2,0) AS AREA_NETA_URBANIZABLE_M2_2_E35,       	        															--(E35)
		  NVL(T.AREA_NETA_URBANIZABLE_CALCULO_2,0) AS AREA_NETA_URBANIZABLE_CALCULO_2_E36,        				                        					--(E36)
		  NVL(T.SISTEMA_DE_CARGA_OBLIGACIONES_1,0) AS SISTEMA_DE_CARGA_OBLIGACIONES_1_D37,       															--(D37)
		  NVL(T.SISTEMA_DE_CARGA_OBLIGACIONES_2,0) AS SISTEMA_DE_CARGA_OBLIGACIONES_2_E37,  	    														--(E37)
		  NVL(T.CARGA_GENERAL_ARTICULO_285_1,0) AS CARGA_GENERAL_ARTICULO_285_1_D38,             															--(D38)
		  NVL(T.CARGA_GENERAL_ARTICULO_285_2,0) AS CARGA_GENERAL_ARTICULO_285_2_E38,     	    															--(E38)
		  NVL(T.CARGA_LOCAL_ASOCIADA_PARQUES_2,0) AS CARGA_LOCAL_ASOCIADA_PARQUES_2_E39,         				                        					--(E39)
		  NVL(T.CARGA_LOCAL_EN_SUELO_1,0) AS PORCENTAJE_CARGA_LOCAL_EN_SUELO_1_D40,																			--(D40)
		  NVL(T.CARGA_LOCAL_EN_SUELO_2,0) AS CARGA_LOCAL_EN_SUELO_2_E40,           	            															--(E40)              
		  NVL(T.CARGA_LOCAL_COMPENSAR_EN_CONTROL_1,0) AS PORCENTAJE_CARGA_LOCAL_COMPENSAR_EN_CONTROL_1_D41,	    											--(D41)
		  NVL(T.CARGA_LOCAL_COMPENSAR_EN_CONTROL_2,0) AS CARGA_LOCAL_COMPENSAR_EN_CONTROL_2_E41, 															--(E41)
		  NVL(T.CARGA_LOCAL_COMPENSAR_EN_DINERO_1,0) AS PORCENTAJE_CARGA_LOCAL_COMPENSAR_EN_DINERO_1_D42,	    											--(D42)  	
		  NVL(T.CARGA_LOCAL_COMPENSAR_EN_DINERO_2,0) AS CARGA_LOCAL_COMPENSAR_EN_DINERO_2_E42,  															--(E42)  
		  NVL(T.EQUIPAMIENTO_COMUNAL_PUBLICO_1,0) AS EQUIPAMIENTO_COMUNAL_PUBLICO_1_D43,         															--(D43)
		  NVL(T.EQUIPAMIENTO_COMUNAL_PUBLICO_2,0) AS EQUIPAMIENTO_COMUNAL_PUBLICO_2_E43,        															--(E43)    
		  NVL(T.TOTAL_CARGA_LOCAL_EN_SITIO_2,0) AS TOTAL_CARGA_LOCAL_EN_SITIO_2_E44,           				                        						--(E44)
		  NVL(T.CONTROL_AMBIENTAL_154_1,0) AS CONTROL_AMBIENTAL_154_1_D45,                																	--(D45)   
		  NVL(T.CONTROL_AMBIENTAL_154_2,0) AS CONTROL_AMBIENTAL_154_2_E45,                       															--(E45)           
		  NVL(T.AREA_UTIL_PARA_APLICAR_CARGA_VIP_1,0) AS AREA_UTIL_PARA_APLICAR_CARGA_VIP_1_D46,     														--(D46)  
		  NVL(T.AREA_UTIL_PARA_APLICAR_CARGA_VIP_2,0) AS AREA_UTIL_PARA_APLICAR_CARGA_VIP_2_E46, 															--(E46)  
		  NVL(T.AREA_UTIL_PARA_CARGA_VIP_293_1,0) AS AREA_UTIL_PARA_CARGA_VIP_293_1_D47,         															--(D47)  
		  NVL(T.AREA_UTIL_PARA_CARGA_VIP_293_2,0) AS AREA_UTIL_PARA_CARGA_VIP_293_2_E47,       																--(E47)  
		  NVL(T.AREA_UTIL_PARA_AISLAMIENTOS_1,0) AS AREA_UTIL_PARA_AISLAMIENTOS_1_D48,          															--(D48)    
		  NVL(T.AREA_UTIL_PARA_AISLAMIENTOS_2,0) AS AREA_UTIL_PARA_AISLAMIENTOS_2_E48,         																--(E48)    
	--ANÁLISIS DE OCUPACIÓN DEL SUELO						
		  NVL(T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_1,0) AS INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_1_D50,   														--(D50) 
		  NVL(T.INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2,0) AS INDICE_MAXIMO_SEGUN_RANGO_ASIGNADO_2_E50,														--(E50) 
		  NVL(T.N_PISOS_SOBRE_INDICE_MAXIMO_2,0) AS N_PISOS_SOBRE_INDICE_MAXIMO_2_E51,          				                        					--(E51) 
		  NVL(T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_1,0) AS INDICE_OCUPACION_NORMA_AREA_OCUPACION_1_D53,													--(D53) 
		  NVL(T.INDICE_OCUPACION_NORMA_AREA_OCUPACION_2,0) AS INDICE_OCUPACION_NORMA_AREA_OCUPACION_2_E53, 													--(E53) 
		  NVL(T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1,0) AS INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1_D54, 													--(D54)	
		  NVL(T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_2,0) AS INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_2_E54,        											--(E54)
		  NVL(T.PORCENTAJE_DESTINACION_USO_COMERCIAL_CUMPLIMIENTO_1,0) AS PORCENTAJE_DESTINACION_USO_COMERCIAL_CUMPLIMIENTO_1_D55, 							--(D55)	
		  NVL(T.PORCENTAJE_DESTINACION_USO_COMERCIAL_CUMPLIMIENTO_2,0) AS PORCENTAJE_DESTINACION_USO_COMERCIAL_CUMPLIMIENTO_2_E55, 							--(E55)	
		  NVL(T.AREA_INDICE_DESTINADA_USO_RESIDENCIAL_OFICINAS_2,0) AS AREA_INDICE_DESTINADA_USO_RESIDENCIAL_OFICINAS_2_E56,								--(E56)	
		  NVL(T.NO_PISO_SOBRE_INDICE_MAXIMO_2,0) AS NO_PISO_SOBRE_INDICE_MAXIMO_2_E58,																		--(E58)	
		  NVL(T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1,0) AS PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_1_D59, 												--(E59)		
		  NVL(T.PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_2,0) AS PISO_RESULTANTE_ALTURA_METROS_ALCANZADA_2_E59, 												--(E59)		  
		  NVL(T.AISLAMIENTO_LATERAL_DESDE_NIVEL_SUELO_MINIMO_1,0) AS AISLAMIENTO_LATERAL_DESDE_NIVEL_SUELO_MINIMO_1_D60,									--(E60)		  
		  NVL(T.AISLAMIENTO_LATERAL_DESDE_NIVEL_SUELO_MINIMO_2,0) AS AISLAMIENTO_LATERAL_DESDE_NIVEL_SUELO_MINIMO_2_E60,									--(E60)		  	  
		  NVL(T.RETROCESO_SOBRE_VIA_1,0)	AS RETROCESO_SOBRE_VIA_1_D61,					    															--(D61)		  	  	
		  NVL(T.AISLAMIENTO_POSTERIOR_1_3_ALTURA_EDIFICIO_1,0)	AS AISLAMIENTO_POSTERIOR_1_3_ALTURA_EDIFICIO_1_D62,					    					--(E62)		  	  	
		  NVL(T.AISLAMIENTO_POSTERIOR_1_3_ALTURA_EDIFICIO_2,0)	AS AISLAMIENTO_POSTERIOR_1_3_ALTURA_EDIFICIO_2_E62,					    					--(E62)		  	  		
		  NVL(T.OCUPACION_MAXIMA_CONTROL_AMBIENTAL_AISLAMIENTOS_1,0) AS OCUPACION_MAXIMA_CONTROL_AMBIENTAL_AISLAMIENTOS_1_D63,		    					--(E63)		  	  		
		  NVL(T.OCUPACION_MAXIMA_CONTROL_AMBIENTAL_AISLAMIENTOS_2,0) AS OCUPACION_MAXIMA_CONTROL_AMBIENTAL_AISLAMIENTOS_2_E63,	        					--(E63)		  	  		
		  NVL(T.OCUPACION_MAXIMA_UTILIZAR_DISENO_1,0) AS OCUPACION_MAXIMA_UTILIZAR_DISENO_1_D64,															--(E64)		  	  							
		  NVL(T.OCUPACION_MAXIMA_UTILIZAR_DISENO_2,0) AS OCUPACION_MAXIMA_UTILIZAR_DISENO_2_E64,															--(E64)		  	  		
		  NVL(T.AREA_VOLADIZOS_1,0) AS AREA_VOLADIZOS_1_D65,																								--(E65)				
		  NVL(T.AREA_VOLADIZOS_2,0) AS AREA_VOLADIZOS_1_E65,																								--(E65)	
		  NVL(T.AREA_CONSTRUIDA_PISO_TIPO_2,0) AS AREA_CONSTRUIDA_PISO_TIPO_2_E66,																			--(E66)	
		  NVL(T.AREA_CONSTRUIDA_ANTES_CIRCULACIONES_EQUIPAMIENTO_2,0) AS AREA_CONSTRUIDA_ANTES_CIRCULACIONES_EQUIPAMIENTO_2_E67,							--(E67)	
		  NVL(T.PUNTOS_FIJOS_PORC_AREA_TOTAL_CONSTRUIDA_1,0) AS PUNTOS_FIJOS_PORC_AREA_TOTAL_CONSTRUIDA_1_D68, 												--(E68)	
		  NVL(T.PUNTOS_FIJOS_PORC_AREA_TOTAL_CONSTRUIDA_2,0) AS PUNTOS_FIJOS_PORC_AREA_TOTAL_CONSTRUIDA_2_E68, 												--(E68)	
		  NVL(T.CIRCULACIONES_M2_PORC_AREA_TOTAL_CONSTRUIDA_1,0) AS CIRCULACIONES_M2_PORC_AREA_TOTAL_CONSTRUIDA_1_D69,										--(D69)
		  NVL(T.CIRCULACIONES_M2_PORC_AREA_TOTAL_CONSTRUIDA_2,0) AS CIRCULACIONES_M2_PORC_AREA_TOTAL_CONSTRUIDA_2_E69,										--(D69)	  
		  NVL(T.AREA_CONSTRUIDA_MENOS_PUNTOS_FIJOS_CIRCULACIONES_2,0) AS AREA_CONSTRUIDA_MENOS_PUNTOS_FIJOS_CIRCULACIONES_2_E70,							--(D70)	
		  NVL(T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_1,0) AS AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_1_D71,								--(E71)	
		  NVL(T.AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2,0) AS AREA_CONSTRUIDA_CUMPLIMIENTO_VIP_PROPORCION_ANU_2_E71,								--(D71)	
	--ÁREAS VENDIBLES
		  NVL(T.AREA_VENDIBLE_COMERCIO_2,0) AS AREA_VENDIBLE_COMERCIO_2_E73,																				--(E73)	
		  NVL(T.AREA_VENDIBLE_OFICINA_2,0) AS AREA_VENDIBLE_OFICINA_2_E74,																					--(E74)	
		  NVL(T.AREA_VENDIBLE_VIVIENDA_2,0) AS AREA_VENDIBLE_VIVIENDA_2_E75,																				--(E75)	
		  NVL(T.AREA_NO_VIP_NI_VIS_2,0) AS AREA_NO_VIP_NI_VIS_2_E76,																						--(E76)	
		  NVL(T.AREA_VIS_2,0) AS AREA_VIS_2_E77,																											--(E77)
		  NVL(T.AREA_VIP_2,0) AS AREA_VIP_2_E78,																											--(E78)
		  NVL(T.NO_UNIDADES_NO_VIS_NI_VIP_GENERADAS_2,0) AS NO_UNIDADES_NO_VIS_NI_VIP_GENERADAS_2_E79,														--(E79)
		  NVL(T.NO_UNIDADES_VIS_GENERADAS_2,0) AS NO_UNIDADES_VIS_GENERADAS_2_E80,																			--(E80)	
		  NVL(T.NO_UNIDADES_GENERADAS_CUMPLIR_OBLIGACION_VIP_2,0) AS NO_UNIDADES_GENERADAS_CUMPLIR_OBLIGACION_VIP_2_E81,									--(E81)	
		  NVL(T.TOTAL_UNIDADES_VIVIENDA_GENERADAS_2,0) AS TOTAL_UNIDADES_VIVIENDA_GENERADAS_2_E82,															--(E82)	
	--EQUIPAMIENTO COMUNAL PRIVADO (ECP)					
		  NVL(T.EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_1,0) AS EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_1_D84,													--(E84)	
		  NVL(T.EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_2,0) AS EQUIPAMIENTO_COMUNAL_EXIGIDO_COMERCIO_2_E84,													--(E84)	
		  NVL(T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_CERO_1,0) AS EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_CERO_1_D85,									--(E85)	
		  NVL(T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_CERO_2,0) AS EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_CERO_2_E85,									--(E85)	
		  NVL(T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_1,0) AS SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_1_D86,													--(E86)	
		  NVL(T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_2,0) AS SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_2_E86,													--(E86)		
		  NVL(T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_1,0) AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_1_D87,													--(E87)	
		  NVL(T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_2,0) AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_2_E87,													--(E87)
		  NVL(T.EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_1,0) AS EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_1_D88,						--(E88)
		  NVL(T.EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_2,0) AS EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_NO_VIP_VIS_2_E88,						--(E88)
		  NVL(T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_NO_VIP_VIS_1,0) AS EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_NO_VIP_VIS_1_D89,						--(E89)
		  NVL(T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_NO_VIP_VIS_2,0) AS EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_NO_VIP_VIS_2_E89,						--(E89)
		  NVL(T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_NO_VIP_VIS_1,0) AS SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_NO_VIP_VIS_1_D90,							--(E90)
		  NVL(T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_NO_VIP_VIS_2,0) AS SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_NO_VIP_VIS_2_E90,							--(E90)
		  NVL(T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_NO_VIP_VIS_1,0) AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_NO_VIP_VIS_1_D91,							--(E91)
		  NVL(T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_NO_VIP_VIS_2,0) AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_NO_VIP_VIS_2_E91,							--(E91)
		  NVL(T.EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_VIP_VIS_1,0) AS EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_VIP_VIS_1_D92,							--(E92)
		  NVL(T.EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_VIP_VIS_2,0) AS EQUIPAMIENTO_COMUNAL_EXIGIDO_RESIDENCIAL_VIP_VIS_2_E92,							--(E92)
		  NVL(T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_VIS_1,0) AS EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_VIS_1_D93,				--(E93)
		  NVL(T.EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_VIS_2,0) AS EQUIPAMIENTO_ESTACIONAMIENTOS_BICICLETAS_VEHICULOS_VIS_2_E93,				--(E93)
		  NVL(T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_RESIDENCIAL_VIP_VIS_1,0) AS SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_RESIDENCIAL_VIP_VIS_1_D94,			--(E94)
		  NVL(T.SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_RESIDENCIAL_VIP_VIS_2,0) AS SERVICIOS_COMUNALES_AREAS_CONSTRUIDAS_RESIDENCIAL_VIP_VIS_2_E94,			--(E94)
		  NVL(T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_RESIDENCIAL_VIP_VIS_1,0) AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_RESIDENCIAL_VIP_VIS_1_D95,			--(E95)
		  NVL(T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_RESIDENCIAL_VIP_VIS_2,0) AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_RESIDENCIAL_VIP_VIS_2_E95,			--(E95)
		  NVL(T.TOTAL_EQUIPAMIENTO_CONSTRUIDO_1_PISO_1,0) AS TOTAL_EQUIPAMIENTO_CONSTRUIDO_1_PISO_1_D96,													--(E96)	
		  NVL(T.TOTAL_EQUIPAMIENTO_CONSTRUIDO_1_PISO_2,0) AS TOTAL_EQUIPAMIENTO_CONSTRUIDO_1_PISO_2_E96,													--(E96)
		  NVL(T.INDICE_DE_CONSTRUCCION_EFECTIVO_CONCRETADO_AREA_1,0) AS INDICE_DE_CONSTRUCCION_EFECTIVO_CONCRETADO_AREA_1_D98, 								--(E98)
		  NVL(T.INDICE_DE_CONSTRUCCION_EFECTIVO_CONCRETADO_AREA_2,0) AS INDICE_DE_CONSTRUCCION_EFECTIVO_CONCRETADO_AREA_2_E98,								--(E98)	
	--VENTAS DEL PROYECTO
		  NVL(T.AREA_ESTACIONAMIENTOS_COMERCIO_1,0) AS AREA_ESTACIONAMIENTOS_COMERCIO_1_D101,																--(D101)											
		  NVL(T.AREA_ESTACIONAMIENTOS_COMERCIO_2,0) AS AREA_ESTACIONAMIENTOS_COMERCIO_2_E101,                                                               --(E101)
		  NVL(T.AREA_ESTACIONAMIENTOS_OFICINAS_1,0) AS AREA_ESTACIONAMIENTOS_OFICINAS_1_D102,                                                               --(D102)
		  NVL(T.AREA_ESTACIONAMIENTOS_OFICINAS_2,0) AS AREA_ESTACIONAMIENTOS_OFICINAS_2_E102,                                                               --(E102)
		  NVL(T.AREA_ESTACIONAMIENTOS_VIVIENDA_1,0) AS AREA_ESTACIONAMIENTOS_VIVIENDA_1_D103,                                                               --(D103)
		  NVL(T.AREA_ESTACIONAMIENTOS_VIVIENDA_2,0) AS AREA_ESTACIONAMIENTOS_VIVIENDA_2_E103,                                                               --(E103)
		  NVL(T.AREA_DISPONIBLE_SOTANO_1,0) AS AREA_DISPONIBLE_SOTANO_1_D104,                                                                               --(D104)
		  NVL(T.AREA_DISPONIBLE_SOTANO_2,0) AS AREA_DISPONIBLE_SOTANO_2_E104,                                                                               --(E104)
		  NVL(T.AREA_DISPONIBLE_PRIMER_PISO_DESCUBIERTO_1,0) AS AREA_DISPONIBLE_PRIMER_PISO_DESCUBIERTO_1_D105,                                             --(D105)
		  NVL(T.AREA_DISPONIBLE_PRIMER_PISO_DESCUBIERTO_2,0) AS AREA_DISPONIBLE_PRIMER_PISO_DESCUBIERTO_2_E105,                                             --(E105)
		  NVL(T.AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_1,0) AS AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_1_D106,                                                   --(D106)
		  NVL(T.AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_2,0) AS AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_2_E106,                                                   --(E106)
		  NVL(T.NUMERO_ESTACIONAMIENTOS_BICICLETAS_MICROMOVILIDAD_1,0) AS NUMERO_ESTACIONAMIENTOS_BICICLETAS_MICROMOVILIDAD_1_D107,                         --(D107)
		  NVL(T.NUMERO_ESTACIONAMIENTOS_BICICLETAS_MICROMOVILIDAD_2,0) AS NUMERO_ESTACIONAMIENTOS_BICICLETAS_MICROMOVILIDAD_2_E107,                         --(E107)
		  NVL(T.AREA_ESTACIONAMIENTOS_BICICLETAS_MICROMOVILIDAD_1,0) AS AREA_ESTACIONAMIENTOS_BICICLETAS_MICROMOVILIDAD_1_D108,                             --(D108)
		  NVL(T.AREA_ESTACIONAMIENTOS_BICICLETAS_MICROMOVILIDAD_2,0) AS AREA_ESTACIONAMIENTOS_BICICLETAS_MICROMOVILIDAD_2_E108,                             --(E108)
		  NVL(T.AREA_DISPONIBLE_SOTANO_DESC_BICICLETAS_1,0) AS AREA_DISPONIBLE_SOTANO_DESC_BICICLETAS_1_D109,                                               --(D109)
		  NVL(T.AREA_DISPONIBLE_SOTANO_DESC_BICICLETAS_2,0) AS AREA_DISPONIBLE_SOTANO_DESC_BICICLETAS_2_E109,                                               --(E109)
		  NVL(T.AREA_DISPONIBLE_PRIMER_PISO_DESC_BICICLETAS_1,0) AS AREA_DISPONIBLE_PRIMER_PISO_DESC_BICICLETAS_1_D110,                                     --(D110)
		  NVL(T.AREA_DISPONIBLE_PRIMER_PISO_DESC_BICICLETAS_2,0) AS AREA_DISPONIBLE_PRIMER_PISO_DESC_BICICLETAS_2_E110,                                     --(E110)
		  NVL(T.AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_DESC_BICICLETAS_1,0) AS AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_DESC_BICICLETAS_1_D111,                   --(D111)
		  NVL(T.AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_DESC_BICICLETAS_2,0) AS AREA_DISPONIBLE_PRIMER_PISO_CUBIERTO_DESC_BICICLETAS_2_E111,                   --(E111)
		  NVL(T.NUMERO_ESTACIONAMIENTOS_DISPONIBLES_SOTANO_1,0) AS NUMERO_ESTACIONAMIENTOS_DISPONIBLES_SOTANO_1_D112,                                       --(D112)
		  NVL(T.NUMERO_ESTACIONAMIENTOS_DISPONIBLES_SOTANO_2,0) AS NUMERO_ESTACIONAMIENTOS_DISPONIBLES_SOTANO_2_E112,                                       --(E112)
		  NVL(T.NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_DESCUBIERTO_1,0) AS NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_DESCUBIERTO_1_D113,     --(D113)
		  NVL(T.NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_DESCUBIERTO_2,0) AS NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_DESCUBIERTO_2_E113,     --(E113)
		  NVL(T.NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_CUBIERTO_1,0) AS NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_CUBIERTO_1_D114,           --(D114)
		  NVL(T.NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_CUBIERTO_2,0) AS NUMERO_ESTACIONAMIENTOS_DISPONIBLES_PRIMER_PISO_CUBIERTO_2_E114,           --(E114)
		  NVL(T.NUMERO_ESTACIONAMIENTOS_COMERCIO_1,0) AS NUMERO_ESTACIONAMIENTOS_COMERCIO_1_D115,                                                           --(D115)
		  NVL(T.NUMERO_ESTACIONAMIENTOS_COMERCIO_2,0) AS NUMERO_ESTACIONAMIENTOS_COMERCIO_2_E115,                                                           --(E115)
		  NVL(T.NUMERO_ESTACIONAMIENTOS_OFICINAS_1,0) AS NUMERO_ESTACIONAMIENTOS_OFICINAS_1_D116,                                                           --(D116)
		  NVL(T.NUMERO_ESTACIONAMIENTOS_OFICINAS_2,0) AS NUMERO_ESTACIONAMIENTOS_OFICINAS_2_E116,                                                           --(E116)
		  NVL(T.NUMERO_ESTACIONAMIENTOS_VIVIENDA_1,0) AS NUMERO_ESTACIONAMIENTOS_VIVIENDA_1_D117,                                                           --(D117)
		  NVL(T.NUMERO_ESTACIONAMIENTOS_VIVIENDA_2,0) AS NUMERO_ESTACIONAMIENTOS_VIVIENDA_2_E117,                                                           --(E117)
		  NVL(T.CUPOS_PERSONAS_CON_DISCAPACIDAD_1,0) AS CUPOS_PERSONAS_CON_DISCAPACIDAD_1_D118,                                                             --(D118)
		  NVL(T.CUPOS_PERSONAS_CON_DISCAPACIDAD_2,0) AS CUPOS_PERSONAS_CON_DISCAPACIDAD_2_E118,                                                             --(E118)
		  NVL(T.AREA_TOTAL_OCUPADA_SOTANOS_1,0) AS AREA_TOTAL_OCUPADA_SOTANOS_1_D119,                                                                       --(D119)
		  NVL(T.AREA_TOTAL_OCUPADA_SOTANOS_2,0) AS AREA_TOTAL_OCUPADA_SOTANOS_2_E119,                                                                       --(E119)
		  NVL(T.AREA_TOTAL_CONSTRUIDA_SIN_SOTANOS_1, 0) AS AREA_TOTAL_CONSTRUIDA_SIN_SOTANOS_1_D122,														--(D122)
		  NVL(T.AREA_TOTAL_CONSTRUIDA_SIN_SOTANOS_2, 0) AS AREA_TOTAL_CONSTRUIDA_SIN_SOTANOS_2_E122,                                                        --(E122)
		  NVL(T.AREA_SOTANO_CONSTRUIDA_INCLUIDA_TIPOLOGIA_1, 0) AS AREA_SOTANO_CONSTRUIDA_INCLUIDA_TIPOLOGIA_1_D123,										--(D123)
		  NVL(T.AREA_SOTANO_CONSTRUIDA_INCLUIDA_TIPOLOGIA_2, 0) AS AREA_SOTANO_CONSTRUIDA_INCLUIDA_TIPOLOGIA_2_E123,                                        --(E123)
		  NVL(T.AREA_SOTANO_ADICIONAL_CONSTRUIR_1, 0) AS AREA_SOTANO_ADICIONAL_CONSTRUIR_1_D124,															--(D124)
		  NVL(T.AREA_SOTANO_ADICIONAL_CONSTRUIR_2, 0) AS AREA_SOTANO_ADICIONAL_CONSTRUIR_2_E124,                                                            --(E124)
		  NVL(T.AREA_ESTACIONAMIENTOS_PRIMER_PISO_DESCUBIERTOS_1, 0) AS AREA_ESTACIONAMIENTOS_PRIMER_PISO_DESCUBIERTOS_1_D125,								--(D125)
		  NVL(T.AREA_ESTACIONAMIENTOS_PRIMER_PISO_DESCUBIERTOS_2, 0) AS AREA_ESTACIONAMIENTOS_PRIMER_PISO_DESCUBIERTOS_2_E125,                              --(E125)
	--VENTAS DEL PROYECTO
		  NVL(T.AREA_VENDIBLE_COMERCIO_VP_1, 0) AS AREA_VENDIBLE_COMERCIO_VP_1_D127,																		--(D127)
		  NVL(T.AREA_VENDIBLE_COMERCIO_VP_2, 0) AS AREA_VENDIBLE_COMERCIO_VP_2_E127,                                                                        --(E127)
		  NVL(T.UNIDADES_RESULTANTES_COMERCIO_VP_1, 0) AS UNIDADES_RESULTANTES_COMERCIO_VP_1_D128,                                                          --(D128)
		  NVL(T.UNIDADES_RESULTANTES_COMERCIO_VP_2, 0) AS UNIDADES_RESULTANTES_COMERCIO_VP_2_E128,                                                          --(E128)
		  NVL(T.AREA_VENDIBLE_OFICINA_VP_1, 0) AS AREA_VENDIBLE_OFICINA_VP_1_D129,                                                                          --(D129)
		  NVL(T.AREA_VENDIBLE_OFICINA_VP_2, 0) AS AREA_VENDIBLE_OFICINA_VP_2_E129,                                                                          --(E129)
		  NVL(T.UNIDADES_RESULTANTES_OFICINAS_VP_1, 0) AS UNIDADES_RESULTANTES_OFICINAS_VP_1_D130,                                                          --(D130)
		  NVL(T.UNIDADES_RESULTANTES_OFICINAS_VP_2, 0) AS UNIDADES_RESULTANTES_OFICINAS_VP_2_E130,                                                          --(E130)
		  NVL(T.AREA_VENDIBLE_VIVIENDA_VP_1, 0) AS AREA_VENDIBLE_VIVIENDA_VP_1_D131,                                                                        --(D131)
		  NVL(T.AREA_VENDIBLE_VIVIENDA_VP_2, 0) AS AREA_VENDIBLE_VIVIENDA_VP_2_E131,                                                                        --(E131)
		  NVL(T.UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_1, 0) AS UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_1_D132,                                                    --(D132)
		  NVL(T.UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_2, 0) AS UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_2_E132,                                                    --(E132)
		  NVL(T.UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_1, 0) AS UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_1_D133,                                                    --(D133)
		  NVL(T.UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_2, 0) AS UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_2_E133,                                                    --(E133)
		  NVL(T.UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_1, 0) AS UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_1_D134,                                                      --(D134)
		  NVL(T.UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_2, 0) AS UNIDADES_VENDIBLES_VIP_90_SMMLV_VP_2_E134,                                                      --(E134)
		  NVL(T.UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_VP_1, 0) AS UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_VP_1_D135,                              --(D135)
		  NVL(T.UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_VP_2, 0) AS UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_VP_2_E135,                              --(E135)
		  NVL(T.UNIDAD_ESTACIONAMIENTO_CUBIERTO_COMERCIO_VP_1, 0) AS UNIDAD_ESTACIONAMIENTO_CUBIERTO_COMERCIO_VP_1_D136,                                    --(D136)
		  NVL(T.UNIDAD_ESTACIONAMIENTO_CUBIERTO_COMERCIO_VP_2, 0) AS UNIDAD_ESTACIONAMIENTO_CUBIERTO_COMERCIO_VP_2_E136,                                    --(E136)
		  NVL(T.UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_VP_1, 0) AS UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_VP_1_D137,                              --(D137)
		  NVL(T.UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_VP_2, 0) AS UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_VP_2_E137,                              --(E137)
		  NVL(T.UNIDAD_ESTACIONAMIENTO_CUBIERTO_OFICINAS_VP_1, 0) AS UNIDAD_ESTACIONAMIENTO_CUBIERTO_OFICINAS_VP_1_D138,                                    --(D138)
		  NVL(T.UNIDAD_ESTACIONAMIENTO_CUBIERTO_OFICINAS_VP_2, 0) AS UNIDAD_ESTACIONAMIENTO_CUBIERTO_OFICINAS_VP_2_E138,                                    --(E138)
		  NVL(T.UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_VP_1, 0) AS UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_VP_1_D139,                              --(D139)
		  NVL(T.UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_VP_2, 0) AS UNIDAD_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_VP_2_E139,                              --(E139)
		  NVL(T.UNIDAD_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_VP_1, 0) AS UNIDAD_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_VP_1_D140,                                    --(D140)
		  NVL(T.UNIDAD_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_VP_2, 0) AS UNIDAD_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_VP_2_E140,                                    --(E140)
	--ANÁLISIS DE VENTAS	  
		  NVL(T.VALOR_M2_COMERCIO_AV_1, 0) AS VALOR_M2_COMERCIO_AV_1_D142,																					--(D142)
		  NVL(T.VALOR_M2_COMERCIO_AV_2, 0) AS VALOR_M2_COMERCIO_AV_2_E142,																					--(E142)	
		  NVL(T.VALOR_M2_OFICINA_AV_1, 0) AS VALOR_M2_OFICINA_AV_1_D143,																					--(D143)
		  NVL(T.VALOR_M2_OFICINA_AV_2, 0) AS VALOR_M2_OFICINA_AV_2_E143,                                                                                    --(E143)
		  NVL(T.VALOR_M2_VIVIENDA_NO_VIS_VIP_AV_1, 0) AS VALOR_M2_VIVIENDA_NO_VIS_VIP_AV_1_D144,                                                            --(D144)
		  NVL(T.VALOR_M2_VIVIENDA_NO_VIS_VIP_AV_2, 0) AS VALOR_M2_VIVIENDA_NO_VIS_VIP_AV_2_E144,                                                            --(E144)
		  NVL(T.VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIS_150_SMMLV_AV_1, 0) AS VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIS_150_SMMLV_AV_1_D145,                      --(D145)
		  NVL(T.VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIS_150_SMMLV_AV_2, 0) AS VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIS_150_SMMLV_AV_2_E145,                      --(E145)
		  NVL(T.VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIP_90_SMMLV_AV_1, 0) AS VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIP_90_SMMLV_AV_1_D146,                        --(D146)
		  NVL(T.VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIP_90_SMMLV_AV_2, 0) AS VALOR_VIVIENDA_UNIDADES_VENDIBLES_VIP_90_SMMLV_AV_2_E146,                        --(E146)
		  NVL(T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_AV_1, 0) AS VALOR_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_AV_1_D147,                                --(D147)
		  NVL(T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_AV_2, 0) AS VALOR_ESTACIONAMIENTO_DESCUBIERTO_COMERCIO_AV_2_E147,                                --(E147)
		  NVL(T.VALOR_ESTACIONAMIENTO_CUBIERTO_COMERCIO_AV_1, 0) AS VALOR_ESTACIONAMIENTO_CUBIERTO_COMERCIO_AV_1_D148,                                      --(D148)
		  NVL(T.VALOR_ESTACIONAMIENTO_CUBIERTO_COMERCIO_AV_2, 0) AS VALOR_ESTACIONAMIENTO_CUBIERTO_COMERCIO_AV_2_E148,                                      --(E148)
		  NVL(T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_AV_1, 0) AS VALOR_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_AV_1_D149,                                --(D149)
		  NVL(T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_AV_2, 0) AS VALOR_ESTACIONAMIENTO_DESCUBIERTO_OFICINAS_AV_2_E149,                                --(E149)
		  NVL(T.VALOR_ESTACIONAMIENTO_CUBIERTO_OFICINAS_AV_1, 0) AS VALOR_ESTACIONAMIENTO_CUBIERTO_OFICINAS_AV_1_D150,                                      --(D150)
		  NVL(T.VALOR_ESTACIONAMIENTO_CUBIERTO_OFICINAS_AV_2, 0) AS VALOR_ESTACIONAMIENTO_CUBIERTO_OFICINAS_AV_2_E150,                                      --(E150)
		  NVL(T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_AV_1, 0) AS VALOR_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_AV_1_D151,                                --(D151)
		  NVL(T.VALOR_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_AV_2, 0) AS VALOR_ESTACIONAMIENTO_DESCUBIERTO_VIVIENDA_AV_2_E151,                                --(E151)
		  NVL(T.VALOR_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_AV_1, 0) AS VALOR_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_AV_1_D152,                                      --(D152)
		  NVL(T.VALOR_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_AV_2, 0) AS VALOR_ESTACIONAMIENTO_CUBIERTO_VIVIENDA_AV_2_E152,                                      --(E152)
		  NVL(T.TOTAL_VENTAS_AV_1, 0) AS TOTAL_VENTAS_AV_1_D153,                                                                                            --(D153)
		  NVL(T.TOTAL_VENTAS_AV_2, 0) AS TOTAL_VENTAS_AV_2_E153,                                                                                            --(E153)
	--ANÁLISIS DE COSTOS DIRECTOS
		  NVL(T.COSTO_DIRECTO_M2_CONSTRUCCION_AC_1, 0) AS COSTO_DIRECTO_M2_CONSTRUCCION_AC_1_D155,															--(D155)
		  NVL(T.COSTO_DIRECTO_M2_CONSTRUCCION_AC_2, 0) AS COSTO_DIRECTO_M2_CONSTRUCCION_AC_2_E155,                                                          --(E155)
		  NVL(T.COSTO_DIRECTO_M2_PLACA_PARQUEADERO_PRIMER_NIVEL_AC_1, 0) AS COSTO_DIRECTO_M2_PLACA_PARQUEADERO_PRIMER_NIVEL_AC_1_D157,						--(D157)
		  NVL(T.COSTO_DIRECTO_M2_PLACA_PARQUEADERO_PRIMER_NIVEL_AC_2, 0) AS COSTO_DIRECTO_M2_PLACA_PARQUEADERO_PRIMER_NIVEL_AC_2_E157,                      --(E157)
		  NVL(T.COSTO_DIRECTO_M2_EQUIPAMIENTO_COMUNAL_CONSTRUIDO_AC_1, 0) AS COSTO_DIRECTO_M2_EQUIPAMIENTO_COMUNAL_CONSTRUIDO_AC_1_D158,                    --(D158)
		  NVL(T.COSTO_DIRECTO_M2_EQUIPAMIENTO_COMUNAL_CONSTRUIDO_AC_2, 0) AS COSTO_DIRECTO_M2_EQUIPAMIENTO_COMUNAL_CONSTRUIDO_AC_2_E158,                    --(E158)
		  NVL(T.COSTO_DIRECTO_M2_SOTANO_FUERA_TIPOLOGIA_1_AC, 0) AS COSTO_DIRECTO_M2_SOTANO_FUERA_TIPOLOGIA_1_AC_D159,                                      --(D159)
		  NVL(T.COSTO_DIRECTO_M2_SOTANO_FUERA_TIPOLOGIA_2_AC, 0) AS COSTO_DIRECTO_M2_SOTANO_FUERA_TIPOLOGIA_2_AC_E159,                                      --(E159)
		  NVL(T.TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_1, 0) AS TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_1_D160,            --(D160)
		  NVL(T.TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_2, 0) AS TOTAL_COSTOS_DIRECTOS_USO_PRINCIPAL_INCLUYEN_SOTANOS_AC_2_E160,            --(E160)
	--ANÁLISIS DE COSTOS INDIRECTOS
		  NVL(T.IMPUESTO_DELINEACION_URBANA_CD_AREA_VIS_EXTENTA_1, 0) AS IMPUESTO_DELINEACION_URBANA_CD_AREA_VIS_EXTENTA_1_D162,							--(D162)
		  NVL(T.IMPUESTO_DELINEACION_URBANA_CD_AREA_VIS_EXTENTA_2, 0) AS IMPUESTO_DELINEACION_URBANA_CD_AREA_VIS_EXTENTA_2_E162,                            --(E162)
		  NVL(T.LICENCIA_CURADURIA_CARGO_FIJO_1, 0) AS LICENCIA_CURADURIA_CARGO_FIJO_1_D163,                                                                --(D163)
		  NVL(T.LICENCIA_CURADURIA_CARGO_FIJO_2, 0) AS LICENCIA_CURADURIA_CARGO_FIJO_2_E163,                                                                --(E163)
		  NVL(T.LICENCIA_CURADURIA_1, 0) AS LICENCIA_CURADURIA_1_D164,                                                                                      --(D164)
		  NVL(T.LICENCIA_CURADURIA_2, 0) AS LICENCIA_CURADURIA_2_E164,                                                                                      --(E164)
		  NVL(T.GASTOS_NOTARIALES_REGISTRO_VENTAS_1, 0) AS GASTOS_NOTARIALES_REGISTRO_VENTAS_1_D165,                                                        --(D165)
		  NVL(T.GASTOS_NOTARIALES_REGISTRO_VENTAS_2, 0) AS GASTOS_NOTARIALES_REGISTRO_VENTAS_2_E165,                                                        --(E165)
		  NVL(T.HONORARIOS_CONSTRUCCION_CD_1, 0) AS HONORARIOS_CONSTRUCCION_CD_1_D166,                                                                      --(D166)
		  NVL(T.HONORARIOS_CONSTRUCCION_CD_2, 0) AS HONORARIOS_CONSTRUCCION_CD_2_E166,                                                                      --(E166)
		  NVL(T.HONORARIOS_PROYECTO_ARQUITECTONICO_CD_1, 0) AS HONORARIOS_PROYECTO_ARQUITECTONICO_CD_1_D167,                                                --(D167)
		  NVL(T.HONORARIOS_PROYECTO_ARQUITECTONICO_CD_2, 0) AS HONORARIOS_PROYECTO_ARQUITECTONICO_CD_2_E167,                                                --(E167)
		  NVL(T.HONORARIOS_GERENCIA_PROYECTO_VENTAS_1, 0) AS HONORARIOS_GERENCIA_PROYECTO_VENTAS_1_D168,                                                	--(D168)
		  NVL(T.HONORARIOS_GERENCIA_PROYECTO_VENTAS_2, 0) AS HONORARIOS_GERENCIA_PROYECTO_VENTAS_2_E168,                                                	--(E168)
		  NVL(T.HONORARIOS_ESTUDIOS_DISENOS_TECNICOS_ING_DETALLE_CD_1, 0) AS HONORARIOS_ESTUDIOS_DISENOS_TECNICOS_ING_DETALLE_CD_1_D169,					--(D169)
		  NVL(T.HONORARIOS_ESTUDIOS_DISENOS_TECNICOS_ING_DETALLE_CD_2, 0) AS HONORARIOS_ESTUDIOS_DISENOS_TECNICOS_ING_DETALLE_CD_2_E169,					--(E169)
		  NVL(T.COSTOS_FINANCIEROS_1, 0) AS COSTOS_FINANCIEROS_1_D170, 																						--(D170)
		  NVL(T.COSTOS_FINANCIEROS_2, 0) AS COSTOS_FINANCIEROS_2_E170, 																						--(E170)
		  NVL(T.VENTAS_COMISIONES_PUBLICIDAD_1, 0) AS VENTAS_COMISIONES_PUBLICIDAD_1_D171, 																	--(D171)
		  NVL(T.VENTAS_COMISIONES_PUBLICIDAD_2, 0) AS VENTAS_COMISIONES_PUBLICIDAD_2_E171, 																	--(E171)
		  NVL(T.COSTOS_URBANISMO_ANU_1, 0) AS COSTOS_URBANISMO_ANU_1_D172, 																					--(D172)
		  NVL(T.COSTOS_URBANISMO_ANU_2, 0) AS COSTOS_URBANISMO_ANU_2_E172, 																					--(E172)
		  NVL(T.COSTOS_MITIGACION_1, 0) AS COSTOS_MITIGACION_1_D173, 																						--(D173)
		  NVL(T.COSTOS_MITIGACION_2, 0) AS COSTOS_MITIGACION_2_E173, 																						--(E173)
		  NVL(T.PAGO_DINERO_CARGA_VIP_1, '') AS PAGO_DINERO_CARGA_VIP_1_D176, 																				--(D176)
		  NVL(T.PAGO_DINERO_CARGA_VIP_2, 0)  AS PAGO_DINERO_CARGA_VIP_2_E176, 																				--(E176)
		  NVL(T.PAGO_DINERO_CARGA_GENERAL_PORC_ANU_1, 0) AS PAGO_DINERO_CARGA_GENERAL_PORC_ANU_1_D177, 														--(D177)
		  NVL(T.PAGO_DINERO_CARGA_GENERAL_PORC_ANU_2, 0) AS PAGO_DINERO_CARGA_GENERAL_PORC_ANU_2_E177, 														--(E177)
		  NVL(T.PAGO_DINERO_CARGA_LOCAL_PORC_ANU_1, 0) AS PAGO_DINERO_CARGA_LOCAL_PORC_ANU_1_D178, 															--(D178)
		  NVL(T.PAGO_DINERO_CARGA_LOCAL_PORC_ANU_2, 0) AS PAGO_DINERO_CARGA_LOCAL_PORC_ANU_2_E178, 															--(E178)
		  NVL(T.COSTO_PROMEDIO_TOTAL_DESARROLLO_PARQUE_1, 0) AS COSTO_PROMEDIO_TOTAL_DESARROLLO_PARQUE_1_D179, 												--(D179)
		  NVL(T.COSTO_PROMEDIO_TOTAL_DESARROLLO_PARQUE_2, 0) AS COSTO_PROMEDIO_TOTAL_DESARROLLO_PARQUE_2_E179, 												--(E179)
		  NVL(T.PAGO_DINERO_ECP_PORC_ANU_1, 0) AS PAGO_DINERO_ECP_PORC_ANU_1_D180, 																			--(D180)
		  NVL(T.PAGO_DINERO_ECP_PORC_ANU_2, 0) AS PAGO_DINERO_ECP_PORC_ANU_2_E180, 																			--(E180)
		  NVL(T.PAGO_DINERO_ESTACIONAMIENTOS_ADICIONALES_1, 0) AS PAGO_DINERO_ESTACIONAMIENTOS_ADICIONALES_1_D181, 											--(D181)
		  NVL(T.PAGO_DINERO_ESTACIONAMIENTOS_ADICIONALES_2, 0) AS PAGO_DINERO_ESTACIONAMIENTOS_ADICIONALES_2_E181, 											--(E181)
		  NVL(T.TOTAL_COSTOS_INDIRECTOS_1, 0) AS TOTAL_COSTOS_INDIRECTOS_1_D182, 																			--(D182)
		  NVL(T.TOTAL_COSTOS_INDIRECTOS_2, 0) AS TOTAL_COSTOS_INDIRECTOS_2_E182, 																			--(E182)
		  NVL(T.TOTAL_COSTOS_1, 0) AS TOTAL_COSTOS_1_D183, 																									--(D183)
		  NVL(T.TOTAL_COSTOS_2, 0) AS TOTAL_COSTOS_2_E183, 																									--(E183)
	--RELACIÓN COSTOS TOTALES / VENTAS	  
		  NVL(T.RELACION_COSTOS_TOTALES_VENTAS_1, 0) AS RELACION_COSTOS_TOTALES_VENTAS_1_D184, 																--(D184)
		  NVL(T.RELACION_COSTOS_TOTALES_VENTAS_2, 0) AS RELACION_COSTOS_TOTALES_VENTAS_2_E184, 																--(E184)
		  NVL(T.UTILIDAD_RELACION_COSTOS_1, 0) AS UTILIDAD_RELACION_COSTOS_1_D185, 																			--(D185)
		  NVL(T.UTILIDAD_RELACION_COSTOS_2, 0) AS UTILIDAD_RELACION_COSTOS_2_E185, 																			--(E185)
		  NVL(T.UTILIDAD_COMERCIO_1, 0) AS UTILIDAD_COMERCIO_1_D186, 																						--(D186)
		  NVL(T.UTILIDAD_COMERCIO_2, 0) AS UTILIDAD_COMERCIO_2_E186, 																						--(E186)
		  NVL(T.UTILIDAD_OFICINA_1, 0) AS UTILIDAD_OFICINA_1_D187, 																							--(D187)
		  NVL(T.UTILIDAD_OFICINA_2, 0) AS UTILIDAD_OFICINA_2_E187, 																							--(E187)
		  NVL(T.UTILIDAD_NO_VIS_VIP_1, 0) AS UTILIDAD_NO_VIS_VIP_1_D188, 																					--(D188)
		  NVL(T.UTILIDAD_NO_VIS_VIP_2, 0) AS UTILIDAD_NO_VIS_VIP_2_E188, 																					--(E188)
		  NVL(T.UTILIDAD_VIS_1, 0) AS UTILIDAD_VIS_1_D189, 																									--(D189)
		  NVL(T.UTILIDAD_VIS_2, 0) AS UTILIDAD_VIS_2_E189, 																									--(E189)
		  NVL(T.UTILIDAD_VIP_1, 0) AS UTILIDAD_VIP_1_D190, 																									--(D190)
		  NVL(T.UTILIDAD_VIP_2, 0) AS UTILIDAD_VIP_2_E190, 																									--(E190)
		  NVL(T.TOTAL_UTILIDAD_1, 0) AS TOTAL_UTILIDAD_1_D191, 																								--(D191)
		  NVL(T.TOTAL_UTILIDAD_2, 0) AS TOTAL_UTILIDAD_2_E191, 																								--(E191)

		  NVL(T.VALOR_LOTE_VL_1, 0) AS VALOR_LOTE_VL_1_D193, 																								--(D193)
		  NVL(T.VALOR_LOTE_VL_2, 0) AS VALOR_LOTE_VL_2_E193, 																								--(E193)
		  NVL(T.VALOR_LOTE_SIN_CONSTRUCCIONES_VL_1, 0) AS VALOR_LOTE_SIN_CONSTRUCCIONES_VL_1_D194, 															--(D194)
		  NVL(T.VALOR_LOTE_SIN_CONSTRUCCIONES_VL_2, 0) AS VALOR_LOTE_SIN_CONSTRUCCIONES_VL_2_E194, 															--(E194)
		  NVL(T.VALOR_M2_LOTE_AREA_BRUTA_VL_1, 0) AS VALOR_M2_LOTE_AREA_BRUTA_VL_1_D195, 																	--(D195)
		  NVL(T.VALOR_M2_LOTE_AREA_BRUTA_VL_2, 0) AS VALOR_M2_LOTE_AREA_BRUTA_VL_2_E195, 																	--(E195)
		  NVL(T.VALOR_M2_LOTE_AREA_NETA_VL_1, 0) AS VALOR_M2_LOTE_AREA_NETA_VL_1_D196, 																		--(D196)
		  NVL(T.VALOR_M2_LOTE_AREA_NETA_VL_2, 0) AS VALOR_M2_LOTE_AREA_NETA_VL_2_E196, 																		--(E196)
		  NVL(T.VALOR_M2_LOTE_AREA_UTIL_VL_1, 0) AS VALOR_M2_LOTE_AREA_UTIL_VL_1_D197, 																		--(D197)
		  NVL(T.VALOR_M2_LOTE_AREA_UTIL_VL_2, 0) AS VALOR_M2_LOTE_AREA_UTIL_VL_2_E197, 																		--(E197)
		  NVL(T.VALOR_M2_ADOPTADO_VL_1, 0) AS VALOR_M2_ADOPTADO_VL_1_D198, 																					--(D198)
		  NVL(T.VALOR_M2_ADOPTADO_VL_2, 0) AS VALOR_M2_ADOPTADO_VL_2_E198, 																					--(E198)
		  NVL(T.VALOR_REFERENCIA_VIG_2024_VL_1, 0) AS VALOR_REFERENCIA_VIG_2024_VL_1_D199, 																	--(D199)
		  NVL(T.VALOR_REFERENCIA_VIG_2024_VL_2, 0) AS VALOR_REFERENCIA_VIG_2024_VL_2_E199, 																	--(E199)
		  NVL(T.VARIACION_VL_1, 0) AS VARIACION_VL_1_D200, 																									--(D200)
		  NVL(T.VARIACION_VL_2, 0) AS VARIACION_VL_2_E200, 																									--(E200)
	  --COMPARACION DE LA GEOMETRIA
		  NVL(T.ALTURA_EDIFICACION, 0) AS ALTURA_EDIFICACION_I372, 																							--(I372)
		  NVL(T.CARGA_GENERAL_ARTICULO_285_CG_1, 0) AS CARGA_GENERAL_ARTICULO_285_CG_1_H375, 																--(H375)
          NVL(T.CARGA_GENERAL_ARTICULO_285_CG_2, 0) AS CARGA_GENERAL_ARTICULO_285_CG_2_I375, 																--(I375)
          NVL(T.CARGA_GENERAL_ARTICULO_285_CG_3, 0) AS CARGA_GENERAL_ARTICULO_285_CG_3_J375, 																--(J375)
          NVL(T.CARGA_GENERAL_ARTICULO_285_CG_4, 0) AS CARGA_GENERAL_ARTICULO_285_CG_4_K375, 																--(K375)
		  NVL(T.CARGA_LOCAL_SUELO_CG_1, 0) AS CARGA_LOCAL_SUELO_CG_1_H376, 																					--(H376)
		  NVL(T.CARGA_LOCAL_SUELO_CG_2, 0) AS CARGA_LOCAL_SUELO_CG_2_I376, 																					--(I376)
		  NVL(T.CARGA_LOCAL_SUELO_CG_3, 0) AS CARGA_LOCAL_SUELO_CG_3_J376, 																					--(J376)
          NVL(T.CARGA_LOCAL_SUELO_CG_4, 0) AS CARGA_LOCAL_SUELO_CG_4_K376, 																					--(K376)
		  NVL(T.AISLAMIENTO_ENTRE_BLOQUES_CG_1, 0) AS AISLAMIENTO_ENTRE_BLOQUES_CG_1_H378, 																	--(H378)
          NVL(T.AISLAMIENTO_ENTRE_BLOQUES_CG_2, 0) AS AISLAMIENTO_ENTRE_BLOQUES_CG_2_I378, 																	--(I378)
          NVL(T.AISLAMIENTO_ENTRE_BLOQUES_CG_3, 0) AS AISLAMIENTO_ENTRE_BLOQUES_CG_3_J378, 																	--(J378)
          NVL(T.AISLAMIENTO_ENTRE_BLOQUES_CG_4, 0) AS AISLAMIENTO_ENTRE_BLOQUES_CG_4_K378, 																	--(K378)
		  NVL(T.AREA_AISLAMIENTO_POSTERIOR_CG_1, 0) AS AREA_AISLAMIENTO_POSTERIOR_CG_1_H379, 																--(H379)
		  NVL(T.AREA_AISLAMIENTO_POSTERIOR_CG_2, 0) AS AREA_AISLAMIENTO_POSTERIOR_CG_2_I379, 																--(I379)
		  NVL(T.AREA_AISLAMIENTO_POSTERIOR_CG_3, 0) AS AREA_AISLAMIENTO_POSTERIOR_CG_3_J379, 																--(J379)
		  NVL(T.AREA_AISLAMIENTO_POSTERIOR_CG_4, 0) AS AREA_AISLAMIENTO_POSTERIOR_CG_4_K379, 																--(K379)
		  NVL(T.AISLAMIENTO_LATERAL_CG_1, 0) AS AISLAMIENTO_LATERAL_CG_1_H380, 																				--(H380)
          NVL(T.AISLAMIENTO_LATERAL_CG_2, 0) AS AISLAMIENTO_LATERAL_CG_2_I380, 																				--(I380)
          NVL(T.AISLAMIENTO_LATERAL_CG_3, 0) AS AISLAMIENTO_LATERAL_CG_3_J380, 																				--(J380)
          NVL(T.AISLAMIENTO_LATERAL_CG_4, 0) AS AISLAMIENTO_LATERAL_CG_4_K380, 																				--(K380)
		  NVL(T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_1, 0) AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_1_H381, 											--(H381)
		  NVL(T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_2, 0) AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_2_I381, 											--(I381)
		  NVL(T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_3, 0) AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_3_J381, 											--(J381)
		  NVL(T.ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_4, 0) AS ZONAS_VERDES_RECREATIVAS_AREAS_LIBRES_CG_4_K381, 											--(K381)
		  NVL(T.AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_1, 0) AS AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_1_H382, 						--(H382)
		  NVL(T.AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_2, 0) AS AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_2_I382, 						--(I382)
		  NVL(T.AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_3, 0) AS AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_3_J382, 						--(J382)
          NVL(T.AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_4, 0) AS AREA_ESTACIONAMIENTOS_VEHICULARES_DESCUBIERTOS_CG_4_K382,  						--(K382)
		  NVL(T.AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_1, 0) AS AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_1_H383, 							--(H383)
          NVL(T.AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_2, 0) AS AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_2_I383, 							--(I383)
          NVL(T.AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_3, 0) AS AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_3_J383, 							--(J383)
          NVL(T.AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_4, 0) AS AREA_ESTACIONAMIENTOS_BICICLETAS_0_EMISIONES_CG_4_K383, 							--(K383)
		  NVL(T.CONTROL_AMBIENTAL_CG_1, 0) AS CONTROL_AMBIENTAL_CG_1_H384, 																					--(H384)
		  NVL(T.CONTROL_AMBIENTAL_CG_2, 0) AS CONTROL_AMBIENTAL_CG_2_I384, 																					--(I384)
		  NVL(T.CONTROL_AMBIENTAL_CG_3, 0) AS CONTROL_AMBIENTAL_CG_3_J384, 																					--(J384)
		  NVL(T.CONTROL_AMBIENTAL_CG_4, 0) AS CONTROL_AMBIENTAL_CG_4_K384, 																					--(K384)
		  NVL(T.AREA_UTIL_CARGA_VIP_CG_1, 0) AS AREA_UTIL_CARGA_VIP_CG_1_H385, 																				--(H385)
          NVL(T.AREA_UTIL_CARGA_VIP_CG_2, 0) AS AREA_UTIL_CARGA_VIP_CG_2_I385, 																				--(I385)
          NVL(T.AREA_UTIL_CARGA_VIP_CG_3, 0) AS AREA_UTIL_CARGA_VIP_CG_3_J385, 																				--(J385)
          NVL(T.AREA_UTIL_CARGA_VIP_CG_4, 0) AS AREA_UTIL_CARGA_VIP_CG_4_K385, 																				--(K385)
		  NVL(T.AREA_CONSTRUIDA_MODULO_PLANTA_CG_1, 0) AS AREA_CONSTRUIDA_MODULO_PLANTA_CG_1_H386, 															--(H386)
		  NVL(T.AREA_CONSTRUIDA_MODULO_PLANTA_CG_2, 0) AS AREA_CONSTRUIDA_MODULO_PLANTA_CG_2_I386, 															--(I386)
		  NVL(T.AREA_CONSTRUIDA_MODULO_PLANTA_CG_3, 0) AS AREA_CONSTRUIDA_MODULO_PLANTA_CG_3_J386, 															--(J386)
	      NVL(T.AREA_CONSTRUIDA_MODULO_PLANTA_CG_4, 0) AS AREA_CONSTRUIDA_MODULO_PLANTA_CG_4_K386, 															--(K386)
		  NVL(T.HUELLA_POR_GEOMETRIA_CG_4, 0) AS HUELLA_POR_GEOMETRIA_CG_4_K387 																			--(K387)
		  --,1 AS X
		 FROM TBL_TEMP_RESULTADO_PREDIOS T
		 WHERE 
		 (
			p_validacion = 0 OR 
			(
					-- Condición 1: Mostrar si es mayor o igual a cero
					    NVL(T.AREA_NETA_URBANIZABLE_M2_1, 0) >= 0
					AND NVL(T.SISTEMA_DE_CARGA_OBLIGACIONES_2, 0) >= 0
					AND NVL(T.CARGA_GENERAL_ARTICULO_285_2, 0) >= 0
					AND NVL(T.CARGA_LOCAL_ASOCIADA_PARQUES_2, 0) >= 0
					AND NVL(T.CARGA_LOCAL_EN_SUELO_2, 0) >= 0
					AND NVL(T.CARGA_LOCAL_COMPENSAR_EN_CONTROL_2, 0) >= 0
					AND NVL(T.CARGA_LOCAL_COMPENSAR_EN_DINERO_2, 0) >= 0
					AND NVL(T.HUELLA_POR_GEOMETRIA_CG_4, 0) >= 0
					AND NVL(T.RELACION_COSTOS_TOTALES_VENTAS_2, 0) < 1
					AND NVL(T.VALOR_M2_LOTE_AREA_BRUTA_VL_2, 0) >= 0
					-- VALIDACION PARA VIS 
					AND (T.OFERTAS_RESIDENCIAL <> 'VIS' OR NVL(T.UNIDADES_VENDIBLES_VIS_150_SMMLV_VP_1, 0) >= 32) --(SI NO ES VIS, NO VALIDO NADA.)
					--VALIDACION PARA NO VIS NI OFICINA 
					AND (T.OFERTAS_RESIDENCIAL IN ('VIS', 'OFICINAS') OR NVL(T.UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_1, 0) >= 32) --(SI ES VIS O OFICINAS, NO VALIDO NADA.)
					AND NVL(T.UNIDADES_VENDIBLES_NO_VIS_NI_VIP_VP_1, 0) >= 32
					AND NVL(T.INDICE_DE_CONSTRUCCION_EFECTIVO_TOTAL_1, 0) <> -10
					AND NVL(T.COSTO_DIRECTO_M2_CONSTRUCCION_AC_1, 0) <> -10
			)
		 );


		DBMS_OUTPUT.PUT_LINE('============SP_ACTUALIZAR_PREDIOS_PRINCIPAL FINALIZADO.============');

		-- Commit para confirmar los cambios
		COMMIT;

	EXCEPTION
		-- Manejo de excepciones para realizar rollback en caso de error
		WHEN OTHERS THEN
			ROLLBACK;
			-- Opcionalmente puedes registrar el error
			DBMS_OUTPUT.PUT_LINE('Error: ' || SQLERRM);
	END;

END PAQUETE_ACTUALIZACION_PREDIOS;
/